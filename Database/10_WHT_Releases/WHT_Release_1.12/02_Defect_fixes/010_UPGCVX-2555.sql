  CREATE OR REPLACE VIEW "CV_MSG_CARGO_PARCEL" ("OBJECT_ID", "GRADE", "CARGO_NO", "CARGO_NAME", "PARCEL_NO", "REFERENCE_LIFTING_NO", "LIFTING_ACCOUNT_ID", "CARRIER_ID", "CONSIGNOR_NAME", "CONSIGNEE_NAME", "START_LIFTING_DATE", "CONTRACT_ID", "GRS_VOL_NOMINATED", "BL_NUMBER", "BL_DATE_TIME", "COMMENTS", "NOTIFY_PARTY", "SCAC_UIC", "CHARTER_DATE", "ARRIVAL_DATE", "DEPARTURE_DATE", "EDN", "LOCAL_PORT_NAME", "REMOTE_PORT_NAME", "AGENT", "SURVEYOR", "MASTER", "PILOT", "CAPTAIN", "INCOTERM", "CARRIER_NAME", "CARRIER_IMO", "LIFTED_VOL", "LIFTED_GROSS_VOL", "LIFTED_ENERGY", "LIFTED_MASS", "LIFTED_COND_GROSS_MASS", "RECORD_STATUS", "CREATED_BY", "CREATED_DATE", "LAST_UPDATED_BY", "LAST_UPDATED_DATE", "REV_NO", "REV_TEXT", "APPROVAL_BY", "APPROVAL_DATE", "APPROVAL_STATE") AS 
  SELECT NOM.OBJECT_ID,
         EC_STOR_VERSION.TEXT_7(NOM.OBJECT_ID, NOM.START_LIFTING_DATE, '<=') AS GRADE,
         NOM.CARGO_NO,
         CAR.CARGO_NAME,
         NOM.PARCEL_NO,
         EC_CT_LIFTING_NUMBERS.LIFTING_NUMBER(NOM.PARCEL_NO) REFERENCE_LIFTING_NO,
         NOM.LIFTING_ACCOUNT_ID,
         NOM.CARRIER_ID,
         EC_COMPANY_VERSION.OFFICIAL_NAME(NOM.CONSIGNOR_ID, SYSDATE, '<=') AS CONSIGNOR_NAME,
         NOM.TEXT_4 AS CONSIGNEE_NAME,
         NOM.START_LIFTING_DATE,
         NOM.CONTRACT_ID,
         NOM.GRS_VOL_NOMINATED,
         NOM.BL_NUMBER,
         NOM.DATE_9,
         NOM.COMMENTS,
         NOM.TEXT_3 AS NOTIFY_PARTY,
         CAR.TEXT_20 AS SCAC_UIC,
         CAR.DATE_8 as CHARTER_DATE,
         NVL(EC_LIFTING_ACTIVITY.FROM_DAYTIME(NOM.CARGO_NO, 'LNG_PILOT_STATION', 1,'LOAD'), EC_LIFTING_ACTIVITY.FROM_DAYTIME(NOM.CARGO_NO, 'COND_PILOT_STATION', 1, 'LOAD')) ARRIVAL_DATE,
         NVL(EC_LIFTING_ACTIVITY.FROM_DAYTIME(NOM.CARGO_NO, 'LNG_SHIP_DEPARTS', 1, 'LOAD'), EC_LIFTING_ACTIVITY.FROM_DAYTIME(NOM.CARGO_NO, 'COND_SHIP_DEPARTS', 1, 'LOAD')) DEPARTURE_DATE,
         NOM.TEXT_18 EDN,
         EC_PORT_VERSION.NAME(EC_PORT.OBJECT_ID_BY_UK('PORT_ASH'), SYSDATE, '<=') AS LOCAL_PORT_NAME,
         NOM.TEXT_16 REMOTE_PORT_NAME,
         ec_representative.name('CARGO_AGENT', CAR.AGENT) AGENT,
         ec_representative.name('CARGO_SURVEYOR', CAR.SURVEYOR) SURVEYOR,
         CAR.MASTER,
         CAR.PILOT,
         CAR.TEXT_17 AS CAPTAIN,
         NOM.INCOTERM,
         EC_CARRIER_VERSION.NAME(CAR.CARRIER_ID, SYSDATE, '<=') CARRIER_NAME,
         EC_CARRIER_VERSION.TEXT_15(CAR.CARRIER_ID, SYSDATE, '<=') CARRIER_IMO,
         EC_STORAGE_LIFTING.LOAD_VALUE(PARCEL_NO,DECODE(OBJECT_ID, ECDP_OBJECTS.GETOBJIDFROMCODE('STORAGE','STW_COND'), (SELECT PRODUCT_MEAS_NO FROM DV_PROD_MEAS_SETUP WHERE OBJECT_CODE = 'COND' AND LIFTING_EVENT = 'LOAD' AND MEAS_ITEM = 'LIFT_COND_VOL_NET'), (SELECT PRODUCT_MEAS_NO FROM DV_PROD_MEAS_SETUP WHERE OBJECT_CODE = 'LNG' AND LIFTING_EVENT = 'LOAD' AND MEAS_ITEM = 'LIFT_NET_M3')) ) AS LIFTED_VOL,
         EC_STORAGE_LIFTING.LOAD_VALUE(PARCEL_NO,DECODE(OBJECT_ID, ECDP_OBJECTS.GETOBJIDFROMCODE('STORAGE','STW_COND'), (SELECT PRODUCT_MEAS_NO FROM DV_PROD_MEAS_SETUP WHERE OBJECT_CODE = 'COND' AND LIFTING_EVENT = 'LOAD' AND MEAS_ITEM = 'LIFT_COND_VOL_GRS'), (SELECT PRODUCT_MEAS_NO FROM DV_PROD_MEAS_SETUP WHERE OBJECT_CODE = 'LNG' AND LIFTING_EVENT = 'LOAD' AND MEAS_ITEM = 'LIFT_NET_M3')) ) AS LIFTED_GROSS_VOL,
         EC_STORAGE_LIFTING.LOAD_VALUE(PARCEL_NO,(SELECT PRODUCT_MEAS_NO FROM DV_PROD_MEAS_SETUP WHERE OBJECT_CODE = 'LNG' AND LIFTING_EVENT = 'LOAD' AND MEAS_ITEM = 'LIFT_NET_MMBTU') ) AS LIFTED_ENERGY,
         EC_STORAGE_LIFTING.LOAD_VALUE(PARCEL_NO,DECODE(OBJECT_ID, ECDP_OBJECTS.GETOBJIDFROMCODE('STORAGE','STW_COND'), (SELECT PRODUCT_MEAS_NO FROM DV_PROD_MEAS_SETUP WHERE OBJECT_CODE = 'COND' AND LIFTING_EVENT = 'LOAD' AND MEAS_ITEM = 'LIFT_COND_MASS_AIR_NET'), (SELECT PRODUCT_MEAS_NO FROM DV_PROD_MEAS_SETUP WHERE OBJECT_CODE = 'LNG' AND LIFTING_EVENT = 'LOAD' AND MEAS_ITEM = 'LIFT_NET_MASS')) ) AS LIFTED_MASS,
         EC_STORAGE_LIFTING.LOAD_VALUE(PARCEL_NO,(SELECT PRODUCT_MEAS_NO FROM DV_PROD_MEAS_SETUP WHERE OBJECT_CODE = 'COND' AND LIFTING_EVENT = 'LOAD' AND MEAS_ITEM = 'LIFT_COND_MASS_AIR_GRS')) AS LIFTED_COND_GROSS_MASS,
         NOM.RECORD_STATUS,
         NOM.CREATED_BY,
         NOM.CREATED_DATE,
         NOM.LAST_UPDATED_BY,
         NOM.LAST_UPDATED_DATE,
         NOM.REV_NO,
         NOM.REV_TEXT,
         NOM.APPROVAL_BY,
         NOM.APPROVAL_DATE,
         NOM.APPROVAL_STATE
  FROM   STORAGE_LIFT_NOMINATION NOM INNER JOIN CARGO_TRANSPORT CAR ON NOM.CARGO_NO = CAR.CARGO_NO;
  
  update class_attribute_cnfg set DB_SQL_SYNTAX='START_LIFTING_DATE' where class_name ='CT_MSG_CARGO' and attribute_name ='NOM_FIRM_DATE_TIME';
  update class_attribute_cnfg set DB_SQL_SYNTAX='ec_company_version.name(ec_cargo_transport.ref_object_id_10(cargo_no), start_lifting_Date, ''<='')' where class_name ='CT_MSG_CARGO' and attribute_name ='TRANSPORTER_NAME';
  commit;

  update VIEWLAYER_DIRTY_LOG set dirty_ind='Y' where object_name in('CT_MSG_CARGO');
  commit;
  execute ecdp_viewlayer.buildviewlayer('CT_MSG_CARGO');
  execute ecdp_viewlayer.buildreportlayer('CT_MSG_CARGO');
  
  
  
  CREATE OR REPLACE VIEW "CV_MSG_CARGO_LIFTING" ("OBJECT_ID", "LIFTING_ACCOUNT_ID", "PROFIT_CENTRE_ID", "CARRIER_ID", "NOM_FIRM_DATE", "BL_DATE", "CARGO_NO", "CARGO_NAME", "PARCEL_NO", "NOM_SPLIT_PCT", "COMB_IND", "EXCESS_LIFTING_IND", "START_LIFTING_DATE", "GRS_VOL_NOMINATED", "BL_DATE_TIME", "EXPORT_QTY", "EXPORT_DAYTIME", "RECORD_STATUS", "CREATED_BY", "CREATED_DATE", "LAST_UPDATED_BY", "LAST_UPDATED_DATE", "REV_NO", "REV_TEXT", "APPROVAL_BY", "APPROVAL_DATE", "APPROVAL_STATE") AS 
  (SELECT NOM.OBJECT_ID,
           NOM.LIFTING_ACCOUNT_ID,
           EC_LIFTING_ACCOUNT.PROFIT_CENTRE_ID (NOM.LIFTING_ACCOUNT_ID)
              AS PROFIT_CENTRE_ID,
           NOM.CARRIER_ID,
           NOM.NOM_FIRM_DATE,
           NOM.BL_DATE,
           NOM.CARGO_NO,
           CAR.CARGO_NAME,
           NOM.PARCEL_NO,
           NOM.VALUE_11,
           NOM.TEXT_12 AS COMB_IND,
           NOM.TEXT_13 AS EXCESS_LIFTING_IND,
           NOM.START_LIFTING_DATE,
           NOM.GRS_VOL_NOMINATED,
           NOM.DATE_9,
           EXP.EXPORT_QTY,
           EXP.DAYTIME,
           NOM.RECORD_STATUS,
           NOM.CREATED_BY,
           NOM.CREATED_DATE,
           NOM.LAST_UPDATED_BY,
           NOM.LAST_UPDATED_DATE,
           NOM.REV_NO,
           NOM.REV_TEXT,
           NOM.APPROVAL_BY,
           NOM.APPROVAL_DATE,
           NOM.APPROVAL_STATE
      FROM STORAGE_LIFT_NOMINATION NOM
           INNER JOIN CARGO_TRANSPORT CAR ON NOM.CARGO_NO = CAR.CARGO_NO
           LEFT OUTER JOIN STOR_PERIOD_EXPORT_STATUS EXP
              ON NOM.CARGO_NO = EXP.CARGO_NO);



  update class_attribute_cnfg set DB_SQL_SYNTAX='START_LIFTING_DATE' where class_name ='CT_MSG_CARGO_LIFTING' and attribute_name ='NOM_FIRM_DATE_TIME';
  update class_attribute_cnfg set DB_SQL_SYNTAX='BL_DATE_TIME' where class_name ='CT_MSG_CARGO_LIFTING' and attribute_name ='BL_DATE_TIME';
  commit;

  update VIEWLAYER_DIRTY_LOG set dirty_ind='Y' where object_name in('CT_MSG_CARGO_LIFTING');
  commit;
  execute ecdp_viewlayer.buildviewlayer('CT_MSG_CARGO_LIFTING');
  execute ecdp_viewlayer.buildreportlayer('CT_MSG_CARGO_LIFTING');

  
  update class_attribute_cnfg set DB_SQL_SYNTAX='START_LIFTING_DATE' where class_name ='CT_MSG_FORECAST_LIFTINGS' and attribute_name ='NOM_FIRM_DATE_TIME';
  commit;

  update VIEWLAYER_DIRTY_LOG set dirty_ind='Y' where object_name in('CT_MSG_FORECAST_LIFTINGS');
  commit;
  execute ecdp_viewlayer.buildviewlayer('CT_MSG_FORECAST_LIFTINGS');
  execute ecdp_viewlayer.buildreportlayer('CT_MSG_FORECAST_LIFTINGS');