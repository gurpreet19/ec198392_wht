
  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CV_MSG_CARGO_PARCEL" ("OBJECT_ID", "GRADE", "CARGO_NO", "CARGO_NAME", "PARCEL_NO", "REFERENCE_LIFTING_NO", "LIFTING_ACCOUNT_ID", "CARRIER_ID", "CONSIGNOR_NAME", "CONSIGNEE_NAME", "NOM_FIRM_DATE_TIME", "CONTRACT_ID", "GRS_VOL_NOMINATED", "BL_NUMBER", "BL_DATE_TIME", "COMMENTS", "NOTIFY_PARTY", "SCAC_UIC", "CHARTER_DATE", "ARRIVAL_DATE", "DEPARTURE_DATE", "EDN", "LOCAL_PORT_NAME", "REMOTE_PORT_NAME", "AGENT", "SURVEYOR", "MASTER", "PILOT", "CAPTAIN", "INCOTERM", "CARRIER_NAME", "CARRIER_IMO", "LIFTED_VOL", "LIFTED_GROSS_VOL", "LIFTED_ENERGY", "LIFTED_MASS", "LIFTED_COND_GROSS_MASS", "RECORD_STATUS", "CREATED_BY", "CREATED_DATE", "LAST_UPDATED_BY", "LAST_UPDATED_DATE", "REV_NO", "REV_TEXT", "APPROVAL_BY", "APPROVAL_DATE", "APPROVAL_STATE") AS 
  SELECT NOM.OBJECT_ID,
         EC_STOR_VERSION.TEXT_7(NOM.OBJECT_ID, NOM.DATE_8, '<=') AS GRADE,
         NOM.CARGO_NO,
         CAR.CARGO_NAME,
         NOM.PARCEL_NO,
         EC_CT_LIFTING_NUMBERS.LIFTING_NUMBER(NOM.PARCEL_NO) REFERENCE_LIFTING_NO,
         NOM.LIFTING_ACCOUNT_ID,
         NOM.CARRIER_ID,
         EC_COMPANY_VERSION.OFFICIAL_NAME(NOM.CONSIGNOR_ID, SYSDATE, '<=') AS CONSIGNOR_NAME,
         NOM.TEXT_4 AS CONSIGNEE_NAME,
         NOM.DATE_8,
         NOM.CONTRACT_ID,
         NOM.GRS_VOL_NOMINATED,
         NOM.BL_NUMBER,
         NOM.DATE_9,
         NOM.COMMENTS,
         NOM.TEXT_3 AS NOTIFY_PARTY,
         CAR.TEXT_20 AS SCAC_UIC,
         CAR.DATE_8 AS CHARTER_DATE,
         NVL(EC_LIFTING_ACTIVITY.FROM_DAYTIME(NOM.CARGO_NO, 'LNG_PILOT_STATION', 1), EC_LIFTING_ACTIVITY.FROM_DAYTIME(NOM.CARGO_NO, 'COND_PILOT_STATION', 1)) ARRIVAL_DATE,
         NVL(EC_LIFTING_ACTIVITY.FROM_DAYTIME(NOM.CARGO_NO, 'LNG_SHIP_DEPARTS', 1), EC_LIFTING_ACTIVITY.FROM_DAYTIME(NOM.CARGO_NO, 'COND_SHIP_DEPARTS', 1)) DEPARTURE_DATE,
         NOM.TEXT_18 EDN,
         EC_PORT_VERSION.NAME(EC_PORT.OBJECT_ID_BY_UK('PORT_ASH'), SYSDATE, '<=') AS LOCAL_PORT_NAME,
         NOM.TEXT_16 REMOTE_PORT_NAME,
         ec_representative.name('CARGO_AGENT', CAR.AGENT) AGENT,
         ec_representative.name('CARGO_SURVEYOR', CAR.SURVEYOR) SURVEYOR,
         CAR.MASTER,
         CAR.PILOT,
         CAR.TEXT_17 AS CAPTAIN,
         NOM.INCOTERM,
         EC_CARRIER_VERSION.NAME(CAR.CARRIER_ID, SYSDATE, '<=') CARRIER_NAME,
         EC_CARRIER_VERSION.TEXT_15(CAR.CARRIER_ID, SYSDATE, '<=') CARRIER_IMO,
         EC_STORAGE_LIFTING.LOAD_VALUE(PARCEL_NO,DECODE(OBJECT_ID, ECDP_OBJECTS.GETOBJIDFROMCODE('STORAGE','STW_COND'), (SELECT PRODUCT_MEAS_NO FROM DV_PROD_MEAS_SETUP WHERE OBJECT_CODE = 'COND' AND LIFTING_EVENT = 'LOAD' AND MEAS_ITEM = 'LIFT_COND_VOL_NET'), (SELECT PRODUCT_MEAS_NO FROM DV_PROD_MEAS_SETUP WHERE OBJECT_CODE = 'LNG' AND LIFTING_EVENT = 'LOAD' AND MEAS_ITEM = 'LIFT_NET_M3')) ) AS LIFTED_VOL,
         EC_STORAGE_LIFTING.LOAD_VALUE(PARCEL_NO,DECODE(OBJECT_ID, ECDP_OBJECTS.GETOBJIDFROMCODE('STORAGE','STW_COND'), (SELECT PRODUCT_MEAS_NO FROM DV_PROD_MEAS_SETUP WHERE OBJECT_CODE = 'COND' AND LIFTING_EVENT = 'LOAD' AND MEAS_ITEM = 'LIFT_COND_VOL_GRS'), (SELECT PRODUCT_MEAS_NO FROM DV_PROD_MEAS_SETUP WHERE OBJECT_CODE = 'LNG' AND LIFTING_EVENT = 'LOAD' AND MEAS_ITEM = 'LIFT_NET_M3')) ) AS LIFTED_GROSS_VOL,
         EC_STORAGE_LIFTING.LOAD_VALUE(PARCEL_NO,(SELECT PRODUCT_MEAS_NO FROM DV_PROD_MEAS_SETUP WHERE OBJECT_CODE = 'LNG' AND LIFTING_EVENT = 'LOAD' AND MEAS_ITEM = 'LIFT_NET_MMBTU') ) AS LIFTED_ENERGY,
         EC_STORAGE_LIFTING.LOAD_VALUE(PARCEL_NO,DECODE(OBJECT_ID, ECDP_OBJECTS.GETOBJIDFROMCODE('STORAGE','STW_COND'), (SELECT PRODUCT_MEAS_NO FROM DV_PROD_MEAS_SETUP WHERE OBJECT_CODE = 'COND' AND LIFTING_EVENT = 'LOAD' AND MEAS_ITEM = 'LIFT_COND_MASS_AIR_NET'), (SELECT PRODUCT_MEAS_NO FROM DV_PROD_MEAS_SETUP WHERE OBJECT_CODE = 'LNG' AND LIFTING_EVENT = 'LOAD' AND MEAS_ITEM = 'LIFT_NET_MASS')) ) AS LIFTED_MASS,
         EC_STORAGE_LIFTING.LOAD_VALUE(PARCEL_NO,(SELECT PRODUCT_MEAS_NO FROM DV_PROD_MEAS_SETUP WHERE OBJECT_CODE = 'COND' AND LIFTING_EVENT = 'LOAD' AND MEAS_ITEM = 'LIFT_COND_MASS_AIR_GRS')) AS LIFTED_COND_GROSS_MASS,
         NOM.RECORD_STATUS,
         NOM.CREATED_BY,
         NOM.CREATED_DATE,
         NOM.LAST_UPDATED_BY,
         NOM.LAST_UPDATED_DATE,
         NOM.REV_NO,
         NOM.REV_TEXT,
         NOM.APPROVAL_BY,
         NOM.APPROVAL_DATE,
         NOM.APPROVAL_STATE
  FROM   STORAGE_LIFT_NOMINATION NOM INNER JOIN CARGO_TRANSPORT CAR ON NOM.CARGO_NO = CAR.CARGO_NO;
