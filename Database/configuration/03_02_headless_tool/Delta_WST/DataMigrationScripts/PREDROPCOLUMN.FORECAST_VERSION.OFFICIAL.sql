
--From 2016070601PROD\01_Upgrade_script_ECPD_36978.sql
-- The script will move the existing values in official column to the official_ind column
DECLARE
  HASENTRY NUMBER;
BEGIN
 SELECT COUNT(*) INTO HASENTRY FROM USER_TRIGGERS 
		WHERE TRIGGER_NAME = 'IU_FORECAST_VERSION'; 
		IF HASENTRY > 0 THEN 
		EXECUTE IMMEDIATE 'ALTER TRIGGER IU_FORECAST_VERSION DISABLE';
		END IF;
		
	UPDATE FORECAST_VERSION 
	SET OFFICIAL_IND=OFFICIAL
	WHERE OBJECT_ID IN
	(
		SELECT OBJECT_ID 
		FROM FORECAST
		WHERE CLASS_NAME='FORECAST_PROD'
	) AND OFFICIAL_IND IS NULL;  
	
	SELECT COUNT(*) INTO HASENTRY FROM USER_TRIGGERS 
		WHERE TRIGGER_NAME = 'IU_FORECAST_VERSION'; 
		IF HASENTRY > 0 THEN 
		EXECUTE IMMEDIATE 'ALTER TRIGGER IU_FORECAST_VERSION ENABLE';
		END IF;
EXCEPTION
WHEN OTHERS THEN 	
	IF HASENTRY > 0 THEN 
        EXECUTE IMMEDIATE 'ALTER TRIGGER IU_FORECAST_VERSION ENABLE';
    END IF;    
        raise_application_error(-20000,'ERROR: Some Other fatal error occured :- '||SQLERRM);
END;  
--~^UTDELIM^~--	
