CREATE OR REPLACE FORCE EDITIONABLE VIEW "V_PRODUCT_GROUP_SETUP_HIST" ("JN_OPERATION", "JN_ORACLE_USER", "JN_DATETIME", "JN_NOTES", "JN_APPLN", "JN_SESSION", "OBJECT_ID", "DAYTIME", "PRODUCT_ID", "END_DATE", "COMMENTS", "SORT_ORDER", "PRODUCT_GROUP_TYPE", "PRICE_COLUMN", "PRODUCT_COLUMN", "MASTER_IND", "COUNTER_PRODUCT_IND", "REBAL_PRODUCT_IND", "TEXT_1", "TEXT_2", "TEXT_3", "TEXT_4", "TEXT_5", "TEXT_6", "TEXT_7", "TEXT_8", "TEXT_9", "TEXT_10", "VALUE_1", "VALUE_2", "VALUE_3", "VALUE_4", "VALUE_5", "VALUE_6", "VALUE_7", "VALUE_8", "VALUE_9", "VALUE_10", "DATE_1", "DATE_2", "DATE_3", "DATE_4", "DATE_5", "DATE_6", "DATE_7", "DATE_8", "DATE_9", "DATE_10", "REF_OBJECT_ID_1", "REF_OBJECT_ID_2", "REF_OBJECT_ID_3", "REF_OBJECT_ID_4", "REF_OBJECT_ID_5", "REF_OBJECT_ID_6", "REF_OBJECT_ID_7", "REF_OBJECT_ID_8", "REF_OBJECT_ID_9", "REF_OBJECT_ID_10", "RECORD_STATUS", "CREATED_BY", "CREATED_DATE", "LAST_UPDATED_BY", "LAST_UPDATED_DATE", "REV_NO", "REV_TEXT", "APPROVAL_BY", "APPROVAL_DATE", "APPROVAL_STATE", "REC_ID") AS 
  (
----------------------------------------------------------------------------------------------------
-- File name: V_PRODUCT_GROUP_SETUP_HIST.sql
-- View name: V_PRODUCT_GROUP_SETUP_HIST
--
-- $Revision: 1.0 $
--
-- Purpose  : combine both Historical and Current version of records.
--
-- Modification history:
--9
-- Date       Whom       Change description:
-- ---------- ----       --------------------------------------------------------------------------------
-- 14.09.2016 lewisbra
----------------------------------------------------------------------------------------------------
  SELECT "JN_OPERATION","JN_ORACLE_USER","JN_DATETIME","JN_NOTES","JN_APPLN","JN_SESSION","OBJECT_ID","DAYTIME","PRODUCT_ID","END_DATE","COMMENTS","SORT_ORDER","PRODUCT_GROUP_TYPE","PRICE_COLUMN","PRODUCT_COLUMN","MASTER_IND","COUNTER_PRODUCT_IND","REBAL_PRODUCT_IND","TEXT_1","TEXT_2","TEXT_3","TEXT_4","TEXT_5","TEXT_6","TEXT_7","TEXT_8","TEXT_9","TEXT_10","VALUE_1","VALUE_2","VALUE_3","VALUE_4","VALUE_5","VALUE_6","VALUE_7","VALUE_8","VALUE_9","VALUE_10","DATE_1","DATE_2","DATE_3","DATE_4","DATE_5","DATE_6","DATE_7","DATE_8","DATE_9","DATE_10","REF_OBJECT_ID_1","REF_OBJECT_ID_2","REF_OBJECT_ID_3","REF_OBJECT_ID_4","REF_OBJECT_ID_5","REF_OBJECT_ID_6","REF_OBJECT_ID_7","REF_OBJECT_ID_8","REF_OBJECT_ID_9","REF_OBJECT_ID_10","RECORD_STATUS","CREATED_BY","CREATED_DATE","LAST_UPDATED_BY","LAST_UPDATED_DATE","REV_NO","REV_TEXT","APPROVAL_BY","APPROVAL_DATE","APPROVAL_STATE","REC_ID" FROM (
		SELECT
			'CURRENT' jn_operation
			,NVL(last_updated_by,created_by) jn_oracle_user
			,sysdate jn_datetime
			,'CURRENT' jn_notes
			,NULL jn_appln
			,NULL jn_session
			,OBJECT_ID,
			DAYTIME,
			PRODUCT_ID,
			END_DATE,
			COMMENTS,
			SORT_ORDER,
			PRODUCT_GROUP_TYPE,
			PRICE_COLUMN,
			PRODUCT_COLUMN,
			MASTER_IND,
			COUNTER_PRODUCT_IND,
			REBAL_PRODUCT_IND,
			TEXT_1,
			TEXT_2,
			TEXT_3,
			TEXT_4,
			TEXT_5,
			TEXT_6,
			TEXT_7,
			TEXT_8,
			TEXT_9,
			TEXT_10,
			VALUE_1,
			VALUE_2,
			VALUE_3,
			VALUE_4,
			VALUE_5,
			VALUE_6,
			VALUE_7,
			VALUE_8,
			VALUE_9,
			VALUE_10,
			DATE_1,
			DATE_2,
			DATE_3,
			DATE_4,
			DATE_5,
			DATE_6,
			DATE_7,
			DATE_8,
			DATE_9,
			DATE_10,
			REF_OBJECT_ID_1,
			REF_OBJECT_ID_2,
			REF_OBJECT_ID_3,
			REF_OBJECT_ID_4,
			REF_OBJECT_ID_5,
			REF_OBJECT_ID_6,
			REF_OBJECT_ID_7,
			REF_OBJECT_ID_8,
			REF_OBJECT_ID_9,
			REF_OBJECT_ID_10,
			RECORD_STATUS,
			CREATED_BY,
			CREATED_DATE,
			LAST_UPDATED_BY,
			LAST_UPDATED_DATE,
			REV_NO,
			REV_TEXT,
			APPROVAL_BY,
			APPROVAL_DATE,
			APPROVAL_STATE,
			REC_ID
		from
			PRODUCT_GROUP_SETUP
		UNION
		SELECT
			JN_OPERATION,
			JN_ORACLE_USER,
			Ecdp_Date_Time.getCurrentDBSysdate(JN_DATETIME),
			JN_NOTES,
			JN_APPLN,
			JN_SESSION,
			OBJECT_ID,
			DAYTIME,
			PRODUCT_ID,
			END_DATE,
			COMMENTS,
			SORT_ORDER,
			PRODUCT_GROUP_TYPE,
			PRICE_COLUMN,
			PRODUCT_COLUMN,
			MASTER_IND,
			COUNTER_PRODUCT_IND,
			REBAL_PRODUCT_IND,
			TEXT_1,
			TEXT_2,
			TEXT_3,
			TEXT_4,
			TEXT_5,
			TEXT_6,
			TEXT_7,
			TEXT_8,
			TEXT_9,
			TEXT_10,
			VALUE_1,
			VALUE_2,
			VALUE_3,
			VALUE_4,
			VALUE_5,
			VALUE_6,
			VALUE_7,
			VALUE_8,
			VALUE_9,
			VALUE_10,
			DATE_1,
			DATE_2,
			DATE_3,
			DATE_4,
			DATE_5,
			DATE_6,
			DATE_7,
			DATE_8,
			DATE_9,
			DATE_10,
			REF_OBJECT_ID_1,
			REF_OBJECT_ID_2,
			REF_OBJECT_ID_3,
			REF_OBJECT_ID_4,
			REF_OBJECT_ID_5,
			REF_OBJECT_ID_6,
			REF_OBJECT_ID_7,
			REF_OBJECT_ID_8,
			REF_OBJECT_ID_9,
			REF_OBJECT_ID_10,
			RECORD_STATUS,
			CREATED_BY,
			CREATED_DATE,
			LAST_UPDATED_BY,
			LAST_UPDATED_DATE,
			REV_NO,
			REV_TEXT,
			APPROVAL_BY,
			APPROVAL_DATE,
			APPROVAL_STATE,
			REC_ID
    FROM
		PRODUCT_GROUP_SETUP_jn
  )
)