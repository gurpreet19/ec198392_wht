CREATE OR REPLACE FORCE EDITIONABLE VIEW "V_BAL_GRP_DAY_SUB" ("DAYTIME", "OBJECT_ID", "IN_OUT_FLAG", "FACILITY_ID", "STRM_BAL_CATEGORY", "PRODUCT_BALANCE_GROUP", "PRODUCT_ID", "PRODUCT_BALANCE", "ACTIVITY_CODE", "TOTAL_VOL", "NET_ADJ_VOL", "DILUENT_VOL", "SHRINKAGE_VOL", "BITUMEN_VOL", "ALLOC_ENERGY", "NET_ADJ_ALLOC_ENERGY", "BALANCE_GROUP_CODE", "URL", "PARENT_OBJECT_ID", "SORT_ORDER", "TRUCK_TICKET_FLAG", "RECORD_STATUS", "CREATED_BY", "CREATED_DATE", "LAST_UPDATED_BY", "LAST_UPDATED_DATE", "REV_NO", "REV_TEXT") AS 
  SELECT daytime,
       NULL object_id,
       NULL in_out_flag,
       op_fcty_class_1_id facility_id,
       strm_bal_category,
       product_balance_group,
       product_id,
       ecdp_objects.getobjname(product_id, daytime) product_balance,
       activity_code,
       SUM(total_vol) total_vol,
       SUM(net_adj_vol) net_adj_vol,
       SUM(diluent_vol) diluent_vol,
       SUM(shrinkage_vol) shrinkage_vol,
       SUM(bitumen_vol) bitumen_vol,
       SUM(alloc_energy) alloc_energy,
       SUM(net_adj_alloc_energy) net_adj_alloc_energy,
       balance_group_code,
       NULL URL,
       NULL parent_object_id,
       sort_order,
       'N' truck_ticket_flag,
       NULL record_status,
       NULL created_by,
       NULL created_date,
       NULL last_updated_by,
       NULL last_updated_date,
       NULL rev_no,
       NULL rev_text
  FROM v_bal_grp_day_data
 WHERE balance_group_code NOT IN ('RECEIPT', 'DISPOSITION')
 GROUP BY daytime,
          op_fcty_class_1_id,
          product_id,
          product_balance_group,
          balance_group_code,
          strm_bal_category,
          activity_code,
          sort_order
UNION
SELECT daytime,
       parent_object_id object_id,
       NULL in_out_flag,
       op_fcty_class_1_id facility_id,
       '' strm_bal_category,
       product_balance_group,
       product_id,
       ecdp_objects.getobjname(product_id, daytime) product_balance,
       activity_code,
       SUM(total_vol) total_vol,
       SUM(net_adj_vol) net_adj_vol,
       SUM(diluent_vol) diluent_vol,
       SUM(shrinkage_vol) shrinkage_vol,
       SUM(bitumen_vol) bitumen_vol,
       SUM(alloc_energy) alloc_energy,
       SUM(net_adj_alloc_energy) net_adj_alloc_energy,
       balance_group_code,
       NULL URL,
       NULL parent_object_id,
       sort_order,
       truck_ticket_flag,
       NULL record_status,
       NULL created_by,
       NULL created_date,
       NULL last_updated_by,
       NULL last_updated_date,
       NULL rev_no,
       NULL rev_text
    FROM v_bal_grp_day_data
   WHERE balance_group_code IN ('RECEIPT', 'DISPOSITION')
     AND strm_bal_Category IN ('METERED_RECEIPT','METERED_DISPOSITION','TOTAL_TRUCKED_IN','TOTAL_TRUCKED_OUT')
     AND parent_object_id IS NOT NULL
   GROUP BY daytime,
          op_fcty_class_1_id,
          product_id,
          product_balance_group,
          balance_group_code,
          parent_object_id,
          activity_code,
          sort_order,
          truck_ticket_flag
UNION
SELECT daytime,
       NULL object_id,
       NULL in_out_flag,
       op_fcty_class_1_id facility_id,
       strm_bal_category,
       product_balance_group,
       product_id,
       ecdp_objects.getobjname(product_id, daytime) product_balance,
       activity_code,
       SUM(total_vol) total_vol,
       SUM(net_adj_vol) net_adj_vol,
       SUM(diluent_vol) diluent_vol,
       SUM(shrinkage_vol) shrinkage_vol,
       SUM(bitumen_vol) bitumen_vol,
       SUM(alloc_energy) alloc_energy,
       SUM(net_adj_alloc_energy) net_adj_alloc_energy,
       balance_group_code,
       NULL URL,
       NULL parent_object_id,
       sort_order,
       'N' truck_ticket_flag,
       NULL record_status,
       NULL created_by,
       NULL created_date,
       NULL last_updated_by,
       NULL last_updated_date,
       NULL rev_no,
       NULL rev_text
    FROM v_bal_grp_day_data
   WHERE balance_group_code IN ('RECEIPT', 'DISPOSITION')
     AND strm_bal_Category NOT IN ('METERED_RECEIPT','METERED_DISPOSITION','TOTAL_TRUCKED_IN','TOTAL_TRUCKED_OUT')
   GROUP BY daytime,
          op_fcty_class_1_id,
          product_id,
          product_balance_group,
          balance_group_code,
          strm_bal_category,
          activity_code,
          sort_order