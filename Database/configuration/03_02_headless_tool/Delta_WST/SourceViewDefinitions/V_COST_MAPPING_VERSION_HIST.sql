CREATE OR REPLACE FORCE EDITIONABLE VIEW "V_COST_MAPPING_VERSION_HIST" ("JN_OPERATION", "JN_ORACLE_USER", "JN_DATETIME", "JN_NOTES", "JN_APPLN", "JN_SESSION", "OBJECT_ID", "DAYTIME", "END_DATE", "NAME", "SRC_CONTRACT_ID", "SRC_DOCUMENT_TYPE", "SRC_FIN_ACCOUNT_ID", "SRC_FIN_ACCOUNT_CODE", "SRC_FIN_WBS_ID", "SRC_FIN_WBS_CODE", "SRC_FIN_COST_CENTER_ID", "SRC_FIN_REVENUE_ORDER_ID", "SRC_DATASET", "SRC_DEBIT_CREDIT_CODE", "SRC_EXPENDITURE_TYPE", "TRG_CONTRACT_ID", "TRG_FIN_ACCOUNT_ID", "TRG_FIN_WBS_ID", "TRG_FIN_REVENUE_ORDER_ID", "TRG_FIN_COST_CENTER_ID", "TRG_DATASET", "TRG_DEBIT_CREDIT_CODE", "TRG_EXPENDITURE_TYPE", "COMPANY_ID", "POSTING_KEY", "LINE_ITEM_KEY", "MATERIAL", "PLANT", "JOINT_VENTURE", "RECOVERY_IND", "EQUITY_GROUP", "MAPPING_TYPE", "MAPPING_TYPE_1", "MAPPING_TYPE_2", "MAPPING_TYPE_3", "MAPPING_TYPE_4", "MAPPING_TARGET_1", "MAPPING_TARGET_2", "MAPPING_TARGET_3", "MAPPING_TARGET_4", "MAPPING_FACTOR", "MAPPING_ALLOCATION", "COMMENTS", "SPLIT_KEY_ID", "OTHER_SPLIT_ITEM_ID", "TRG_FIN_WBS_VALUE_SOURCE", "JOURNAL_ENTRY_SOURCE", "TEXT_1", "TEXT_2", "TEXT_3", "TEXT_4", "TEXT_5", "TEXT_6", "TEXT_7", "TEXT_8", "TEXT_9", "TEXT_10", "VALUE_1", "VALUE_2", "VALUE_3", "VALUE_4", "VALUE_5", "DATE_1", "DATE_2", "DATE_3", "DATE_4", "DATE_5", "REF_OBJECT_ID_1", "REF_OBJECT_ID_2", "REF_OBJECT_ID_3", "REF_OBJECT_ID_4", "REF_OBJECT_ID_5", "REPORT_REF_ID", "TRG_INVENTORY_ID", "TRG_CONTRACT_GROUP_ID", "DATE_FILTER", "USE_REPORT_REF_GROUP_IND", "REPORT_REF_GROUP_ID", "RECORD_STATUS", "CREATED_BY", "CREATED_DATE", "LAST_UPDATED_BY", "LAST_UPDATED_DATE", "REV_NO", "REV_TEXT", "APPROVAL_BY", "APPROVAL_DATE", "APPROVAL_STATE", "REC_ID", "ACCRUAL") AS 
  (
----------------------------------------------------------------------------------------------------
-- File name: v_cost_mapping_version_hist.sql
-- View name: v_cost_mapping_version_hist
--
-- $Revision: 1.0 $
--
-- Purpose  : combine both Historical and Current version of records.
--
-- Modification history:
--9
-- Date       Whom       Change description:
-- ---------- ----       --------------------------------------------------------------------------------
-- 14.09.2016 lewisbra
----------------------------------------------------------------------------------------------------
  SELECT "JN_OPERATION","JN_ORACLE_USER","JN_DATETIME","JN_NOTES","JN_APPLN","JN_SESSION","OBJECT_ID","DAYTIME","END_DATE","NAME","SRC_CONTRACT_ID","SRC_DOCUMENT_TYPE","SRC_FIN_ACCOUNT_ID","SRC_FIN_ACCOUNT_CODE","SRC_FIN_WBS_ID","SRC_FIN_WBS_CODE","SRC_FIN_COST_CENTER_ID","SRC_FIN_REVENUE_ORDER_ID","SRC_DATASET","SRC_DEBIT_CREDIT_CODE","SRC_EXPENDITURE_TYPE","TRG_CONTRACT_ID","TRG_FIN_ACCOUNT_ID","TRG_FIN_WBS_ID","TRG_FIN_REVENUE_ORDER_ID","TRG_FIN_COST_CENTER_ID","TRG_DATASET","TRG_DEBIT_CREDIT_CODE","TRG_EXPENDITURE_TYPE","COMPANY_ID","POSTING_KEY","LINE_ITEM_KEY","MATERIAL","PLANT","JOINT_VENTURE","RECOVERY_IND","EQUITY_GROUP","MAPPING_TYPE","MAPPING_TYPE_1","MAPPING_TYPE_2","MAPPING_TYPE_3","MAPPING_TYPE_4","MAPPING_TARGET_1","MAPPING_TARGET_2","MAPPING_TARGET_3","MAPPING_TARGET_4","MAPPING_FACTOR","MAPPING_ALLOCATION","COMMENTS","SPLIT_KEY_ID","OTHER_SPLIT_ITEM_ID","TRG_FIN_WBS_VALUE_SOURCE","JOURNAL_ENTRY_SOURCE","TEXT_1","TEXT_2","TEXT_3","TEXT_4","TEXT_5","TEXT_6","TEXT_7","TEXT_8","TEXT_9","TEXT_10","VALUE_1","VALUE_2","VALUE_3","VALUE_4","VALUE_5","DATE_1","DATE_2","DATE_3","DATE_4","DATE_5","REF_OBJECT_ID_1","REF_OBJECT_ID_2","REF_OBJECT_ID_3","REF_OBJECT_ID_4","REF_OBJECT_ID_5","REPORT_REF_ID","TRG_INVENTORY_ID","TRG_CONTRACT_GROUP_ID","DATE_FILTER","USE_REPORT_REF_GROUP_IND","REPORT_REF_GROUP_ID","RECORD_STATUS","CREATED_BY","CREATED_DATE","LAST_UPDATED_BY","LAST_UPDATED_DATE","REV_NO","REV_TEXT","APPROVAL_BY","APPROVAL_DATE","APPROVAL_STATE","REC_ID","ACCRUAL" FROM (
    SELECT
    'CURRENT' jn_operation
    ,NVL(last_updated_by,created_by) jn_oracle_user
    ,Ecdp_Timestamp.getCurrentSysdate jn_datetime
    ,'CURRENT' jn_notes
    ,NULL jn_appln
    ,NULL jn_session
    ,OBJECT_ID,
	DAYTIME,
	END_DATE,
	NAME,
	SRC_CONTRACT_ID,
	SRC_DOCUMENT_TYPE,
	SRC_FIN_ACCOUNT_ID,
	SRC_FIN_ACCOUNT_CODE,
	SRC_FIN_WBS_ID,
	SRC_FIN_WBS_CODE,
	SRC_FIN_COST_CENTER_ID,
	SRC_FIN_REVENUE_ORDER_ID,
	SRC_DATASET,
	SRC_DEBIT_CREDIT_CODE,
	SRC_EXPENDITURE_TYPE,
	TRG_CONTRACT_ID,
	TRG_FIN_ACCOUNT_ID,
	TRG_FIN_WBS_ID,
	TRG_FIN_REVENUE_ORDER_ID,
	TRG_FIN_COST_CENTER_ID,
	TRG_DATASET,
	TRG_DEBIT_CREDIT_CODE,
	TRG_EXPENDITURE_TYPE,
	COMPANY_ID,
	POSTING_KEY,
	LINE_ITEM_KEY,
	MATERIAL,
	PLANT,
	JOINT_VENTURE,
	RECOVERY_IND,
	EQUITY_GROUP,
	MAPPING_TYPE,
	MAPPING_TYPE_1,
	MAPPING_TYPE_2,
	MAPPING_TYPE_3,
	MAPPING_TYPE_4,
	MAPPING_TARGET_1,
	MAPPING_TARGET_2,
	MAPPING_TARGET_3,
	MAPPING_TARGET_4,
	MAPPING_FACTOR,
	MAPPING_ALLOCATION,
	COMMENTS,
	SPLIT_KEY_ID,
	OTHER_SPLIT_ITEM_ID,
	TRG_FIN_WBS_VALUE_SOURCE,
	JOURNAL_ENTRY_SOURCE,
	TEXT_1,
	TEXT_2,
	TEXT_3,
	TEXT_4,
	TEXT_5,
	TEXT_6,
	TEXT_7,
	TEXT_8,
	TEXT_9,
	TEXT_10,
	VALUE_1,
	VALUE_2,
	VALUE_3,
	VALUE_4,
	VALUE_5,
	DATE_1,
	DATE_2,
	DATE_3,
	DATE_4,
	DATE_5,
	REF_OBJECT_ID_1,
	REF_OBJECT_ID_2,
	REF_OBJECT_ID_3,
	REF_OBJECT_ID_4,
	REF_OBJECT_ID_5,
	REPORT_REF_ID,
	TRG_INVENTORY_ID,
	TRG_CONTRACT_GROUP_ID,
	DATE_FILTER,
	USE_REPORT_REF_GROUP_IND,
	REPORT_REF_GROUP_ID,
	RECORD_STATUS,
	CREATED_BY,
	CREATED_DATE,
	LAST_UPDATED_BY,
	LAST_UPDATED_DATE,
	REV_NO,
	REV_TEXT,
	APPROVAL_BY,
	APPROVAL_DATE,
	APPROVAL_STATE,
	REC_ID,
	ACCRUAL
    FROM COST_MAPPING_VERSION
    UNION
    SELECT
	jn_operation
    ,jn_oracle_user
    ,jn_datetime
    ,jn_notes
    ,jn_appln
    ,jn_session
    ,OBJECT_ID,
	DAYTIME,
	END_DATE,
	NAME,
	SRC_CONTRACT_ID,
	SRC_DOCUMENT_TYPE,
	SRC_FIN_ACCOUNT_ID,
	SRC_FIN_ACCOUNT_CODE,
	SRC_FIN_WBS_ID,
	SRC_FIN_WBS_CODE,
	SRC_FIN_COST_CENTER_ID,
	SRC_FIN_REVENUE_ORDER_ID,
	SRC_DATASET,
	SRC_DEBIT_CREDIT_CODE,
	SRC_EXPENDITURE_TYPE,
	TRG_CONTRACT_ID,
	TRG_FIN_ACCOUNT_ID,
	TRG_FIN_WBS_ID,
	TRG_FIN_REVENUE_ORDER_ID,
	TRG_FIN_COST_CENTER_ID,
	TRG_DATASET,
	TRG_DEBIT_CREDIT_CODE,
	TRG_EXPENDITURE_TYPE,
	COMPANY_ID,
	POSTING_KEY,
	LINE_ITEM_KEY,
	MATERIAL,
	PLANT,
	JOINT_VENTURE,
	RECOVERY_IND,
	EQUITY_GROUP,
	MAPPING_TYPE,
	MAPPING_TYPE_1,
	MAPPING_TYPE_2,
	MAPPING_TYPE_3,
	MAPPING_TYPE_4,
	MAPPING_TARGET_1,
	MAPPING_TARGET_2,
	MAPPING_TARGET_3,
	MAPPING_TARGET_4,
	MAPPING_FACTOR,
	MAPPING_ALLOCATION,
	COMMENTS,
	SPLIT_KEY_ID,
	OTHER_SPLIT_ITEM_ID,
	TRG_FIN_WBS_VALUE_SOURCE,
	JOURNAL_ENTRY_SOURCE,
	TEXT_1,
	TEXT_2,
	TEXT_3,
	TEXT_4,
	TEXT_5,
	TEXT_6,
	TEXT_7,
	TEXT_8,
	TEXT_9,
	TEXT_10,
	VALUE_1,
	VALUE_2,
	VALUE_3,
	VALUE_4,
	VALUE_5,
	DATE_1,
	DATE_2,
	DATE_3,
	DATE_4,
	DATE_5,
	REF_OBJECT_ID_1,
	REF_OBJECT_ID_2,
	REF_OBJECT_ID_3,
	REF_OBJECT_ID_4,
	REF_OBJECT_ID_5,
	REPORT_REF_ID,
	TRG_INVENTORY_ID,
	TRG_CONTRACT_GROUP_ID,
	DATE_FILTER,
	USE_REPORT_REF_GROUP_IND,
	REPORT_REF_GROUP_ID,
	RECORD_STATUS,
	CREATED_BY,
	CREATED_DATE,
	LAST_UPDATED_BY,
	LAST_UPDATED_DATE,
	REV_NO,
	REV_TEXT,
	APPROVAL_BY,
	APPROVAL_DATE,
	APPROVAL_STATE,
	REC_ID,
	ACCRUAL
    FROM COST_MAPPING_VERSION_JN
  )
)