CREATE OR REPLACE FORCE EDITIONABLE VIEW "V_GEN_PERIOD_DOCUMENT" ("CONTRACT_CODE", "PROFIT_CENTER_CODE", "PRICE_CONCEPT_CODE", "DELIVERY_POINT_CODE", "PRODUCT_CODE", "VENDOR_CODE", "PROCESSING_PERIOD", "PERIOD_END_DATE", "ALLOC_NO", "QTY1", "UOM1_CODE", "QTY2", "UOM2_CODE", "QTY3", "UOM3_CODE", "QTY4", "UOM4_CODE", "QTY5", "UOM5_CODE", "QTY6", "UOM6_CODE", "QTY_STATUS", "CONTRACT_ID", "DELIVERY_POINT_ID", "DOC_SETUP_CODE", "DOC_SETUP_ID", "DOC_STATUS", "IGNORE_IND", "PERIOD_START_DATE", "PRECEDING_DOC_KEY", "PRICE_DATE", "PRICE_OBJECT_CODE", "PRICE_OBJECT_ID", "PRICE_STATUS", "PRICING_VALUE", "PRODUCT_ID", "PROFIT_CENTER_ID", "LINE_ITEM_CODE", "LINE_ITEM_BASED_TYPE", "LINE_ITEM_TEMPLATE_ID", "UNIT_PRICE_UNIT", "INT_TYPE", "INT_BASE_AMOUNT", "INT_BASE_RATE", "INT_RATE_OFFSET", "INT_FROM_DATE", "INT_TO_DATE", "INT_COMPOUNDING_PERIOD", "LI_PRICE_OBJECT_CODE", "LI_PRICE_OBJECT_ID", "PERCENTAGE_VALUE", "PERCENTAGE_BASE_AMOUNT", "LINE_ITEM_TYPE", "LINE_ITEM_KEY", "REF_OBJECT_ID_1", "REF_OBJECT_ID_10", "REF_OBJECT_ID_2", "REF_OBJECT_ID_3", "REF_OBJECT_ID_4", "REF_OBJECT_ID_5", "REF_OBJECT_ID_6", "REF_OBJECT_ID_7", "REF_OBJECT_ID_8", "REF_OBJECT_ID_9", "SALES_ORDER", "SOURCE_ENTRY_NO", "SOURCE_NODE_CODE", "SOURCE_NODE_ID", "TRANSACTION_KEY", "TRANS_TEMP_CODE", "TRANS_TEMP_ID", "UNIQUE_KEY_1", "UNIQUE_KEY_2", "UNIT_PRICE", "VENDOR_ID", "PRECEDING_TRANS_KEY", "PRECEDING_LI_KEY", "VAT_CODE", "IFAC_TT_CONN_CODE", "IFAC_LI_CONN_CODE", "ALLOC_NO_MAX_IND", "TRANS_KEY_SET_IND", "ORIGINAL_IFAC_DATA", "CUSTOMER_CODE", "CUSTOMER_ID", "TRANS_TEMP_CODE_OVRD", "TRANS_TEMP_ID_OVRD", "DOCUMENT_KEY", "DIST_TYPE", "OBJECT_TYPE", "DATE_1", "DATE_10", "DATE_2", "DATE_3", "DATE_4", "DATE_5", "DATE_6", "DATE_7", "DATE_8", "DATE_9", "TEXT_1", "TEXT_10", "TEXT_2", "TEXT_3", "TEXT_4", "TEXT_5", "TEXT_6", "TEXT_7", "TEXT_8", "TEXT_9", "VALUE_1", "VALUE_10", "VALUE_2", "VALUE_3", "VALUE_4", "VALUE_5", "VALUE_6", "VALUE_7", "VALUE_8", "VALUE_9", "STATUS", "DESCRIPTION", "CALC_RUN_NO", "CONTRACT_ACCOUNT_CLASS", "CONTRACT_ACCOUNT", "LI_UNIQUE_KEY_1", "LI_UNIQUE_KEY_2", "RECORD_STATUS", "CREATED_BY", "CREATED_DATE", "LAST_UPDATED_BY", "LAST_UPDATED_DATE", "REV_NO", "REV_TEXT", "APPROVAL_BY", "APPROVAL_DATE", "APPROVAL_STATE", "REC_ID") AS 
  SELECT cv."CONTRACT_CODE",cv."PROFIT_CENTER_CODE",cv."PRICE_CONCEPT_CODE",cv."DELIVERY_POINT_CODE",cv."PRODUCT_CODE",cv."VENDOR_CODE",cv."PROCESSING_PERIOD",cv."PERIOD_END_DATE",cv."ALLOC_NO",cv."QTY1",cv."UOM1_CODE",cv."QTY2",cv."UOM2_CODE",cv."QTY3",cv."UOM3_CODE",cv."QTY4",cv."UOM4_CODE",cv."QTY5",cv."UOM5_CODE",cv."QTY6",cv."UOM6_CODE",cv."QTY_STATUS",cv."CONTRACT_ID",cv."DELIVERY_POINT_ID",cv."DOC_SETUP_CODE",cv."DOC_SETUP_ID",cv."DOC_STATUS",cv."IGNORE_IND",cv."PERIOD_START_DATE",cv."PRECEDING_DOC_KEY",cv."PRICE_DATE",cv."PRICE_OBJECT_CODE",cv."PRICE_OBJECT_ID",cv."PRICE_STATUS",cv."PRICING_VALUE",cv."PRODUCT_ID",cv."PROFIT_CENTER_ID",cv."LINE_ITEM_CODE",cv."LINE_ITEM_BASED_TYPE",cv."LINE_ITEM_TEMPLATE_ID",cv."UNIT_PRICE_UNIT",cv."INT_TYPE",cv."INT_BASE_AMOUNT",cv."INT_BASE_RATE",cv."INT_RATE_OFFSET",cv."INT_FROM_DATE",cv."INT_TO_DATE",cv."INT_COMPOUNDING_PERIOD",cv."LI_PRICE_OBJECT_CODE",cv."LI_PRICE_OBJECT_ID",cv."PERCENTAGE_VALUE",cv."PERCENTAGE_BASE_AMOUNT",cv."LINE_ITEM_TYPE",cv."LINE_ITEM_KEY",cv."REF_OBJECT_ID_1",cv."REF_OBJECT_ID_10",cv."REF_OBJECT_ID_2",cv."REF_OBJECT_ID_3",cv."REF_OBJECT_ID_4",cv."REF_OBJECT_ID_5",cv."REF_OBJECT_ID_6",cv."REF_OBJECT_ID_7",cv."REF_OBJECT_ID_8",cv."REF_OBJECT_ID_9",cv."SALES_ORDER",cv."SOURCE_ENTRY_NO",cv."SOURCE_NODE_CODE",cv."SOURCE_NODE_ID",cv."TRANSACTION_KEY",cv."TRANS_TEMP_CODE",cv."TRANS_TEMP_ID",cv."UNIQUE_KEY_1",cv."UNIQUE_KEY_2",cv."UNIT_PRICE",cv."VENDOR_ID",cv."PRECEDING_TRANS_KEY",cv."PRECEDING_LI_KEY",cv."VAT_CODE",cv."IFAC_TT_CONN_CODE",cv."IFAC_LI_CONN_CODE",cv."ALLOC_NO_MAX_IND",cv."TRANS_KEY_SET_IND",cv."ORIGINAL_IFAC_DATA",cv."CUSTOMER_CODE",cv."CUSTOMER_ID",cv."TRANS_TEMP_CODE_OVRD",cv."TRANS_TEMP_ID_OVRD",cv."DOCUMENT_KEY",cv."DIST_TYPE",cv."OBJECT_TYPE",cv."DATE_1",cv."DATE_10",cv."DATE_2",cv."DATE_3",cv."DATE_4",cv."DATE_5",cv."DATE_6",cv."DATE_7",cv."DATE_8",cv."DATE_9",cv."TEXT_1",cv."TEXT_10",cv."TEXT_2",cv."TEXT_3",cv."TEXT_4",cv."TEXT_5",cv."TEXT_6",cv."TEXT_7",cv."TEXT_8",cv."TEXT_9",cv."VALUE_1",cv."VALUE_10",cv."VALUE_2",cv."VALUE_3",cv."VALUE_4",cv."VALUE_5",cv."VALUE_6",cv."VALUE_7",cv."VALUE_8",cv."VALUE_9",cv."STATUS",cv."DESCRIPTION",cv."CALC_RUN_NO",cv."CONTRACT_ACCOUNT_CLASS",cv."CONTRACT_ACCOUNT",cv."LI_UNIQUE_KEY_1",cv."LI_UNIQUE_KEY_2",cv."RECORD_STATUS",cv."CREATED_BY",cv."CREATED_DATE",cv."LAST_UPDATED_BY",cv."LAST_UPDATED_DATE",cv."REV_NO",cv."REV_TEXT",cv."APPROVAL_BY",cv."APPROVAL_DATE",cv."APPROVAL_STATE",cv."REC_ID"
      FROM ifac_sales_qty cv
     WHERE cv.trans_key_set_ind = 'N'
       AND cv.ignore_ind = 'N'
       AND cv.alloc_no_max_ind = 'Y'
       -- Id-columns can be NULL if interfaced codes were not matching EC objects.
       AND cv.vendor_id         IS NOT NULL
       AND cv.customer_id       IS NOT NULL
       AND cv.profit_center_id  IS NOT NULL
       AND cv.product_id        IS NOT NULL
       AND cv.delivery_point_id IS NOT NULL
     --so new ppa gets processed first so if qty status changes error and does not create new record.
     -- if multi vendor, the transaction always has _FULL as vendor
     ORDER BY decode(qty_status,'PROV',3,'FINAL',2,'PPA',1,0)