CREATE OR REPLACE FORCE EDITIONABLE VIEW "V_BALANCE_GROUP_TOTAL" ("DAYTIME", "OBJECT_ID", "FACILITY_ID", "IN_OUT_FLAG", "NAME", "PRODUCT_ID", "PRODUCT_BALANCE", "ACTIVITY_CODE", "TOTAL_VOL", "NET_ADJ_VOL", "DILUENT_VOL", "SHRINKAGE_VOL", "BITUMEN_VOL", "ALLOC_ENERGY", "NET_ADJ_ALLOC_ENERGY", "NET_MASS", "BALANCE_GROUP_CODE", "PRODUCT_BALANCE_GROUP", "URL", "PRORATION_FACTOR", "METERING_DIFF", "SORT_ORDER", "TRUCK_TICKET_FLAG", "PARENT_OBJECT_ID", "STRM_BAL_CATEGORY", "RECORD_STATUS", "CREATED_BY", "CREATED_DATE", "LAST_UPDATED_BY", "LAST_UPDATED_DATE", "REV_NO", "REV_TEXT") AS 
  SELECT daytime,
       op_fcty_class_1_id object_id,
       op_fcty_class_1_id facility_id,
       ec_prosty_codes.alt_code(balance_group_code, 'BALANCE_GROUP') in_out_flag,
       DECODE(ec_prosty_codes.alt_code(balance_group_code, 'BALANCE_GROUP'), 'OUT', '-', '+') || ' ' || ec_prosty_codes.code_text(balance_group_code, 'BALANCE_GROUP') name,
       NULL product_id,
       NULL product_balance,
       NULL activity_code,
       total_vol,
       net_adj_vol,
       diluent_vol,
       shrinkage_vol,
       bitumen_vol,
       alloc_energy,
       net_adj_alloc_energy,
       net_mass,
       balance_group_code,
       product_balance_group,
       NULL URL,
       NULL proration_factor,
       NULL metering_diff,
       sort_order,
       truck_ticket_flag,
       NULL parent_object_id,
       NULL strm_bal_category,
       NULL record_status,
       NULL created_by,
       NULL created_date,
       NULL last_updated_by,
       NULL last_updated_date,
       NULL rev_no,
       NULL rev_text
  FROM (SELECT SUM(total_vol) total_vol,
               SUM(net_adj_vol) net_adj_vol,
               SUM(diluent_vol) diluent_vol,
               SUM(shrinkage_vol) shrinkage_vol,
               SUM(bitumen_vol) bitumen_vol,
               SUM(alloc_energy) alloc_energy,
               SUM(net_adj_alloc_energy) net_adj_alloc_energy,
               SUM(net_mass) net_mass,
               daytime,
               op_fcty_class_1_id,
               balance_group_code,
               product_balance_group,
               sort_order,
               'N' truck_ticket_flag
          FROM v_balance_group_data
         WHERE truck_ticket_flag = 'N'
         GROUP BY daytime,
                  op_fcty_class_1_id,
                  balance_group_code,
                  product_balance_group,
                  sort_order
        UNION
        SELECT SUM(total_vol) total_vol,
               SUM(net_adj_vol) net_adj_vol,
               SUM(diluent_vol) diluent_vol,
               SUM(shrinkage_vol) shrinkage_vol,
               SUM(bitumen_vol) bitumen_vol,
               SUM(alloc_energy) alloc_energy,
               SUM(net_adj_alloc_energy) net_adj_alloc_energy,
               SUM(net_mass) net_mass,
               daytime,
               op_fcty_class_1_id,
               balance_group_code,
               product_balance_group,
               sort_order,
               'Y' truck_ticket_flag
          FROM v_balance_group_data
         GROUP BY daytime,
                  op_fcty_class_1_id,
                  balance_group_code,
                  product_balance_group,
                  sort_order)