CREATE OR REPLACE FORCE EDITIONABLE VIEW "GV_OBJECT_REL_CASCADE" ("CASCADED_CLASS", "FROM_CLASS_NAME", "TO_CLASS_NAME", "ROLE_NAME", "FROM_OBJECT_ID", "FROM_DAYTIME", "FROM_END_DATE", "OBJECT_ID", "DAYTIME", "END_DATE", "PRIORITY") AS 
  SELECT 'PRODUCTION_DAY' AS cascaded_class, 'PRODUCTION_DAY' AS from_class_name, 'FCTY_CLASS_1' AS to_class_name, 'PRODUCTION_DAY' AS role_name, oa.production_day_id AS from_object_id, v.daytime AS from_daytime, v.end_date AS from_end_date, oa.object_id, oa.daytime, oa.end_date, 1 AS priority FROM fcty_version oa INNER JOIN production_facility o ON o.object_id = oa.object_id INNER JOIN production_day_version v ON v.object_id = oa.production_day_id AND oa.daytime BETWEEN v.daytime AND nvl(v.end_date, oa.daytime) WHERE oa.production_day_id IS NOT NULL  AND o.CLASS_NAME='FCTY_CLASS_1'
UNION ALL
SELECT 'PRODUCTION_DAY' AS cascaded_class, 'FCTY_CLASS_2' AS from_class_name, 'FCTY_CLASS_1' AS to_class_name, 'OP_FCTY_2' AS role_name, oa.op_fcty_class_2_id AS from_object_id, v.daytime AS from_daytime, v.end_date AS from_end_date, oa.object_id, oa.daytime, oa.end_date, 0 AS priority FROM fcty_version oa INNER JOIN production_facility o ON o.object_id = oa.object_id INNER JOIN fcty_version v ON v.object_id = oa.op_fcty_class_2_id AND oa.daytime BETWEEN v.daytime AND nvl(v.end_date, oa.daytime) WHERE oa.op_fcty_class_2_id IS NOT NULL  AND o.CLASS_NAME='FCTY_CLASS_1'
UNION ALL
SELECT 'PRODUCTION_DAY' AS cascaded_class, 'PRODUCTION_DAY' AS from_class_name, 'CONTRACT' AS to_class_name, 'PRODUCTION_DAY' AS role_name, oa.production_day_id AS from_object_id, v.daytime AS from_daytime, v.end_date AS from_end_date, oa.object_id, oa.daytime, oa.end_date, 1 AS priority FROM contract_version oa INNER JOIN contract o ON o.object_id = oa.object_id INNER JOIN production_day_version v ON v.object_id = oa.production_day_id AND oa.daytime BETWEEN v.daytime AND nvl(v.end_date, oa.daytime) WHERE oa.production_day_id IS NOT NULL 
UNION ALL
SELECT 'PRODUCTION_DAY' AS cascaded_class, 'PRODUCTION_DAY' AS from_class_name, 'EQPM' AS to_class_name, 'PRODUCTION_DAY' AS role_name, oa.production_day_id AS from_object_id, v.daytime AS from_daytime, v.end_date AS from_end_date, oa.object_id, oa.daytime, oa.end_date, 1 AS priority FROM eqpm_version oa INNER JOIN equipment o ON o.object_id = oa.object_id INNER JOIN production_day_version v ON v.object_id = oa.production_day_id AND oa.daytime BETWEEN v.daytime AND nvl(v.end_date, oa.daytime) WHERE oa.production_day_id IS NOT NULL 
UNION ALL
SELECT 'PRODUCTION_DAY' AS cascaded_class, 'FCTY_CLASS_1' AS from_class_name, 'STREAM' AS to_class_name, 'OP_FCTY_1' AS role_name, oa.op_fcty_class_1_id AS from_object_id, v.daytime AS from_daytime, v.end_date AS from_end_date, oa.object_id, oa.daytime, oa.end_date, 2 AS priority FROM strm_version oa INNER JOIN stream o ON o.object_id = oa.object_id INNER JOIN fcty_version v ON v.object_id = oa.op_fcty_class_1_id AND oa.daytime BETWEEN v.daytime AND nvl(v.end_date, oa.daytime) WHERE oa.op_fcty_class_1_id IS NOT NULL 
UNION ALL
SELECT 'PRODUCTION_DAY' AS cascaded_class, 'FCTY_CLASS_1' AS from_class_name, 'WELL_HOOKUP' AS to_class_name, 'OP_FCTY_1' AS role_name, oa.op_fcty_class_1_id AS from_object_id, v.daytime AS from_daytime, v.end_date AS from_end_date, oa.object_id, oa.daytime, oa.end_date, 2 AS priority FROM well_hookup_version oa INNER JOIN well_hookup o ON o.object_id = oa.object_id INNER JOIN fcty_version v ON v.object_id = oa.op_fcty_class_1_id AND oa.daytime BETWEEN v.daytime AND nvl(v.end_date, oa.daytime) WHERE oa.op_fcty_class_1_id IS NOT NULL 
UNION ALL
SELECT 'PRODUCTION_DAY' AS cascaded_class, 'PRODUCTION_DAY' AS from_class_name, 'METER' AS to_class_name, 'PRODUCTION_DAY' AS role_name, oa.production_day_id AS from_object_id, v.daytime AS from_daytime, v.end_date AS from_end_date, oa.object_id, oa.daytime, oa.end_date, 1 AS priority FROM meter_version oa INNER JOIN meter o ON o.object_id = oa.object_id INNER JOIN production_day_version v ON v.object_id = oa.production_day_id AND oa.daytime BETWEEN v.daytime AND nvl(v.end_date, oa.daytime) WHERE oa.production_day_id IS NOT NULL 
UNION ALL
SELECT 'PRODUCTION_DAY' AS cascaded_class, 'PRODUCTION_DAY' AS from_class_name, 'FCTY_CLASS_2' AS to_class_name, 'PRODUCTION_DAY' AS role_name, oa.production_day_id AS from_object_id, v.daytime AS from_daytime, v.end_date AS from_end_date, oa.object_id, oa.daytime, oa.end_date, 1 AS priority FROM fcty_version oa INNER JOIN production_facility o ON o.object_id = oa.object_id INNER JOIN production_day_version v ON v.object_id = oa.production_day_id AND oa.daytime BETWEEN v.daytime AND nvl(v.end_date, oa.daytime) WHERE oa.production_day_id IS NOT NULL  AND o.CLASS_NAME='FCTY_CLASS_2'
UNION ALL
SELECT 'PRODUCTION_DAY' AS cascaded_class, 'PRODUCTION_DAY' AS from_class_name, 'STREAM' AS to_class_name, 'PRODUCTION_DAY' AS role_name, oa.production_day_id AS from_object_id, v.daytime AS from_daytime, v.end_date AS from_end_date, oa.object_id, oa.daytime, oa.end_date, 1 AS priority FROM strm_version oa INNER JOIN stream o ON o.object_id = oa.object_id INNER JOIN production_day_version v ON v.object_id = oa.production_day_id AND oa.daytime BETWEEN v.daytime AND nvl(v.end_date, oa.daytime) WHERE oa.production_day_id IS NOT NULL 
UNION ALL
SELECT 'PRODUCTION_DAY' AS cascaded_class, 'PRODUCTION_DAY' AS from_class_name, 'TRAN_CONTRACT' AS to_class_name, 'PRODUCTION_DAY' AS role_name, oa.production_day_id AS from_object_id, v.daytime AS from_daytime, v.end_date AS from_end_date, oa.object_id, oa.daytime, oa.end_date, 1 AS priority FROM contract_version oa INNER JOIN contract o ON o.object_id = oa.object_id INNER JOIN production_day_version v ON v.object_id = oa.production_day_id AND oa.daytime BETWEEN v.daytime AND nvl(v.end_date, oa.daytime) WHERE oa.production_day_id IS NOT NULL  AND o.TRAN_IND = 'Y'
UNION ALL
SELECT 'PRODUCTION_DAY' AS cascaded_class, 'FCTY_CLASS_1' AS from_class_name, 'PRODSEPARATOR' AS to_class_name, 'OP_FCTY_1' AS role_name, oa.op_fcty_class_1_id AS from_object_id, v.daytime AS from_daytime, v.end_date AS from_end_date, oa.object_id, oa.daytime, oa.end_date, 2 AS priority FROM sepa_version oa INNER JOIN separator o ON o.object_id = oa.object_id INNER JOIN fcty_version v ON v.object_id = oa.op_fcty_class_1_id AND oa.daytime BETWEEN v.daytime AND nvl(v.end_date, oa.daytime) WHERE oa.op_fcty_class_1_id IS NOT NULL  AND o.CLASS_NAME='PRODSEPARATOR'
UNION ALL
SELECT 'PRODUCTION_DAY' AS cascaded_class, 'FCTY_CLASS_1' AS from_class_name, 'TANK' AS to_class_name, 'OP_FCTY_1' AS role_name, oa.op_fcty_class_1_id AS from_object_id, v.daytime AS from_daytime, v.end_date AS from_end_date, oa.object_id, oa.daytime, oa.end_date, 2 AS priority FROM tank_version oa INNER JOIN tank o ON o.object_id = oa.object_id INNER JOIN fcty_version v ON v.object_id = oa.op_fcty_class_1_id AND oa.daytime BETWEEN v.daytime AND nvl(v.end_date, oa.daytime) WHERE oa.op_fcty_class_1_id IS NOT NULL 
UNION ALL
SELECT 'PRODUCTION_DAY' AS cascaded_class, 'PRODUCTION_DAY' AS from_class_name, 'FLOWLINE' AS to_class_name, 'PRODUCTION_DAY' AS role_name, oa.production_day_id AS from_object_id, v.daytime AS from_daytime, v.end_date AS from_end_date, oa.object_id, oa.daytime, oa.end_date, 1 AS priority FROM flwl_version oa INNER JOIN flowline o ON o.object_id = oa.object_id INNER JOIN production_day_version v ON v.object_id = oa.production_day_id AND oa.daytime BETWEEN v.daytime AND nvl(v.end_date, oa.daytime) WHERE oa.production_day_id IS NOT NULL 
UNION ALL
SELECT 'PRODUCTION_DAY' AS cascaded_class, 'PRODUCTION_DAY' AS from_class_name, 'PIPELINE' AS to_class_name, 'PRODUCTION_DAY' AS role_name, oa.production_day_id AS from_object_id, v.daytime AS from_daytime, v.end_date AS from_end_date, oa.object_id, oa.daytime, oa.end_date, 1 AS priority FROM pipe_version oa INNER JOIN pipeline o ON o.object_id = oa.object_id INNER JOIN production_day_version v ON v.object_id = oa.production_day_id AND oa.daytime BETWEEN v.daytime AND nvl(v.end_date, oa.daytime) WHERE oa.production_day_id IS NOT NULL 
UNION ALL
SELECT 'PRODUCTION_DAY' AS cascaded_class, 'FCTY_CLASS_1' AS from_class_name, 'STORAGE' AS to_class_name, 'OP_FCTY_1' AS role_name, oa.op_fcty_class_1_id AS from_object_id, v.daytime AS from_daytime, v.end_date AS from_end_date, oa.object_id, oa.daytime, oa.end_date, 2 AS priority FROM stor_version oa INNER JOIN storage o ON o.object_id = oa.object_id INNER JOIN fcty_version v ON v.object_id = oa.op_fcty_class_1_id AND oa.daytime BETWEEN v.daytime AND nvl(v.end_date, oa.daytime) WHERE oa.op_fcty_class_1_id IS NOT NULL 
UNION ALL
SELECT 'PRODUCTION_DAY' AS cascaded_class, 'FCTY_CLASS_1' AS from_class_name, 'TESTSEPARATOR' AS to_class_name, 'OP_FCTY_1' AS role_name, oa.op_fcty_class_1_id AS from_object_id, v.daytime AS from_daytime, v.end_date AS from_end_date, oa.object_id, oa.daytime, oa.end_date, 2 AS priority FROM sepa_version oa INNER JOIN separator o ON o.object_id = oa.object_id INNER JOIN fcty_version v ON v.object_id = oa.op_fcty_class_1_id AND oa.daytime BETWEEN v.daytime AND nvl(v.end_date, oa.daytime) WHERE oa.op_fcty_class_1_id IS NOT NULL  AND o.CLASS_NAME='TESTSEPARATOR'
UNION ALL
SELECT 'PRODUCTION_DAY' AS cascaded_class, 'FCTY_CLASS_1' AS from_class_name, 'CHEM_TANK' AS to_class_name, 'OP_FCTY_1' AS role_name, oa.op_fcty_class_1_id AS from_object_id, v.daytime AS from_daytime, v.end_date AS from_end_date, oa.object_id, oa.daytime, oa.end_date, 2 AS priority FROM chem_tank_version oa INNER JOIN chem_tank o ON o.object_id = oa.object_id INNER JOIN fcty_version v ON v.object_id = oa.op_fcty_class_1_id AND oa.daytime BETWEEN v.daytime AND nvl(v.end_date, oa.daytime) WHERE oa.op_fcty_class_1_id IS NOT NULL 
UNION ALL
SELECT 'PRODUCTION_DAY' AS cascaded_class, 'PRODUCTION_DAY' AS from_class_name, 'COLLECTION_POINT' AS to_class_name, 'PRODUCTION_DAY' AS role_name, oa.production_day_id AS from_object_id, v.daytime AS from_daytime, v.end_date AS from_end_date, oa.object_id, oa.daytime, oa.end_date, 1 AS priority FROM fcty_version oa INNER JOIN production_facility o ON o.object_id = oa.object_id INNER JOIN production_day_version v ON v.object_id = oa.production_day_id AND oa.daytime BETWEEN v.daytime AND nvl(v.end_date, oa.daytime) WHERE oa.production_day_id IS NOT NULL  AND o.CLASS_NAME='COLLECTION_POINT'
UNION ALL
SELECT 'PRODUCTION_DAY' AS cascaded_class, 'PRODUCTION_DAY' AS from_class_name, 'PRODSEPARATOR' AS to_class_name, 'PRODUCTION_DAY' AS role_name, oa.production_day_id AS from_object_id, v.daytime AS from_daytime, v.end_date AS from_end_date, oa.object_id, oa.daytime, oa.end_date, 1 AS priority FROM sepa_version oa INNER JOIN separator o ON o.object_id = oa.object_id INNER JOIN production_day_version v ON v.object_id = oa.production_day_id AND oa.daytime BETWEEN v.daytime AND nvl(v.end_date, oa.daytime) WHERE oa.production_day_id IS NOT NULL  AND o.CLASS_NAME='PRODSEPARATOR'
UNION ALL
SELECT 'PRODUCTION_DAY' AS cascaded_class, 'FCTY_CLASS_1' AS from_class_name, 'EQPM' AS to_class_name, 'OP_FCTY_1' AS role_name, oa.op_fcty_class_1_id AS from_object_id, v.daytime AS from_daytime, v.end_date AS from_end_date, oa.object_id, oa.daytime, oa.end_date, 2 AS priority FROM eqpm_version oa INNER JOIN equipment o ON o.object_id = oa.object_id INNER JOIN fcty_version v ON v.object_id = oa.op_fcty_class_1_id AND oa.daytime BETWEEN v.daytime AND nvl(v.end_date, oa.daytime) WHERE oa.op_fcty_class_1_id IS NOT NULL 
UNION ALL
SELECT 'PRODUCTION_DAY' AS cascaded_class, 'PRODUCTION_DAY' AS from_class_name, 'SALE_CONTRACT' AS to_class_name, 'PRODUCTION_DAY' AS role_name, oa.production_day_id AS from_object_id, v.daytime AS from_daytime, v.end_date AS from_end_date, oa.object_id, oa.daytime, oa.end_date, 1 AS priority FROM contract_version oa INNER JOIN contract o ON o.object_id = oa.object_id INNER JOIN production_day_version v ON v.object_id = oa.production_day_id AND oa.daytime BETWEEN v.daytime AND nvl(v.end_date, oa.daytime) WHERE oa.production_day_id IS NOT NULL  AND o.SALE_IND='Y'
UNION ALL
SELECT 'PRODUCTION_DAY' AS cascaded_class, 'FCTY_CLASS_1' AS from_class_name, 'TEST_DEVICE' AS to_class_name, 'OP_FCTY_1' AS role_name, oa.op_fcty_class_1_id AS from_object_id, v.daytime AS from_daytime, v.end_date AS from_end_date, oa.object_id, oa.daytime, oa.end_date, 2 AS priority FROM test_device_version oa INNER JOIN test_device o ON o.object_id = oa.object_id INNER JOIN fcty_version v ON v.object_id = oa.op_fcty_class_1_id AND oa.daytime BETWEEN v.daytime AND nvl(v.end_date, oa.daytime) WHERE oa.op_fcty_class_1_id IS NOT NULL 
UNION ALL
SELECT 'PRODUCTION_DAY' AS cascaded_class, 'FCTY_CLASS_1' AS from_class_name, 'FLOWLINE' AS to_class_name, 'OP_FCTY_1' AS role_name, oa.op_fcty_class_1_id AS from_object_id, v.daytime AS from_daytime, v.end_date AS from_end_date, oa.object_id, oa.daytime, oa.end_date, 2 AS priority FROM flwl_version oa INNER JOIN flowline o ON o.object_id = oa.object_id INNER JOIN fcty_version v ON v.object_id = oa.op_fcty_class_1_id AND oa.daytime BETWEEN v.daytime AND nvl(v.end_date, oa.daytime) WHERE oa.op_fcty_class_1_id IS NOT NULL 
UNION ALL
SELECT 'PRODUCTION_DAY' AS cascaded_class, 'PRODUCTION_DAY' AS from_class_name, 'REVN_CONTRACT' AS to_class_name, 'PRODUCTION_DAY' AS role_name, oa.production_day_id AS from_object_id, v.daytime AS from_daytime, v.end_date AS from_end_date, oa.object_id, oa.daytime, oa.end_date, 1 AS priority FROM contract_version oa INNER JOIN contract o ON o.object_id = oa.object_id INNER JOIN production_day_version v ON v.object_id = oa.production_day_id AND oa.daytime BETWEEN v.daytime AND nvl(v.end_date, oa.daytime) WHERE oa.production_day_id IS NOT NULL  AND o.REVN_IND = 'Y'
UNION ALL
SELECT 'PRODUCTION_DAY' AS cascaded_class, 'FCTY_CLASS_1' AS from_class_name, 'WELL' AS to_class_name, 'OP_FCTY_1' AS role_name, oa.op_fcty_class_1_id AS from_object_id, v.daytime AS from_daytime, v.end_date AS from_end_date, oa.object_id, oa.daytime, oa.end_date, 2 AS priority FROM well_version oa INNER JOIN well o ON o.object_id = oa.object_id INNER JOIN fcty_version v ON v.object_id = oa.op_fcty_class_1_id AND oa.daytime BETWEEN v.daytime AND nvl(v.end_date, oa.daytime) WHERE oa.op_fcty_class_1_id IS NOT NULL  AND o.CLASS_NAME='WELL'
UNION ALL
SELECT 'PRODUCTION_DAY' AS cascaded_class, 'FCTY_CLASS_1' AS from_class_name, 'PIPELINE' AS to_class_name, 'OP_FCTY_1' AS role_name, oa.op_fcty_class_1_id AS from_object_id, v.daytime AS from_daytime, v.end_date AS from_end_date, oa.object_id, oa.daytime, oa.end_date, 2 AS priority FROM pipe_version oa INNER JOIN pipeline o ON o.object_id = oa.object_id INNER JOIN fcty_version v ON v.object_id = oa.op_fcty_class_1_id AND oa.daytime BETWEEN v.daytime AND nvl(v.end_date, oa.daytime) WHERE oa.op_fcty_class_1_id IS NOT NULL