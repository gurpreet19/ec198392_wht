CREATE OR REPLACE FORCE EDITIONABLE VIEW "V_TRANS_PROD_SET_ITEM" ("OBJECT_ID", "PRODUCT_ID", "COST_TYPE", "PROD_SORT_ORDER", "COST_SORT_ORDER", "PROD_DAYTIME", "PROD_END_DATE", "COST_DAYTIME", "COST_END_DATE", "TRANS_PROD_SET_ITEM_ID", "RECORD_STATUS", "CREATED_BY", "CREATED_DATE", "LAST_UPDATED_BY", "LAST_UPDATED_DATE", "REV_NO", "REV_TEXT") AS 
  SELECT pgs.object_id,
       pgs.PRODUCT_ID,
       pgc.COST_TYPE,
       pgs.SORT_ORDER PROD_SORT_ORDER,
       pgc.SORT_ORDER COST_SORT_ORDER,
       pgs.DAYTIME PROD_DAYTIME,
       pgs.END_DATE PROD_END_DATE,
       pgc.DAYTIME COST_DAYTIME,
       pgc.END_DATE COST_END_DATE,
       pgs.PRODUCT_ID ||'|'||pgc.COST_TYPE AS TRANS_PROD_SET_ITEM_ID,
       pgs.RECORD_STATUS,
       pgs.CREATED_BY,
       pgs.CREATED_DATE,
       pgs.LAST_UPDATED_BY,
       pgs.LAST_UPDATED_DATE,
       pgs.REV_NO,
       pgs.REV_TEXT
FROM
  PRODUCT_GROUP_SETUP pgs,
  PRODUCT_GROUP_COST pgc
WHERE
  pgs.object_id = pgc.object_id
  AND pgs.product_id = pgc.product_id
UNION ALL
SELECT pgs.object_id,
       pgs.PRODUCT_ID,
       'PRODUCT',
       pgs.SORT_ORDER PROD_SORT_ORDER,
       0 COST_SORT_ORDER,
       pgs.DAYTIME PROD_DAYTIME,
       pgs.END_DATE PROD_END_DATE,
       pgs.DAYTIME COST_DAYTIME,
       pgs.END_DATE COST_END_DATE,
       pgs.PRODUCT_ID ||'|PRODUCT'  AS TRANS_PROD_SET_ITEM_ID,
       pgs.RECORD_STATUS,
       pgs.CREATED_BY,
       pgs.CREATED_DATE,
       pgs.LAST_UPDATED_BY,
       pgs.LAST_UPDATED_DATE,
       pgs.REV_NO,
       pgs.REV_TEXT
FROM
  PRODUCT_GROUP_SETUP pgs
WHERE NOT EXISTS (SELECT OBJECT_ID
      FROM PRODUCT_GROUP_COST
      WHERE OBJECT_ID = pgs.OBJECT_ID
        AND PRODUCT_ID = pgs.PRODUCT_ID
        AND COST_TYPE = 'PRODUCT'
        AND DAYTIME >= pgs.daytime
        AND DAYTIME < NVL(pgs.END_DATE,DAYTIME+1))