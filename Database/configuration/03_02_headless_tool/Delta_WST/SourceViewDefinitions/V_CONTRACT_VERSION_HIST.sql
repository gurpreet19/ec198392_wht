CREATE OR REPLACE FORCE EDITIONABLE VIEW "V_CONTRACT_VERSION_HIST" ("JN_OPERATION", "JN_ORACLE_USER", "JN_DATETIME", "JN_NOTES", "JN_APPLN", "JN_SESSION", "OBJECT_ID", "DAYTIME", "NAME", "END_DATE", "SORT_ORDER", "CALC_RULE_ID", "CALC_SEQ", "CALC_GROUP", "PRODUCTION_DAY_ID", "FINANCIAL_CODE", "CONTRACT_AREA_ID", "CONTRACT_AREA_CODE", "PRICING_CURRENCY_ID", "BOOKING_CURRENCY_ID", "MEMO_CURRENCY_ID", "USE_DISTRIBUTION_IND", "UOM1_TMPL", "UOM2_TMPL", "UOM3_TMPL", "UOM4_TMPL", "PRICE_DECIMALS", "CONTRACT_GROUP_CODE", "CONTRACT_RESPONSIBLE", "CONTRACT_TERM_CODE", "BANK_DETAILS_LEVEL_CODE", "DOCUMENT_HANDLING_CODE", "LEGAL_NAME", "LEGAL_OWNER", "PRODUCT_TYPE", "SYSTEM_OWNER", "COMPANY_ID", "CONTRACT_STAGE_CODE", "FIRST_DELIVERY_DATE", "PROCESSABLE_CODE", "PARENT_CONTRACT_ID", "SA_DAY_CALC_ID", "SA_MTH_CALC_ID", "SA_YR_CALC_ID", "LAST_DELIVERY_DATE", "DIST_OBJECT_TYPE", "DIST_TYPE", "COMMENTS", "ALLOW_ALT_CUST_IND", "GROUP_REF_ID_1", "GROUP_REF_CODE_1", "GROUP_REF_ID_2", "GROUP_REF_CODE_2", "GROUP_REF_ID_3", "GROUP_REF_CODE_3", "GROUP_REF_ID_4", "GROUP_REF_CODE_4", "GROUP_REF_ID_5", "GROUP_REF_CODE_5", "GROUP_REF_ID_6", "GROUP_REF_CODE_6", "GROUP_REF_ID_7", "GROUP_REF_CODE_7", "GROUP_REF_ID_8", "GROUP_REF_CODE_8", "GROUP_REF_ID_9", "GROUP_REF_CODE_9", "OP_PU_ID", "OP_PU_CODE", "OP_AREA_ID", "OP_AREA_CODE", "DATE_1", "DATE_2", "DATE_3", "DATE_4", "DATE_5", "REF_OBJECT_ID_1", "REF_OBJECT_ID_2", "REF_OBJECT_ID_3", "REF_OBJECT_ID_4", "REF_OBJECT_ID_5", "TEXT_1", "TEXT_10", "TEXT_11", "TEXT_12", "TEXT_13", "TEXT_14", "TEXT_15", "TEXT_16", "TEXT_17", "TEXT_18", "TEXT_19", "TEXT_2", "TEXT_20", "TEXT_3", "TEXT_4", "TEXT_5", "TEXT_6", "TEXT_7", "TEXT_8", "TEXT_9", "VALUE_1", "VALUE_10", "VALUE_2", "VALUE_3", "VALUE_4", "VALUE_5", "VALUE_6", "VALUE_7", "VALUE_8", "VALUE_9", "CALC_APPROVAL_CHECK", "RECORD_STATUS", "CREATED_BY", "CREATED_DATE", "LAST_UPDATED_BY", "LAST_UPDATED_DATE", "REV_NO", "REV_TEXT", "APPROVAL_BY", "APPROVAL_DATE", "APPROVAL_STATE", "REC_ID") AS 
  (
----------------------------------------------------------------------------------------------------
-- File name: v_contract_version_hist.sql
-- View name: v_contract_version_hist
--
-- $Revision: 1.0 $
--
-- Purpose  : combine both Historical and Current version of records.
--
-- Modification history:
--9
-- Date       Whom       Change description:
-- ---------- ----       --------------------------------------------------------------------------------
-- 25.10.2016 hannnyii
----------------------------------------------------------------------------------------------------
  SELECT "JN_OPERATION","JN_ORACLE_USER","JN_DATETIME","JN_NOTES","JN_APPLN","JN_SESSION","OBJECT_ID","DAYTIME","NAME","END_DATE","SORT_ORDER","CALC_RULE_ID","CALC_SEQ","CALC_GROUP","PRODUCTION_DAY_ID","FINANCIAL_CODE","CONTRACT_AREA_ID","CONTRACT_AREA_CODE","PRICING_CURRENCY_ID","BOOKING_CURRENCY_ID","MEMO_CURRENCY_ID","USE_DISTRIBUTION_IND","UOM1_TMPL","UOM2_TMPL","UOM3_TMPL","UOM4_TMPL","PRICE_DECIMALS","CONTRACT_GROUP_CODE","CONTRACT_RESPONSIBLE","CONTRACT_TERM_CODE","BANK_DETAILS_LEVEL_CODE","DOCUMENT_HANDLING_CODE","LEGAL_NAME","LEGAL_OWNER","PRODUCT_TYPE","SYSTEM_OWNER","COMPANY_ID","CONTRACT_STAGE_CODE","FIRST_DELIVERY_DATE","PROCESSABLE_CODE","PARENT_CONTRACT_ID","SA_DAY_CALC_ID","SA_MTH_CALC_ID","SA_YR_CALC_ID","LAST_DELIVERY_DATE","DIST_OBJECT_TYPE","DIST_TYPE","COMMENTS","ALLOW_ALT_CUST_IND","GROUP_REF_ID_1","GROUP_REF_CODE_1","GROUP_REF_ID_2","GROUP_REF_CODE_2","GROUP_REF_ID_3","GROUP_REF_CODE_3","GROUP_REF_ID_4","GROUP_REF_CODE_4","GROUP_REF_ID_5","GROUP_REF_CODE_5","GROUP_REF_ID_6","GROUP_REF_CODE_6","GROUP_REF_ID_7","GROUP_REF_CODE_7","GROUP_REF_ID_8","GROUP_REF_CODE_8","GROUP_REF_ID_9","GROUP_REF_CODE_9","OP_PU_ID","OP_PU_CODE","OP_AREA_ID","OP_AREA_CODE","DATE_1","DATE_2","DATE_3","DATE_4","DATE_5","REF_OBJECT_ID_1","REF_OBJECT_ID_2","REF_OBJECT_ID_3","REF_OBJECT_ID_4","REF_OBJECT_ID_5","TEXT_1","TEXT_10","TEXT_11","TEXT_12","TEXT_13","TEXT_14","TEXT_15","TEXT_16","TEXT_17","TEXT_18","TEXT_19","TEXT_2","TEXT_20","TEXT_3","TEXT_4","TEXT_5","TEXT_6","TEXT_7","TEXT_8","TEXT_9","VALUE_1","VALUE_10","VALUE_2","VALUE_3","VALUE_4","VALUE_5","VALUE_6","VALUE_7","VALUE_8","VALUE_9","CALC_APPROVAL_CHECK","RECORD_STATUS","CREATED_BY","CREATED_DATE","LAST_UPDATED_BY","LAST_UPDATED_DATE","REV_NO","REV_TEXT","APPROVAL_BY","APPROVAL_DATE","APPROVAL_STATE","REC_ID" FROM (
    SELECT
    'CURRENT' jn_operation
    ,NVL(last_updated_by,created_by) jn_oracle_user
    ,Ecdp_Timestamp.getCurrentSysdate jn_datetime
    ,'CURRENT' jn_notes
    ,NULL jn_appln
    ,NULL jn_session
    ,OBJECT_ID,
	DAYTIME,
	NAME,
	END_DATE,
	SORT_ORDER,
	CALC_RULE_ID,
	CALC_SEQ,
	CALC_GROUP,
	PRODUCTION_DAY_ID,
	FINANCIAL_CODE,
	CONTRACT_AREA_ID,
	CONTRACT_AREA_CODE,
	PRICING_CURRENCY_ID,
	BOOKING_CURRENCY_ID,
	MEMO_CURRENCY_ID,
	USE_DISTRIBUTION_IND,
	UOM1_TMPL,
	UOM2_TMPL,
	UOM3_TMPL,
	UOM4_TMPL,
	PRICE_DECIMALS,
	CONTRACT_GROUP_CODE,
	CONTRACT_RESPONSIBLE,
	CONTRACT_TERM_CODE,
	BANK_DETAILS_LEVEL_CODE,
	DOCUMENT_HANDLING_CODE,
	LEGAL_NAME,
	LEGAL_OWNER,
	PRODUCT_TYPE,
	SYSTEM_OWNER,
	COMPANY_ID,
	CONTRACT_STAGE_CODE,
	FIRST_DELIVERY_DATE,
	PROCESSABLE_CODE,
	PARENT_CONTRACT_ID,
	SA_DAY_CALC_ID,
	SA_MTH_CALC_ID,
	SA_YR_CALC_ID,
	LAST_DELIVERY_DATE,
	DIST_OBJECT_TYPE,
	DIST_TYPE,
	COMMENTS,
	ALLOW_ALT_CUST_IND,
	GROUP_REF_ID_1,
	GROUP_REF_CODE_1,
	GROUP_REF_ID_2,
	GROUP_REF_CODE_2,
	GROUP_REF_ID_3,
	GROUP_REF_CODE_3,
	GROUP_REF_ID_4,
	GROUP_REF_CODE_4,
	GROUP_REF_ID_5,
	GROUP_REF_CODE_5,
	GROUP_REF_ID_6,
	GROUP_REF_CODE_6,
	GROUP_REF_ID_7,
	GROUP_REF_CODE_7,
	GROUP_REF_ID_8,
	GROUP_REF_CODE_8,
	GROUP_REF_ID_9,
	GROUP_REF_CODE_9,
	OP_PU_ID,
	OP_PU_CODE,
	OP_AREA_ID,
	OP_AREA_CODE,
	DATE_1,
	DATE_2,
	DATE_3,
	DATE_4,
	DATE_5,
	REF_OBJECT_ID_1,
	REF_OBJECT_ID_2,
	REF_OBJECT_ID_3,
	REF_OBJECT_ID_4,
	REF_OBJECT_ID_5,
	TEXT_1,
	TEXT_10,
	TEXT_11,
	TEXT_12,
	TEXT_13,
	TEXT_14,
	TEXT_15,
	TEXT_16,
	TEXT_17,
	TEXT_18,
	TEXT_19,
	TEXT_2,
	TEXT_20,
	TEXT_3,
	TEXT_4,
	TEXT_5,
	TEXT_6,
	TEXT_7,
	TEXT_8,
	TEXT_9,
	VALUE_1,
	VALUE_10,
	VALUE_2,
	VALUE_3,
	VALUE_4,
	VALUE_5,
	VALUE_6,
	VALUE_7,
	VALUE_8,
	VALUE_9,
	CALC_APPROVAL_CHECK,
	RECORD_STATUS,
	CREATED_BY,
	CREATED_DATE,
	LAST_UPDATED_BY,
	LAST_UPDATED_DATE,
	REV_NO,
	REV_TEXT,
	APPROVAL_BY,
	APPROVAL_DATE,
	APPROVAL_STATE,
	REC_ID
    FROM contract_version
    UNION
    SELECT
    jn_operation
    ,jn_oracle_user
    ,jn_datetime
    ,jn_notes
    ,jn_appln
    ,jn_session
    ,OBJECT_ID,
	DAYTIME,
	NAME,
	END_DATE,
	SORT_ORDER,
	CALC_RULE_ID,
	CALC_SEQ,
	CALC_GROUP,
	PRODUCTION_DAY_ID,
	FINANCIAL_CODE,
	CONTRACT_AREA_ID,
	CONTRACT_AREA_CODE,
	PRICING_CURRENCY_ID,
	BOOKING_CURRENCY_ID,
	MEMO_CURRENCY_ID,
	USE_DISTRIBUTION_IND,
	UOM1_TMPL,
	UOM2_TMPL,
	UOM3_TMPL,
	UOM4_TMPL,
	PRICE_DECIMALS,
	CONTRACT_GROUP_CODE,
	CONTRACT_RESPONSIBLE,
	CONTRACT_TERM_CODE,
	BANK_DETAILS_LEVEL_CODE,
	DOCUMENT_HANDLING_CODE,
	LEGAL_NAME,
	LEGAL_OWNER,
	PRODUCT_TYPE,
	SYSTEM_OWNER,
	COMPANY_ID,
	CONTRACT_STAGE_CODE,
	FIRST_DELIVERY_DATE,
	PROCESSABLE_CODE,
	PARENT_CONTRACT_ID,
	SA_DAY_CALC_ID,
	SA_MTH_CALC_ID,
	SA_YR_CALC_ID,
	LAST_DELIVERY_DATE,
	DIST_OBJECT_TYPE,
	DIST_TYPE,
	COMMENTS,
	ALLOW_ALT_CUST_IND,
	GROUP_REF_ID_1,
	GROUP_REF_CODE_1,
	GROUP_REF_ID_2,
	GROUP_REF_CODE_2,
	GROUP_REF_ID_3,
	GROUP_REF_CODE_3,
	GROUP_REF_ID_4,
	GROUP_REF_CODE_4,
	GROUP_REF_ID_5,
	GROUP_REF_CODE_5,
	GROUP_REF_ID_6,
	GROUP_REF_CODE_6,
	GROUP_REF_ID_7,
	GROUP_REF_CODE_7,
	GROUP_REF_ID_8,
	GROUP_REF_CODE_8,
	GROUP_REF_ID_9,
	GROUP_REF_CODE_9,
	OP_PU_ID,
	OP_PU_CODE,
	OP_AREA_ID,
	OP_AREA_CODE,
	DATE_1,
	DATE_2,
	DATE_3,
	DATE_4,
	DATE_5,
	REF_OBJECT_ID_1,
	REF_OBJECT_ID_2,
	REF_OBJECT_ID_3,
	REF_OBJECT_ID_4,
	REF_OBJECT_ID_5,
	TEXT_1,
	TEXT_10,
	TEXT_11,
	TEXT_12,
	TEXT_13,
	TEXT_14,
	TEXT_15,
	TEXT_16,
	TEXT_17,
	TEXT_18,
	TEXT_19,
	TEXT_2,
	TEXT_20,
	TEXT_3,
	TEXT_4,
	TEXT_5,
	TEXT_6,
	TEXT_7,
	TEXT_8,
	TEXT_9,
	VALUE_1,
	VALUE_10,
	VALUE_2,
	VALUE_3,
	VALUE_4,
	VALUE_5,
	VALUE_6,
	VALUE_7,
	VALUE_8,
	VALUE_9,
	CALC_APPROVAL_CHECK,
	RECORD_STATUS,
	CREATED_BY,
	CREATED_DATE,
	LAST_UPDATED_BY,
	LAST_UPDATED_DATE,
	REV_NO,
	REV_TEXT,
	APPROVAL_BY,
	APPROVAL_DATE,
	APPROVAL_STATE,
	REC_ID
    FROM contract_version_jn
  )
)