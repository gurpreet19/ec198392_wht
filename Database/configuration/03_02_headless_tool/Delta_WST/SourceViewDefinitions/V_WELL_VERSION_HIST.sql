CREATE OR REPLACE FORCE EDITIONABLE VIEW "V_WELL_VERSION_HIST" ("JN_UPD_CREATE_DATE", "JN_OPERATION", "JN_ORACLE_USER", "JN_DATETIME", "JN_NOTES", "JN_APPLN", "JN_SESSION", "OBJECT_ID", "DAYTIME", "END_DATE", "NAME", "WELL_TYPE", "PUMP_TYPE", "INSTRUMENTATION_TYPE", "BF_PROFILE", "CHOKE_ID", "CHOKE_UOM", "CALC_METHOD", "PROD_METHOD", "GAS_LIFT_METHOD", "ON_STRM_METHOD", "APPROACH_METHOD", "CALC_INJ_METHOD", "WELL_TEST_METHOD", "CALC_METHOD_MASS", "DILUENT_METHOD", "POTENTIAL_METHOD", "STD_GAS_DENSITY_METHOD", "STD_OIL_DENSITY_METHOD", "BSW_VOL_METHOD", "CGR_METHOD", "SAND_METHOD", "GOR_METHOD", "WGR_METHOD", "WDF_METHOD", "WOR_METHOD", "BH_GL_VALVE_MD", "BH_PRESS_GAUGE_MD", "CALC_STEAM_INJ_METHOD", "CALC_WATER_INJ_METHOD", "POTENTIAL_MASS_METHOD", "CALC_SUB_DAY_METHOD", "CALC_COND_METHOD", "CALC_GAS_METHOD", "CALC_SUB_DAY_COND_METHOD", "CALC_SUB_DAY_GAS_METHOD", "CALC_SUB_DAY_WATER_METHOD", "CALC_WATER_METHOD", "CO2_DIAGRAM_LAYOUT_INFO", "PROC_NODE_CO2_ID", "DILUENT_SUB_DAY_METHOD", "GAS_LIFT_SUB_DAY_METHOD", "POTENTIAL_GAS_INJ_METHOD", "POT_STEAM_INJ_METHOD", "POT_WATER_INJ_METHOD", "GI_EVENT_INJ_DATA_METHOD", "SI_EVENT_INJ_DATA_METHOD", "WI_EVENT_INJ_DATA_METHOD", "STD_WAT_DENSITY_METHOD", "FLUID_QUALITY", "FORECAST_SCENARIO", "FORECAST_TYPE", "ALLOC_FLAG", "ALLOC_FIXED", "ALLOC_FIXED_WC", "ALLOC_FIXED_GOR", "BH_GL_VALVE_TVD", "BH_PRESS_GAUGE_TVD", "WELL_METER_FREQ", "WELL_CALC_RULE", "DIAGRAM_LAYOUT_INFO", "DL_DIAGRAM_LAYOUT_INFO", "GI_DIAGRAM_LAYOUT_INFO", "GL_DIAGRAM_LAYOUT_INFO", "GP_DIAGRAM_LAYOUT_INFO", "OP_DIAGRAM_LAYOUT_INFO", "WI_DIAGRAM_LAYOUT_INFO", "WP_DIAGRAM_LAYOUT_INFO", "SI_DIAGRAM_LAYOUT_INFO", "CI_DIAGRAM_LAYOUT_INFO", "WELL_HOLE_ID", "WELL_REFERENCE_OBJ_ID", "COMMERCIAL_ENTITY_ID", "FLOWLINE_1_ID", "FLOWLINE_2_ID", "PROCESS_TRAIN_ID", "GL_CHOKE_ID", "DEF_FCTY_CLASS_1_ID", "DEF_EQUIPMENT_ID", "DEF_FLOWLINE_ID", "DEF_PUMP_ID", "DEF_COMPRESSOR_ID", "DEF_CTRL_SAFETY_SYSTEM_ID", "DEF_GAS_PROC_ID", "DEF_POWER_DISTRIBUTION_ID", "DEF_UTILITY_ID", "TEST_DEVICE_ID", "COUNTY_ID", "MMS_LEASE_ID", "OPERATOR_LEASE_ID", "STATE_LEASE_ID", "ISAIRINJECTOR", "ISCONDENSATEPRODUCER", "ISGASINJECTOR", "ISGASPRODUCER", "ISINJECTOR", "ISNOTOTHER", "ISOILPRODUCER", "ISOTHER", "ISPRODUCER", "ISPRODUCEROROTHER", "ISSTEAMINJECTOR", "ISWASTEINJECTOR", "ISWATERINJECTOR", "ISCO2INJECTOR", "ISWATERPRODUCER", "PROC_NODE_OIL_ID", "PROC_NODE_GAS_ID", "PROC_NODE_COND_ID", "PROC_NODE_WATER_ID", "PROC_NODE_WATER_INJ_ID", "PROC_NODE_STEAM_INJ_ID", "PROC_NODE_GAS_INJ_ID", "PROC_NODE_DILUENT_ID", "PROC_NODE_GAS_LIFT_ID", "PROC_NODE_CO2_INJ_ID", "OFFICIAL_NAME", "DECLINE_FLAG", "CALC_CO2_INJ_METHOD", "CALC_CO2_METHOD", "POT_CO2_INJ_METHOD", "ENERGY_METHOD", "GCV_METHOD", "GWR_METHOD", "REF_GAS_CONST_STD_ID", "REF_GAS_FLUID_STATE", "REF_OIL_CONST_STD_ID", "REF_OIL_FLUID_STATE", "COMP_GASINJ_CODE", "COMP_GAS_CODE", "COMP_LIQ_CODE", "MASTER_SYS_NAME", "CALC_INJ_METHOD_MASS", "ALLOW_THEOR_OVERRIDE", "DEPTH_MEAS_REF", "DWF_METHOD", "DETAILED_PROD_METHOD", "WELL_METER_METHOD", "WELL_CLASS", "SORT_ORDER", "COMMENTS", "OP_PU_ID", "OP_PU_CODE", "OP_SUB_PU_ID", "OP_SUB_PU_CODE", "OP_AREA_ID", "OP_AREA_CODE", "OP_SUB_AREA_ID", "OP_SUB_AREA_CODE", "OP_FCTY_CLASS_2_ID", "OP_FCTY_CLASS_2_CODE", "OP_FCTY_CLASS_1_ID", "OP_FCTY_CLASS_1_CODE", "SECONDARY_FCTY_ID", "SECONDARY_FCTY_CODE", "OP_WELL_HOOKUP_ID", "OP_WELL_HOOKUP_CODE", "GEO_AREA_ID", "GEO_AREA_CODE", "GEO_SUB_AREA_ID", "GEO_SUB_AREA_CODE", "GEO_FIELD_ID", "GEO_FIELD_CODE", "GEO_SUB_FIELD_ID", "GEO_SUB_FIELD_CODE", "SLEEVE_UOM", "PUMP_ID", "EAST_UTM_SURFACE", "NORTH_UTM_SURFACE", "RKB_HEIGHT", "SHAFT", "SLOT_NO", "GI_CHOKE_ID", "WI_CHOKE_ID", "CHOKE_DATE", "GL_SOURCE_STRM_ID", "SAND_UOM", "SAND_2_UOM", "EROSION_UOM", "TEXT_1", "TEXT_2", "TEXT_3", "TEXT_4", "TEXT_5", "TEXT_6", "TEXT_7", "TEXT_8", "TEXT_9", "TEXT_10", "TEXT_11", "TEXT_12", "TEXT_13", "TEXT_14", "TEXT_15", "TEXT_16", "TEXT_17", "TEXT_18", "TEXT_19", "TEXT_20", "TEXT_21", "TEXT_22", "TEXT_23", "TEXT_24", "TEXT_25", "TEXT_26", "TEXT_27", "TEXT_28", "TEXT_29", "TEXT_30", "TEXT_31", "TEXT_32", "TEXT_33", "TEXT_34", "TEXT_35", "TEXT_36", "TEXT_37", "TEXT_38", "TEXT_39", "TEXT_40", "TEXT_41", "TEXT_42", "TEXT_43", "TEXT_44", "TEXT_45", "TEXT_46", "TEXT_47", "TEXT_48", "TEXT_49", "TEXT_50", "VALUE_1", "VALUE_2", "VALUE_3", "VALUE_4", "VALUE_5", "VALUE_6", "VALUE_7", "VALUE_8", "VALUE_9", "VALUE_10", "VALUE_11", "VALUE_12", "VALUE_13", "VALUE_14", "VALUE_15", "DATE_1", "DATE_2", "DATE_3", "DATE_4", "DATE_5", "REF_OBJECT_ID_1", "REF_OBJECT_ID_2", "REF_OBJECT_ID_3", "REF_OBJECT_ID_4", "REF_OBJECT_ID_5", "GROUP_REF_ID_1", "GROUP_REF_CODE_1", "GROUP_REF_ID_2", "GROUP_REF_CODE_2", "GROUP_REF_ID_3", "GROUP_REF_CODE_3", "GROUP_REF_ID_4", "GROUP_REF_CODE_4", "GROUP_REF_ID_5", "GROUP_REF_CODE_5", "GROUP_REF_ID_6", "GROUP_REF_CODE_6", "GROUP_REF_ID_7", "GROUP_REF_CODE_7", "GROUP_REF_ID_8", "GROUP_REF_CODE_8", "GROUP_REF_ID_9", "GROUP_REF_CODE_9", "GROUP_REF_ID_10", "GROUP_REF_CODE_10", "CP_AREA_CODE", "CP_AREA_ID", "CP_COL_POINT_CODE", "CP_COL_POINT_ID", "CP_OPERATOR_ROUTE_CODE", "CP_OPERATOR_ROUTE_ID", "CP_PU_CODE", "CP_PU_ID", "CP_SUB_AREA_CODE", "CP_SUB_AREA_ID", "CP_SUB_PU_CODE", "CP_SUB_PU_ID", "FFV_FLAG", "DSM_FLARE_METHOD", "DSM_FUEL_METHOD", "DSM_VENT_METHOD", "USM_FLARE_METHOD", "USM_FUEL_METHOD", "USM_VENT_METHOD", "REF_SEASONAL_WELL_ID", "CALC_EVENT_METHOD", "CALC_EVENT_GAS_METHOD", "CALC_EVENT_WATER_METHOD", "CALC_EVENT_COND_METHOD", "CALC_OIL_MTH_METHOD", "CALC_GAS_MTH_METHOD", "CALC_WATER_MTH_METHOD", "CALC_COND_MTH_METHOD", "ALLOW_THEOR_OVERRIDE_MTH", "CALC_STEAM_INJ_MTH_MTD", "RECORD_STATUS", "CREATED_BY", "CREATED_DATE", "LAST_UPDATED_BY", "LAST_UPDATED_DATE", "REV_NO", "REV_TEXT", "APPROVAL_BY", "APPROVAL_DATE", "APPROVAL_STATE", "REC_ID") AS 
  (
----------------------------------------------------------------------------------------------------
-- File name: v_well_version_hist.sql
-- View name: v_well_version_hist
--
-- $Revision: 1.0 $
--
-- Purpose  : combine both Historical and Current version of records.
--
-- Modification history:
--9
-- Date       Whom       Change description:
-- ---------- ----       --------------------------------------------------------------------------------
-- 27.10.2015 wonggkai   ECPD-30931:Intial version
----------------------------------------------------------------------------------------------------
	SELECT "JN_UPD_CREATE_DATE","JN_OPERATION","JN_ORACLE_USER","JN_DATETIME","JN_NOTES","JN_APPLN","JN_SESSION","OBJECT_ID","DAYTIME","END_DATE","NAME","WELL_TYPE","PUMP_TYPE","INSTRUMENTATION_TYPE","BF_PROFILE","CHOKE_ID","CHOKE_UOM","CALC_METHOD","PROD_METHOD","GAS_LIFT_METHOD","ON_STRM_METHOD","APPROACH_METHOD","CALC_INJ_METHOD","WELL_TEST_METHOD","CALC_METHOD_MASS","DILUENT_METHOD","POTENTIAL_METHOD","STD_GAS_DENSITY_METHOD","STD_OIL_DENSITY_METHOD","BSW_VOL_METHOD","CGR_METHOD","SAND_METHOD","GOR_METHOD","WGR_METHOD","WDF_METHOD","WOR_METHOD","BH_GL_VALVE_MD","BH_PRESS_GAUGE_MD","CALC_STEAM_INJ_METHOD","CALC_WATER_INJ_METHOD","POTENTIAL_MASS_METHOD","CALC_SUB_DAY_METHOD","CALC_COND_METHOD","CALC_GAS_METHOD","CALC_SUB_DAY_COND_METHOD","CALC_SUB_DAY_GAS_METHOD","CALC_SUB_DAY_WATER_METHOD","CALC_WATER_METHOD","CO2_DIAGRAM_LAYOUT_INFO","PROC_NODE_CO2_ID","DILUENT_SUB_DAY_METHOD","GAS_LIFT_SUB_DAY_METHOD","POTENTIAL_GAS_INJ_METHOD","POT_STEAM_INJ_METHOD","POT_WATER_INJ_METHOD","GI_EVENT_INJ_DATA_METHOD","SI_EVENT_INJ_DATA_METHOD","WI_EVENT_INJ_DATA_METHOD","STD_WAT_DENSITY_METHOD","FLUID_QUALITY","FORECAST_SCENARIO","FORECAST_TYPE","ALLOC_FLAG","ALLOC_FIXED","ALLOC_FIXED_WC","ALLOC_FIXED_GOR","BH_GL_VALVE_TVD","BH_PRESS_GAUGE_TVD","WELL_METER_FREQ","WELL_CALC_RULE","DIAGRAM_LAYOUT_INFO","DL_DIAGRAM_LAYOUT_INFO","GI_DIAGRAM_LAYOUT_INFO","GL_DIAGRAM_LAYOUT_INFO","GP_DIAGRAM_LAYOUT_INFO","OP_DIAGRAM_LAYOUT_INFO","WI_DIAGRAM_LAYOUT_INFO","WP_DIAGRAM_LAYOUT_INFO","SI_DIAGRAM_LAYOUT_INFO","CI_DIAGRAM_LAYOUT_INFO","WELL_HOLE_ID","WELL_REFERENCE_OBJ_ID","COMMERCIAL_ENTITY_ID","FLOWLINE_1_ID","FLOWLINE_2_ID","PROCESS_TRAIN_ID","GL_CHOKE_ID","DEF_FCTY_CLASS_1_ID","DEF_EQUIPMENT_ID","DEF_FLOWLINE_ID","DEF_PUMP_ID","DEF_COMPRESSOR_ID","DEF_CTRL_SAFETY_SYSTEM_ID","DEF_GAS_PROC_ID","DEF_POWER_DISTRIBUTION_ID","DEF_UTILITY_ID","TEST_DEVICE_ID","COUNTY_ID","MMS_LEASE_ID","OPERATOR_LEASE_ID","STATE_LEASE_ID","ISAIRINJECTOR","ISCONDENSATEPRODUCER","ISGASINJECTOR","ISGASPRODUCER","ISINJECTOR","ISNOTOTHER","ISOILPRODUCER","ISOTHER","ISPRODUCER","ISPRODUCEROROTHER","ISSTEAMINJECTOR","ISWASTEINJECTOR","ISWATERINJECTOR","ISCO2INJECTOR","ISWATERPRODUCER","PROC_NODE_OIL_ID","PROC_NODE_GAS_ID","PROC_NODE_COND_ID","PROC_NODE_WATER_ID","PROC_NODE_WATER_INJ_ID","PROC_NODE_STEAM_INJ_ID","PROC_NODE_GAS_INJ_ID","PROC_NODE_DILUENT_ID","PROC_NODE_GAS_LIFT_ID","PROC_NODE_CO2_INJ_ID","OFFICIAL_NAME","DECLINE_FLAG","CALC_CO2_INJ_METHOD","CALC_CO2_METHOD","POT_CO2_INJ_METHOD","ENERGY_METHOD","GCV_METHOD","GWR_METHOD","REF_GAS_CONST_STD_ID","REF_GAS_FLUID_STATE","REF_OIL_CONST_STD_ID","REF_OIL_FLUID_STATE","COMP_GASINJ_CODE","COMP_GAS_CODE","COMP_LIQ_CODE","MASTER_SYS_NAME","CALC_INJ_METHOD_MASS","ALLOW_THEOR_OVERRIDE","DEPTH_MEAS_REF","DWF_METHOD","DETAILED_PROD_METHOD","WELL_METER_METHOD","WELL_CLASS","SORT_ORDER","COMMENTS","OP_PU_ID","OP_PU_CODE","OP_SUB_PU_ID","OP_SUB_PU_CODE","OP_AREA_ID","OP_AREA_CODE","OP_SUB_AREA_ID","OP_SUB_AREA_CODE","OP_FCTY_CLASS_2_ID","OP_FCTY_CLASS_2_CODE","OP_FCTY_CLASS_1_ID","OP_FCTY_CLASS_1_CODE","SECONDARY_FCTY_ID","SECONDARY_FCTY_CODE","OP_WELL_HOOKUP_ID","OP_WELL_HOOKUP_CODE","GEO_AREA_ID","GEO_AREA_CODE","GEO_SUB_AREA_ID","GEO_SUB_AREA_CODE","GEO_FIELD_ID","GEO_FIELD_CODE","GEO_SUB_FIELD_ID","GEO_SUB_FIELD_CODE","SLEEVE_UOM","PUMP_ID","EAST_UTM_SURFACE","NORTH_UTM_SURFACE","RKB_HEIGHT","SHAFT","SLOT_NO","GI_CHOKE_ID","WI_CHOKE_ID","CHOKE_DATE","GL_SOURCE_STRM_ID","SAND_UOM","SAND_2_UOM","EROSION_UOM","TEXT_1","TEXT_2","TEXT_3","TEXT_4","TEXT_5","TEXT_6","TEXT_7","TEXT_8","TEXT_9","TEXT_10","TEXT_11","TEXT_12","TEXT_13","TEXT_14","TEXT_15","TEXT_16","TEXT_17","TEXT_18","TEXT_19","TEXT_20","TEXT_21","TEXT_22","TEXT_23","TEXT_24","TEXT_25","TEXT_26","TEXT_27","TEXT_28","TEXT_29","TEXT_30","TEXT_31","TEXT_32","TEXT_33","TEXT_34","TEXT_35","TEXT_36","TEXT_37","TEXT_38","TEXT_39","TEXT_40","TEXT_41","TEXT_42","TEXT_43","TEXT_44","TEXT_45","TEXT_46","TEXT_47","TEXT_48","TEXT_49","TEXT_50","VALUE_1","VALUE_2","VALUE_3","VALUE_4","VALUE_5","VALUE_6","VALUE_7","VALUE_8","VALUE_9","VALUE_10","VALUE_11","VALUE_12","VALUE_13","VALUE_14","VALUE_15","DATE_1","DATE_2","DATE_3","DATE_4","DATE_5","REF_OBJECT_ID_1","REF_OBJECT_ID_2","REF_OBJECT_ID_3","REF_OBJECT_ID_4","REF_OBJECT_ID_5","GROUP_REF_ID_1","GROUP_REF_CODE_1","GROUP_REF_ID_2","GROUP_REF_CODE_2","GROUP_REF_ID_3","GROUP_REF_CODE_3","GROUP_REF_ID_4","GROUP_REF_CODE_4","GROUP_REF_ID_5","GROUP_REF_CODE_5","GROUP_REF_ID_6","GROUP_REF_CODE_6","GROUP_REF_ID_7","GROUP_REF_CODE_7","GROUP_REF_ID_8","GROUP_REF_CODE_8","GROUP_REF_ID_9","GROUP_REF_CODE_9","GROUP_REF_ID_10","GROUP_REF_CODE_10","CP_AREA_CODE","CP_AREA_ID","CP_COL_POINT_CODE","CP_COL_POINT_ID","CP_OPERATOR_ROUTE_CODE","CP_OPERATOR_ROUTE_ID","CP_PU_CODE","CP_PU_ID","CP_SUB_AREA_CODE","CP_SUB_AREA_ID","CP_SUB_PU_CODE","CP_SUB_PU_ID","FFV_FLAG","DSM_FLARE_METHOD","DSM_FUEL_METHOD","DSM_VENT_METHOD","USM_FLARE_METHOD","USM_FUEL_METHOD","USM_VENT_METHOD","REF_SEASONAL_WELL_ID","CALC_EVENT_METHOD","CALC_EVENT_GAS_METHOD","CALC_EVENT_WATER_METHOD","CALC_EVENT_COND_METHOD","CALC_OIL_MTH_METHOD","CALC_GAS_MTH_METHOD","CALC_WATER_MTH_METHOD","CALC_COND_MTH_METHOD","ALLOW_THEOR_OVERRIDE_MTH","CALC_STEAM_INJ_MTH_MTD","RECORD_STATUS","CREATED_BY","CREATED_DATE","LAST_UPDATED_BY","LAST_UPDATED_DATE","REV_NO","REV_TEXT","APPROVAL_BY","APPROVAL_DATE","APPROVAL_STATE","REC_ID" FROM (
	  SELECT
		NVL(LAST_UPDATED_DATE,created_date) jn_upd_create_date
		,'CURRENT' jn_operation
		,nvl(last_updated_by,created_by) jn_oracle_user
		,nvl(LAST_UPDATED_DATE,created_date) jn_datetime
		,'CURRENT' jn_notes
		,NULL jn_appln
		,NULL jn_session
		,wv.*
	  FROM well_version wv
	  UNION
	  SELECT NVL(LAST_UPDATED_DATE,created_date) jn_upd_create_date
	  , well_version_jn.*
	  FROM well_version_jn
	)
)