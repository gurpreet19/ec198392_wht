CREATE OR REPLACE FORCE EDITIONABLE VIEW "V_TRANS_INVENTORY_SINGLE" ("VALUE", "TABLE_NAME", "COLUMN_NAME", "DAYTIME", "CALC_REF_ID", "KEY", "DIMENSION_TAG", "LAYER_MONTH", "KEY2", "OBJECT_ID", "RECORD_STATUS", "CREATED_BY", "CREATED_DATE", "LAST_UPDATED_BY", "LAST_UPDATED_DATE", "REV_NO", "REV_TEXT") AS 
  SELECT
  ECDP_TRANS_INVENTORY.SingleValue(
  OBJECT_ID,
  DAYTIME,
  LAYER_MONTH,
  DIMENSION_TAG,
  'TRANS_INVENTORY_BALANCE',
  CALC_RUN_NO,
  column_name
  ) VALUE,
  'TRANS_INVENTORY_BALANCE' TABLE_NAME,
  COLUMN_NAME,
  DECODE(month_switch,'CURRENT',DAYTIME,ADD_MONTHS(DAYTIME,1)) DAYTIME,
  calc_run_no calc_ref_id,
  X.OBJECT_ID||'$'||X.DIMENSION_TAG||'$'||  TO_CHAR(X.LAYER_MONTH,' YYYY-MM-DD"T"HH24:MI:SS') KEY,
  X.DIMENSION_TAG,
  LAYER_MONTH,
  KEY KEY2,
  OBJECT_ID,
  record_status,
  created_by,
  created_date,
  last_updated_by,
  last_updated_date,
  rev_no,
  rev_text
FROM TRANS_INVENTORY_BALANCE X,
     (SELECT 'QTY_1' AS COLUMN_NAME FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'QTY_2' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'QTY_3' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'QTY_4' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'QTY_5' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'QTY_6' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'QTY_7' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'QTY_8' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'QTY_9' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'QTY_10' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'VALUE_1' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'VALUE_2' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'VALUE_3' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'VALUE_4' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'VALUE_5' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'VALUE_6' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'VALUE_7' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'VALUE_8' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'VALUE_9' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'VALUE_10' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'COST_1' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'COST_2' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'COST_3' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'COST_4' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'COST_5' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'COST_6' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'COST_7' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'COST_8' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'COST_9' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'COST_10' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'COST_11' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'COST_12' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'COST_13' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'COST_14' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'COST_15' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'COST_16' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'COST_17' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'COST_18' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'COST_19' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'COST_20' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'UNIT_PRICE_1' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'UNIT_PRICE_2' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'UNIT_PRICE_3' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'UNIT_PRICE_4' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'UNIT_PRICE_5' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'UNIT_PRICE_6' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'UNIT_PRICE_7' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'UNIT_PRICE_8' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'UNIT_PRICE_9' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'UNIT_PRICE_10' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'UNIT_PRICE_11' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'UNIT_PRICE_12' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'UNIT_PRICE_13' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'UNIT_PRICE_14' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'UNIT_PRICE_15' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'UNIT_PRICE_16' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'UNIT_PRICE_17' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'UNIT_PRICE_18' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'UNIT_PRICE_19' FROM PROSTY_CODES WHERE CODE='DUAL' AND CODE_TYPE='DUAL' UNION ALL
 SELECT 'UNIT_PRICE_20' FROM DUAL ) X,
 (SELECT 'CURRENT' month_switch FROM PROSTY_CODES WHERE CODE='DUAL'
  UNION ALL
  SELECT 'PREVIOUS' FROM PROSTY_CODES WHERE CODE='DUAL') MONTHS