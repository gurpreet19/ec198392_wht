CREATE OR REPLACE FORCE EDITIONABLE VIEW "V_PTST_PWEL_RESULT_DATA" ("OBJECT_ID", "DAYTIME", "RESULT_CLASS_NAME", "END_DATE", "RESULT_NO", "RESULT_NO_COMB", "DURATION", "PRODUCTION_DAY", "FACILITY_ID", "TEST_DEVICE_ID", "TEST_NO", "TEST_TYPE", "RESULT_TYPE", "VALID_FROM_DATE", "STATUS", "USE_CALC_IND", "ACCEPTED_DATE", "PRIMARY_IND", "TDEV_PRESS", "TDEV_TEMP", "OIL_OUT_RATE", "GAS_OUT_RATE", "WATER_OUT_RATE", "OIL_OUT_RATE_RAW", "GAS_OUT_RATE_RAW", "WATER_OUT_RATE_RAW", "OIL_IN_WATER_OUT", "WATER_IN_OIL_OUT", "CHOKE_SIZE", "AVG_CHOKE_SIZE_2", "DP_VENTURI", "LIQUID_RATE_ADJ", "NET_OIL_MASS_RATE_ADJ", "NET_OIL_RATE_ADJ", "NET_OIL_DENSITY_ADJ", "NET_COND_MASS_RATE_ADJ", "NET_COND_RATE_ADJ", "NET_COND_DENSITY_ADJ", "GAS_MASS_RATE_ADJ", "GAS_RATE_ADJ", "GAS_DENSITY_ADJ", "TOT_WATER_MASS_RATE_ADJ", "TOT_WATER_RATE_ADJ", "TOT_WATER_DENSITY_ADJ", "GL_RATE", "GL_DENSITY", "GL_CHOKE_SIZE", "GL_DIFF_PRESS", "GL_PRESS", "GL_USC_PRESS", "GL_TEMP", "GL_USC_TEMP", "WATERCUT_PCT", "CGR", "GLR", "GOR", "WGR", "WOR", "API", "OIL_SG", "OIL_SHRINKAGE", "SOLUTION_GAS_FACTOR", "GAS_SP_GRAV", "WET_GAS_GRAVITY", "DRY_WET_GAS_RATIO", "WET_DRY_GAS_RATIO", "DILUENT_RATE", "INTAKE_PRESS", "INTAKE_TEMP", "DRIVE_CURRENT", "DRIVE_FREQUENCY", "DRIVE_VOLTAGE", "PUMP_POWER", "PUMP_SPEED", "OUTLET_PRESS", "OUTLET_TEMP", "FWS_RATE", "ANNULUS_PRESS", "ANNULUS_TEMP", "BH_PRESS", "BH_TEMP", "SI_BHP", "SI_WHP", "WH_PRESS", "WH_TEMP", "WH_USC_PRESS", "WH_USC_TEMP", "WH_DSC_PRESS", "WH_DSC_TEMP", "SAND_RATE", "PURGE_DURATION", "RATE_SOURCE", "WELL_TEST_REASON", "PROD_INDEX", "RESERVOIR_PRESS", "COMMENTS", "RECORD_STATUS", "CREATED_BY", "CREATED_DATE", "LAST_UPDATED_BY", "LAST_UPDATED_DATE", "REV_NO", "REV_TEXT", "APPROVAL_STATE", "APPROVAL_BY", "APPROVAL_DATE", "REC_ID") AS 
  (
------------------------------------------------------------------------------------
--  V_PTST_PWEL_RESULT_DATA
--
-- $Revision: 1.0 $
--
--  Purpose:   Provide the well test results independent if it is a single well test or not.
--  Note:
--
--  Date           Whom 		Change description:
--  -------------- --------		--------
--  05-08-2016     aaaaasho     ECPD-36142:Intial version
--  01-09-2016     aaaaasho     Added PROD_INDEX and RESERVOIR_PRESS, required by STEC
-------------------------------------------------------------------------------------
SELECT /*+FIRST_ROWS */
PWR.OBJECT_ID                   AS OBJECT_ID
,PTR.DAYTIME                    AS DAYTIME
,PWR.DATA_CLASS_NAME            AS RESULT_CLASS_NAME
,PTR.END_DATE                   AS END_DATE
,PTR.RESULT_NO                  AS RESULT_NO
,PWR.RESULT_NO_COMB             AS RESULT_NO_COMB
,PTR.DURATION                   AS DURATION
,PTR.PRODUCTION_DAY             AS PRODUCTION_DAY
,PTR.FACILITY_ID                AS FACILITY_ID
,TDR.OBJECT_ID                  AS TEST_DEVICE_ID
,PTR.TEST_NO                    AS TEST_NO
,PTR.TEST_TYPE                  AS TEST_TYPE
,PTR.ESTIMATE_TYPE              AS RESULT_TYPE
,PTR.VALID_FROM_DATE            AS VALID_FROM_DATE
,PWR.STATUS                     AS STATUS
,PWR.USE_CALC                   AS USE_CALC_IND
,PTR.ACCEPTED_DATE              AS ACCEPTED_DATE
,PWR.PRIMARY_IND                AS PRIMARY_IND
,TDR.TDEV_PRESS                 AS TDEV_PRESS
,TDR.TDEV_TEMP                  AS TDEV_TEMP
,TDR.OIL_OUT_RATE               AS OIL_OUT_RATE
,TDR.GAS_OUT_RATE               AS GAS_OUT_RATE
,TDR.WATER_OUT_RATE             AS WATER_OUT_RATE
,TDR.OIL_OUT_RATE_RAW           AS OIL_OUT_RATE_RAW
,TDR.GAS_OUT_RATE_RAW           AS GAS_OUT_RATE_RAW
,TDR.WATER_OUT_RATE_RAW         AS WATER_OUT_RATE_RAW
,TDR.OIL_IN_WATER_OUT           AS OIL_IN_WATER_OUT
,TDR.WATER_IN_OIL_OUT           AS WATER_IN_OIL_OUT
,PWR.CHOKE_SIZE                 AS CHOKE_SIZE
,PWR.AVG_CHOKE_SIZE_2           AS AVG_CHOKE_SIZE_2
,PWR.DP_VENTURI                 AS DP_VENTURI
,PWR.LIQUID_RATE_ADJ            AS LIQUID_RATE_ADJ
,PWR.NET_OIL_MASS_RATE_ADJ      AS NET_OIL_MASS_RATE_ADJ
,PWR.NET_OIL_RATE_ADJ           AS NET_OIL_RATE_ADJ
,PWR.NET_OIL_DENSITY_ADJ        AS NET_OIL_DENSITY_ADJ
,PWR.NET_COND_MASS_RATE_ADJ     AS NET_COND_MASS_RATE_ADJ
,PWR.NET_COND_RATE_ADJ          AS NET_COND_RATE_ADJ
,PWR.NET_COND_DENSITY_ADJ       AS NET_COND_DENSITY_ADJ
,PWR.GAS_MASS_RATE_ADJ          AS GAS_MASS_RATE_ADJ
,PWR.GAS_RATE_ADJ               AS GAS_RATE_ADJ
,PWR.GAS_DENSITY_ADJ            AS GAS_DENSITY_ADJ
,PWR.TOT_WATER_MASS_RATE_ADJ    AS TOT_WATER_MASS_RATE_ADJ
,PWR.TOT_WATER_RATE_ADJ         AS TOT_WATER_RATE_ADJ
,PWR.TOT_WATER_DENSITY_ADJ      AS TOT_WATER_DENSITY_ADJ
,PWR.GL_RATE                    AS GL_RATE
,PWR.GL_DENSITY                 AS GL_DENSITY
,PWR.GL_CHOKE_SIZE              AS GL_CHOKE_SIZE
,PWR.GL_DIFF_PRESS              AS GL_DIFF_PRESS
,PWR.GL_PRESS                   AS GL_PRESS
,PWR.GL_USC_PRESS               AS GL_USC_PRESS
,PWR.GL_TEMP                    AS GL_TEMP
,PWR.GL_USC_TEMP                AS GL_USC_TEMP
,PWR.WATERCUT_PCT               AS WATERCUT_PCT
,PWR.CGR                        AS CGR
,PWR.GLR                        AS GLR
,PWR.GOR                        AS GOR
,PWR.WGR                        AS WGR
,PWR.WOR                        AS WOR
,PWR.API                        AS API
,PWR.OIL_SG                     AS OIL_SG
,PWR.OIL_SHRINKAGE              AS OIL_SHRINKAGE
,PWR.SOLUTION_GAS_FACTOR        AS SOLUTION_GAS_FACTOR
,PWR.GAS_SP_GRAV                AS GAS_SP_GRAV
,PWR.WET_GAS_GRAVITY            AS WET_GAS_GRAVITY
,PWR.DRY_WET_GAS_RATIO          AS DRY_WET_GAS_RATIO
,PWR.WET_DRY_GAS_RATIO          AS WET_DRY_GAS_RATIO
,PWR.DILUENT_RATE               AS DILUENT_RATE
,PWR.INTAKE_PRESS               AS INTAKE_PRESS
,PWR.INTAKE_TEMP                AS INTAKE_TEMP
,PWR.DRIVE_CURRENT              AS DRIVE_CURRENT
,PWR.DRIVE_FREQUENCY            AS DRIVE_FREQUENCY
,PWR.DRIVE_VOLTAGE              AS DRIVE_VOLTAGE
,PWR.PUMP_POWER                 AS PUMP_POWER
,PWR.PUMP_SPEED                 AS PUMP_SPEED
,PWR.OUTLET_PRESS               AS OUTLET_PRESS
,PWR.OUTLET_TEMP                AS OUTLET_TEMP
,PWR.FWS_RATE                   AS FWS_RATE
,PWR.ANNULUS_PRESS              AS ANNULUS_PRESS
,PWR.ANNULUS_TEMP               AS ANNULUS_TEMP
,PWR.BH_PRESS                   AS BH_PRESS
,PWR.BH_TEMP                    AS BH_TEMP
,PWR.SI_BHP                     AS SI_BHP
,PWR.SI_WHP                     AS SI_WHP
,PWR.WH_PRESS                   AS WH_PRESS
,PWR.WH_TEMP                    AS WH_TEMP
,PWR.WH_USC_PRESS               AS WH_USC_PRESS
,PWR.WH_USC_TEMP                AS WH_USC_TEMP
,PWR.WH_DSC_PRESS               AS WH_DSC_PRESS
,PWR.WH_DSC_TEMP                AS WH_DSC_TEMP
,PWR.SAND_RATE                  AS SAND_RATE
,PTR.PURGE_DURATION             AS PURGE_DURATION
,PWR.RATE_SOURCE                AS RATE_SOURCE
,PTR.WELL_TEST_REASON           AS WELL_TEST_REASON
,PWR.PROD_INDEX                 AS PROD_INDEX
,PWR.RESERVOIR_PRESS            AS RESERVOIR_PRESS
,PWR.COMMENTS                   AS COMMENTS
,PWR.RECORD_STATUS              AS RECORD_STATUS
,PWR.CREATED_BY                 AS CREATED_BY
,PWR.CREATED_DATE               AS CREATED_DATE
,PWR.LAST_UPDATED_BY            AS LAST_UPDATED_BY
,PWR.LAST_UPDATED_DATE          AS LAST_UPDATED_DATE
,PWR.REV_NO                     AS REV_NO
,PWR.REV_TEXT                   AS REV_TEXT
,PWR.APPROVAL_STATE             AS APPROVAL_STATE
,PWR.APPROVAL_BY                AS APPROVAL_BY
,PWR.APPROVAL_DATE              AS APPROVAL_DATE
,PWR.REC_ID                     AS REC_ID
FROM PWEL_RESULT PWR, TEST_DEVICE_RESULT TDR, PTST_RESULT PTR
WHERE PWR.RESULT_NO = PTR.RESULT_NO
AND TDR.RESULT_NO (+) = PTR.RESULT_NO
)