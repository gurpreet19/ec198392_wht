CREATE OR REPLACE FORCE EDITIONABLE VIEW "V_FCST_SUMM_REASON_MTH_CPR" ("FORECAST_ID_1", "OBJECT_ID_1", "FORECAST_ID_2", "OBJECT_ID_2", "MONTH", "REASON_CODE_1", "OIL_LOSS_VOLUME_1", "GAS_LOSS_VOLUME_1", "COND_LOSS_VOLUME_1", "WATER_LOSS_VOLUME_1", "WATER_INJ_LOSS_VOLUME_1", "STEAM_INJ_LOSS_VOLUME_1", "GAS_INJ_LOSS_VOLUME_1", "DILUENT_LOSS_VOLUME_1", "GAS_LIFT_LOSS_VOLUME_1", "CO2_INJ_LOSS_VOLUME_1", "OIL_LOSS_VOLUME_2", "GAS_LOSS_VOLUME_2", "COND_LOSS_VOLUME_2", "WATER_LOSS_VOLUME_2", "WATER_INJ_LOSS_VOLUME_2", "STEAM_INJ_LOSS_VOLUME_2", "GAS_INJ_LOSS_VOLUME_2", "DILUENT_LOSS_VOLUME_2", "GAS_LIFT_LOSS_VOLUME_2", "CO2_INJ_LOSS_VOLUME_2", "OIL_LOSS_VOL_DIFF", "GAS_LOSS_VOL_DIFF", "COND_LOSS_VOL_DIFF", "WATER_LOSS_VOL_DIFF", "WATER_INJ_LOSS_VOL_DIFF", "STEAM_INJ_LOSS_VOL_DIFF", "GAS_INJ_LOSS_VOL_DIFF", "DILUENT_LOSS_VOL_DIFF", "GAS_LIFT_LOSS_VOL_DIFF", "CO2_INJ_LOSS_VOL_DIFF", "RECORD_STATUS", "CREATED_BY", "CREATED_DATE", "LAST_UPDATED_BY", "LAST_UPDATED_DATE", "REV_NO", "REV_TEXT") AS 
  SELECT
       s1.FORECAST_ID AS FORECAST_ID_1,
       s1.OBJECT_ID AS OBJECT_ID_1,
       s2.FORECAST_ID AS FORECAST_ID_2,
       s2.OBJECT_ID AS OBJECT_ID_2,
       NVL(s1.MONTH_1,s2.MONTH_2) AS MONTH,
       NVL(s1.REASON_CODE_1,s2.REASON_CODE_2) AS REASON_CODE_1,
       s1.OIL_LOSS_VOLUME_1,
       s1.GAS_LOSS_VOLUME_1,
       s1.COND_LOSS_VOLUME_1,
       s1.WATER_LOSS_VOLUME_1,
       s1.WATER_INJ_LOSS_VOLUME_1,
       s1.STEAM_INJ_LOSS_VOLUME_1,
       s1.GAS_INJ_LOSS_VOLUME_1,
       s1.DILUENT_LOSS_VOLUME_1,
       s1.GAS_LIFT_LOSS_VOLUME_1,
       s1.CO2_INJ_LOSS_VOLUME_1,
       s2.OIL_LOSS_VOLUME_2,
       s2.GAS_LOSS_VOLUME_2,
       s2.COND_LOSS_VOLUME_2,
       s2.WATER_LOSS_VOLUME_2,
       s2.WATER_INJ_LOSS_VOLUME_2,
       s2.STEAM_INJ_LOSS_VOLUME_2,
       s2.GAS_INJ_LOSS_VOLUME_2,
       s2.DILUENT_LOSS_VOLUME_2,
       s2.GAS_LIFT_LOSS_VOLUME_2,
       s2.CO2_INJ_LOSS_VOLUME_2,
       COALESCE(s2.OIL_LOSS_VOLUME_2-s1.OIL_LOSS_VOLUME_1,s2.OIL_LOSS_VOLUME_2,-s1.OIL_LOSS_VOLUME_1)  AS OIL_LOSS_VOL_DIFF  ,
       COALESCE(s2.GAS_LOSS_VOLUME_2-s1.GAS_LOSS_VOLUME_1,s2.GAS_LOSS_VOLUME_2,-s1.GAS_LOSS_VOLUME_1)  AS  GAS_LOSS_VOL_DIFF,
       COALESCE(s2.COND_LOSS_VOLUME_2-s1.COND_LOSS_VOLUME_1,s2.COND_LOSS_VOLUME_2,-s1.COND_LOSS_VOLUME_1)  AS COND_LOSS_VOL_DIFF ,
       COALESCE(s2.WATER_LOSS_VOLUME_2-s1.WATER_LOSS_VOLUME_1,s2.WATER_LOSS_VOLUME_2,-s1.WATER_LOSS_VOLUME_1)  AS WATER_LOSS_VOL_DIFF ,
       COALESCE(s2.WATER_INJ_LOSS_VOLUME_2-s1.WATER_INJ_LOSS_VOLUME_1,s2.WATER_INJ_LOSS_VOLUME_2,-s1.WATER_INJ_LOSS_VOLUME_1)  AS WATER_INJ_LOSS_VOL_DIFF ,
       COALESCE(s2.STEAM_INJ_LOSS_VOLUME_2-s1.STEAM_INJ_LOSS_VOLUME_1,s2.STEAM_INJ_LOSS_VOLUME_2,-s1.STEAM_INJ_LOSS_VOLUME_1)  AS STEAM_INJ_LOSS_VOL_DIFF ,
       COALESCE(s2.GAS_INJ_LOSS_VOLUME_2-s1.GAS_INJ_LOSS_VOLUME_1,s2.GAS_INJ_LOSS_VOLUME_2,-s1.GAS_INJ_LOSS_VOLUME_1)  AS GAS_INJ_LOSS_VOL_DIFF ,
       COALESCE(s2.DILUENT_LOSS_VOLUME_2-s1.DILUENT_LOSS_VOLUME_1,s2.DILUENT_LOSS_VOLUME_2,-s1.DILUENT_LOSS_VOLUME_1)  AS DILUENT_LOSS_VOL_DIFF ,
       COALESCE(s2.GAS_LIFT_LOSS_VOLUME_2-s1.GAS_LIFT_LOSS_VOLUME_1,s2.GAS_LIFT_LOSS_VOLUME_2,-s1.GAS_LIFT_LOSS_VOLUME_1)  AS GAS_LIFT_LOSS_VOL_DIFF ,
       COALESCE(s2.CO2_INJ_LOSS_VOLUME_2-s1.CO2_INJ_LOSS_VOLUME_1,s2.CO2_INJ_LOSS_VOLUME_2,-s1.CO2_INJ_LOSS_VOLUME_1)  AS CO2_INJ_LOSS_VOL_DIFF ,
       NULL AS RECORD_STATUS,
       NULL AS CREATED_BY,
       NULL AS CREATED_DATE,
       NULL AS LAST_UPDATED_BY,
       NULL AS LAST_UPDATED_DATE,
       NULL AS REV_NO,
       NULL AS REV_TEXT
FROM  (SELECT FORECAST_ID, OBJECT_ID, MONTH AS MONTH_1, REASON_CODE_1 AS REASON_CODE_1, OIL_LOSS_VOLUME AS OIL_LOSS_VOLUME_1, GAS_LOSS_VOLUME AS GAS_LOSS_VOLUME_1,       COND_LOSS_VOLUME AS COND_LOSS_VOLUME_1, WATER_LOSS_VOLUME AS WATER_LOSS_VOLUME_1, WATER_INJ_LOSS_VOLUME AS WATER_INJ_LOSS_VOLUME_1, STEAM_INJ_LOSS_VOLUME AS       STEAM_INJ_LOSS_VOLUME_1, GAS_INJ_LOSS_VOLUME AS GAS_INJ_LOSS_VOLUME_1,DILUENT_LOSS_VOLUME AS DILUENT_LOSS_VOLUME_1, GAS_LIFT_LOSS_VOLUME AS    GAS_LIFT_LOSS_VOLUME_1, CO2_INJ_LOSS_VOLUME AS CO2_INJ_LOSS_VOLUME_1
       FROM TABLE(EcBp_Forecast_Prod.getGrpFcstEventDataMonth('SCENARIO_1'))) s1
FULL OUTER JOIN
      (SELECT FORECAST_ID, OBJECT_ID, MONTH AS MONTH_2,REASON_CODE_1 AS REASON_CODE_2,OIL_LOSS_VOLUME AS OIL_LOSS_VOLUME_2, GAS_LOSS_VOLUME AS GAS_LOSS_VOLUME_2, COND_LOSS_VOLUME AS COND_LOSS_VOLUME_2, WATER_LOSS_VOLUME AS WATER_LOSS_VOLUME_2, WATER_INJ_LOSS_VOLUME AS WATER_INJ_LOSS_VOLUME_2, STEAM_INJ_LOSS_VOLUME AS STEAM_INJ_LOSS_VOLUME_2, GAS_INJ_LOSS_VOLUME AS GAS_INJ_LOSS_VOLUME_2, DILUENT_LOSS_VOLUME AS DILUENT_LOSS_VOLUME_2, GAS_LIFT_LOSS_VOLUME AS GAS_LIFT_LOSS_VOLUME_2, CO2_INJ_LOSS_VOLUME AS CO2_INJ_LOSS_VOLUME_2
       FROM TABLE(EcBp_Forecast_Prod.getGrpFcstEventDataMonth('SCENARIO_2'))) s2
ON  s1.REASON_CODE_1 = s2.REASON_CODE_2
AND s1.MONTH_1 = s2.MONTH_2
ORDER BY REASON_CODE_1