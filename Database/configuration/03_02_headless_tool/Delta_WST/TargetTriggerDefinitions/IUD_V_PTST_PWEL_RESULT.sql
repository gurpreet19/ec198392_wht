CREATE OR REPLACE TRIGGER "IUD_V_PTST_PWEL_RESULT" 
 INSTEAD OF INSERT OR UPDATE OR DELETE ON v_ptst_pwel_result
FOR EACH ROW
-- $Revision: 1.16 $
-- $Author: Ron Boh
DECLARE
-- Variables for storing temporary values

ln_result_no NUMBER;
lv2_instr_type	VARCHAR2(32);
lv2_data_class_name VARCHAR2(32);
lv2_device_data_class_name VARCHAR2(32);
ld_production_day DATE;
lv_use_calc VARCHAR2(32);
lv_facility_id VARCHAR2(32);
ln_no_pwel_result_rec NUMBER;

BEGIN

-- INSERT BLOCK
IF INSERTING THEN

  -- Get the instrumentation type and determine which data class should the row be insert into
  lv2_instr_type :=  ec_well_version.instrumentation_type(:New.OBJECT_ID, :New.DAYTIME, '<=');
  lv_facility_id := ec_well_version.op_fcty_class_1_id(:new.OBJECT_ID, :new.DAYTIME, '<=');

  IF lv2_instr_type = '1' THEN
      lv2_data_class_name := 'PWEL_RESULT_1';
  ELSIF lv2_instr_type = '2' THEN
      lv2_data_class_name := 'PWEL_RESULT_2';
  ELSIF lv2_instr_type = '3' THEN
      lv2_data_class_name := 'PWEL_RESULT_3';
  ELSE
      lv2_data_class_name := 'PWEL_RESULT_1';
  END IF;

  lv2_device_data_class_name := 'PROD_TEST_RESULT';

  ld_production_day := EcDp_ProductionDay.getProductionDay('WELL',:New.OBJECT_ID, :New.DAYTIME);

  IF :New.USE_CALC IS NULL THEN
  	IF :NEW.STATUS = 'ACCEPTED' THEN
  		lv_use_calc := 'Y';
	ELSE
  		lv_use_calc := 'N';
  	END IF;
  ELSE
  	lv_use_calc := :New.USE_CALC;
  END IF;

  -- Insert values into PTST_RESULT
  INSERT INTO ptst_result (
	DAYTIME        ,
  	PRODUCTION_DAY ,
  CLASS_NAME     ,
	END_DATE       ,
	DURATION       ,
	USE_CALC       ,
	TEST_TYPE      ,
	ESTIMATE_TYPE  ,
	TEST_NO        ,
	SUMMARISED_IND ,
	VALID_FROM_DATE,
	STATUS         ,
	PREPROCESS_LOG ,
	FACILITY_ID    ,
	COMMENTS       ,
	VALUE_1        ,
	VALUE_2        ,
	VALUE_3        ,
	VALUE_4        ,
	VALUE_5        ,
	VALUE_6        ,
	VALUE_7        ,
	VALUE_8        ,
	VALUE_9        ,
	VALUE_10       ,
	TEXT_1         ,
	TEXT_2         ,
	TEXT_3         ,
	TEXT_4         ,
	CREATED_BY
  ) VALUES (
    	:New.DAYTIME        	  ,
      	ld_production_day         ,
       	lv2_device_data_class_name,
    	:New.END_DATE       	  ,
    	:New.DURATION       	  ,
    	lv_use_calc               ,
    	:New.TEST_TYPE      	  ,
    	:New.ESTIMATE_TYPE  	  ,
    	:New.TEST_NO        	  ,
    	:New.SUMMARISED_IND 	  ,
    	:New.VALID_FROM_DATE	  ,
    	nvl(:NEW.STATUS,'NEW') 	  ,
    	:New.PREPROCESS_LOG 	  ,
      lv_facility_id ,
    	:New.PTST_RESULT_COMMENTS ,
    	:New.PTST_RESULT_VALUE_1  ,
    	:New.PTST_RESULT_VALUE_2  ,
    	:New.PTST_RESULT_VALUE_3  ,
    	:New.PTST_RESULT_VALUE_4  ,
    	:New.PTST_RESULT_VALUE_5  ,
    	:New.PTST_RESULT_VALUE_6  ,
    	:New.PTST_RESULT_VALUE_7  ,
    	:New.PTST_RESULT_VALUE_8  ,
    	:New.PTST_RESULT_VALUE_9  ,
    	:New.PTST_RESULT_VALUE_10 ,
    	:New.PTST_RESULT_TEXT_1   ,
    	:New.PTST_RESULT_TEXT_2   ,
    	:New.PTST_RESULT_TEXT_3   ,
    	:New.PTST_RESULT_TEXT_4   ,
    	:New.CREATED_BY
  )RETURNING result_no INTO ln_result_no;


  -- Insert values into PWEL_RESULT
  INSERT INTO pwel_result (
	OBJECT_ID              ,
	RESULT_NO	       ,
	DATA_CLASS_NAME        ,
	RESULT_NO_COMB         ,
	PRIMARY_IND            ,
	FLOWING_IND            ,
	CHOKE_SIZE             ,
	WH_USC_PRESS           ,
	WH_USC_TEMP            ,
	WH_DSC_PRESS           ,
	WH_DSC_TEMP            ,
	WH_PRESS               ,
	WH_TEMP                ,
	BH_PRESS               ,
	BH_TEMP                ,
	ANNULUS_PRESS          ,
	ANNULUS_TEMP           ,
	SAND_RATE              ,
	EROSION_RATE           ,
	NET_OIL_RATE_ADJ       ,
	GAS_RATE_ADJ           ,
	NET_COND_RATE_ADJ      ,
	TOT_WATER_RATE_ADJ     ,
	NET_OIL_DENSITY_ADJ    ,
	GAS_DENSITY_ADJ        ,
	NET_COND_DENSITY_ADJ   ,
	TOT_WATER_DENSITY_ADJ  ,
	MPM_OIL_RATE_FLC       ,
	MPM_OIL_RATE           ,
	MPM_OIL_DENSITY        ,
	MPM_GAS_RATE_FLC       ,
	MPM_GAS_RATE           ,
	MPM_GAS_DENSITY        ,
	MPM_WATER_RATE_FLC     ,
	MPM_WATER_RATE         ,
	MPM_MIX_DENSITY        ,
	MPM_PRESS              ,
	MPM_TEMP               ,
	MPM_COND_RATE          ,
	MPM_OIL_MASS_RATE      ,
	MPM_GAS_MASS_RATE      ,
	MPM_COND_MASS_RATE     ,
	MPM_WATER_MASS_RATE    ,
	MPM_COND_DENSITY       ,
	MPM_WATER_DENSITY      ,
	MPM_COND_RATE_FLC      ,
	MPM_OIL_MASS_RATE_FLC  ,
	MPM_GAS_MASS_RATE_FLC  ,
	MPM_COND_MASS_RATE_FLC ,
	MPM_WATER_MASS_RATE_FLC,
	MPM_OIL_DENSITY_FLC    ,
	MPM_GAS_DENSITY_FLC    ,
	MPM_COND_DENSITY_FLC   ,
	MPM_WATER_DENSITY_FLC  ,
	MPM_MIX_DENSITY_FLC    ,
	MPM_CONDUCT            ,
	MPM_CONDUCT_TEMP       ,
	MPM_OIL_RATE_RAW       ,
	MPM_GAS_RATE_RAW       ,
	MPM_WATER_RATE_RAW     ,
	MPM_OIL_MASS_RATE_RAW  ,
	MPM_GAS_MASS_RATE_RAW  ,
	MPM_WATER_MASS_RATE_RAW,
	MPM_OIL_DENSITY_RAW    ,
	MPM_GAS_DENSITY_RAW    ,
	MPM_WATER_DENSITY_RAW  ,
	MPM_MIX_DENSITY_RAW    ,
	PUMP_SPEED             ,
	PUMP_POWER             ,
	PUMP_STROKE            ,
	PUMP_TIMER             ,
	DRIVE_CURRENT          ,
	DRIVE_VOLTAGE          ,
	LIQUID_LEVEL           ,
	DRIVE_FREQUENCY        ,
	DILUENT_RATE           ,
	GL_CHOKE_SIZE          ,
	GL_PRESS               ,
	GL_TEMP                ,
	GL_RATE                ,
	GL_DENSITY             ,
	GL_DIFF_PRESS          ,
	EST_GL_RATE            ,
	EST_DILUENT_RATE       ,
	DECLINE_RATE_OIL       ,
	PUMP_RUNTIME           ,
	OIL_SHRINKAGE          ,
	SOLUTION_GAS_FACTOR    ,
	GAS_SP_GRAV            ,
	CHLORIDE               ,
	EMULSION               ,
	FORMATION_GLR          ,
	GOR                    ,
	CGR                    ,
	GLR                    ,
	WATERCUT_PCT           ,
	SAND_CONTENT           ,
	GAS_OUT_RATE           ,
	OIL_OUT_RATE           ,
	TDEV_PRESS             ,
	TDEV_TEMP              ,
	GAS_RATE               ,
	EST_NET_OIL_RATE       ,
	EST_GAS_RATE           ,
	EST_NET_COND_RATE      ,
	EST_WATER_RATE         ,
	NET_OIL_MASS_RATE_ADJ  ,
	GAS_MASS_RATE_ADJ      ,
	NET_COND_MASS_RATE_ADJ ,
	TOT_WATER_MASS_RATE_ADJ,
	WET_DRY_GAS_RATIO      ,
	WGR                    ,
	TREND_ANALYSIS_IND     ,
	TREND_RESET_IND        ,
	POWERWATER_RATE        ,
	EST_POWERWATER_RATE    ,
	COMMENTS               ,
	VALUE_1                ,
	VALUE_2                ,
	VALUE_3                ,
	VALUE_4                ,
	VALUE_5                ,
	VALUE_6                ,
	VALUE_7                ,
	VALUE_8                ,
	VALUE_9                ,
	VALUE_10               ,
	VALUE_11               ,
	VALUE_12               ,
	VALUE_13               ,
	VALUE_14               ,
	VALUE_15               ,
	VALUE_16               ,
	VALUE_17               ,
	VALUE_18               ,
	VALUE_19               ,
	VALUE_20               ,
	VALUE_21               ,
	VALUE_22               ,
	VALUE_23               ,
	VALUE_24               ,
	VALUE_25               ,
	VALUE_26               ,
	VALUE_27               ,
	VALUE_28               ,
	VALUE_29               ,
	VALUE_30               ,
	TEXT_1                 ,
	TEXT_2                 ,
	TEXT_3                 ,
	TEXT_4                 ,
	TEXT_5                 ,
	TEXT_6                 ,
	TEXT_7                 ,
	TEXT_8                 ,
	TEXT_9                 ,
	TEXT_10                ,
	TEXT_11                ,
	TEXT_12                ,
	TEXT_13                ,
	TEXT_14                ,
	TEXT_15
  ) VALUES (
    	:New.OBJECT_ID              ,
    	ln_result_no		    ,
    	lv2_data_class_name	    ,
    	:New.RESULT_NO_COMB         ,
    	nvl(:NEW.PRIMARY_IND,'Y') 	,
    	nvl(:NEW.FLOWING_IND,'Y')   ,
    	:New.CHOKE_SIZE             ,
    	:New.WH_USC_PRESS           ,
    	:New.WH_USC_TEMP            ,
    	:New.WH_DSC_PRESS           ,
    	:New.WH_DSC_TEMP            ,
    	:New.WH_PRESS               ,
    	:New.WH_TEMP                ,
    	:New.BH_PRESS               ,
    	:New.BH_TEMP                ,
    	:New.ANNULUS_PRESS          ,
    	:New.ANNULUS_TEMP           ,
    	:New.SAND_RATE              ,
    	:New.EROSION_RATE           ,
    	:New.NET_OIL_RATE_ADJ       ,
    	:New.GAS_RATE_ADJ           ,
    	:New.NET_COND_RATE_ADJ      ,
    	:New.TOT_WATER_RATE_ADJ     ,
    	:New.NET_OIL_DENSITY_ADJ    ,
    	:New.GAS_DENSITY_ADJ        ,
    	:New.NET_COND_DENSITY_ADJ   ,
    	:New.TOT_WATER_DENSITY_ADJ  ,
    	:New.MPM_OIL_RATE_FLC       ,
    	:New.MPM_OIL_RATE           ,
    	:New.MPM_OIL_DENSITY        ,
    	:New.MPM_GAS_RATE_FLC       ,
    	:New.MPM_GAS_RATE           ,
    	:New.MPM_GAS_DENSITY        ,
    	:New.MPM_WATER_RATE_FLC     ,
    	:New.MPM_WATER_RATE         ,
    	:New.MPM_MIX_DENSITY        ,
    	:New.MPM_PRESS              ,
    	:New.MPM_TEMP               ,
    	:New.MPM_COND_RATE          ,
    	:New.MPM_OIL_MASS_RATE      ,
    	:New.MPM_GAS_MASS_RATE      ,
    	:New.MPM_COND_MASS_RATE     ,
    	:New.MPM_WATER_MASS_RATE    ,
    	:New.MPM_COND_DENSITY       ,
    	:New.MPM_WATER_DENSITY      ,
    	:New.MPM_COND_RATE_FLC      ,
    	:New.MPM_OIL_MASS_RATE_FLC  ,
    	:New.MPM_GAS_MASS_RATE_FLC  ,
    	:New.MPM_COND_MASS_RATE_FLC ,
    	:New.MPM_WATER_MASS_RATE_FLC,
    	:New.MPM_OIL_DENSITY_FLC    ,
    	:New.MPM_GAS_DENSITY_FLC    ,
    	:New.MPM_COND_DENSITY_FLC   ,
    	:New.MPM_WATER_DENSITY_FLC  ,
    	:New.MPM_MIX_DENSITY_FLC    ,
    	:New.MPM_CONDUCT            ,
    	:New.MPM_CONDUCT_TEMP       ,
    	:New.MPM_OIL_RATE_RAW       ,
    	:New.MPM_GAS_RATE_RAW       ,
    	:New.MPM_WATER_RATE_RAW     ,
    	:New.MPM_OIL_MASS_RATE_RAW  ,
    	:New.MPM_GAS_MASS_RATE_RAW  ,
    	:New.MPM_WATER_MASS_RATE_RAW,
    	:New.MPM_OIL_DENSITY_RAW    ,
    	:New.MPM_GAS_DENSITY_RAW    ,
    	:New.MPM_WATER_DENSITY_RAW  ,
    	:New.MPM_MIX_DENSITY_RAW    ,
    	:New.PUMP_SPEED             ,
    	:New.PUMP_POWER             ,
    	:New.PUMP_STROKE            ,
    	:New.PUMP_TIMER             ,
    	:New.DRIVE_CURRENT          ,
    	:New.DRIVE_VOLTAGE          ,
    	:New.LIQUID_LEVEL           ,
    	:New.DRIVE_FREQUENCY        ,
    	:New.DILUENT_RATE           ,
    	:New.GL_CHOKE_SIZE          ,
    	:New.GL_PRESS               ,
    	:New.GL_TEMP                ,
    	:New.GL_RATE                ,
    	:New.GL_DENSITY             ,
    	:New.GL_DIFF_PRESS          ,
    	:New.EST_GL_RATE            ,
    	:New.EST_DILUENT_RATE       ,
    	:New.DECLINE_RATE_OIL       ,
    	:New.PUMP_RUNTIME           ,
    	:New.OIL_SHRINKAGE          ,
    	:New.SOLUTION_GAS_FACTOR    ,
    	:New.GAS_SP_GRAV            ,
    	:New.CHLORIDE               ,
    	:New.EMULSION               ,
    	:New.FORMATION_GLR          ,
    	:New.GOR                    ,
    	:New.CGR                    ,
    	:New.GLR                    ,
    	:New.WATERCUT_PCT           ,
    	:New.SAND_CONTENT           ,
    	:New.GAS_OUT_RATE           ,
    	:New.OIL_OUT_RATE           ,
    	:New.TDEV_PRESS             ,
    	:New.TDEV_TEMP              ,
    	:New.GAS_RATE               ,
    	:New.EST_NET_OIL_RATE       ,
    	:New.EST_GAS_RATE           ,
    	:New.EST_NET_COND_RATE      ,
    	:New.EST_WATER_RATE         ,
    	:New.NET_OIL_MASS_RATE_ADJ  ,
    	:New.GAS_MASS_RATE_ADJ      ,
    	:New.NET_COND_MASS_RATE_ADJ ,
    	:New.TOT_WATER_MASS_RATE_ADJ,
    	:New.WET_DRY_GAS_RATIO      ,
    	:New.WGR                    ,
    	:New.TREND_ANALYSIS_IND     ,
    	:New.TREND_RESET_IND        ,
    	:New.POWERWATER_RATE        ,
    	:New.EST_POWERWATER_RATE    ,
    	:New.PWEL_RESULT_COMMENTS   ,
    	:New.PWEL_RESULT_VALUE_1    ,
    	:New.PWEL_RESULT_VALUE_2    ,
    	:New.PWEL_RESULT_VALUE_3    ,
    	:New.PWEL_RESULT_VALUE_4    ,
    	:New.PWEL_RESULT_VALUE_5    ,
    	:New.PWEL_RESULT_VALUE_6    ,
    	:New.PWEL_RESULT_VALUE_7    ,
    	:New.PWEL_RESULT_VALUE_8    ,
    	:New.PWEL_RESULT_VALUE_9    ,
    	:New.PWEL_RESULT_VALUE_10   ,
    	:New.PWEL_RESULT_VALUE_11   ,
    	:New.PWEL_RESULT_VALUE_12   ,
    	:New.PWEL_RESULT_VALUE_13   ,
    	:New.PWEL_RESULT_VALUE_14   ,
    	:New.PWEL_RESULT_VALUE_15   ,
    	:New.PWEL_RESULT_VALUE_16   ,
    	:New.PWEL_RESULT_VALUE_17   ,
    	:New.PWEL_RESULT_VALUE_18   ,
    	:New.PWEL_RESULT_VALUE_19   ,
    	:New.PWEL_RESULT_VALUE_20   ,
    	:New.PWEL_RESULT_VALUE_21   ,
    	:New.PWEL_RESULT_VALUE_22   ,
    	:New.PWEL_RESULT_VALUE_23   ,
    	:New.PWEL_RESULT_VALUE_24   ,
    	:New.PWEL_RESULT_VALUE_25   ,
    	:New.PWEL_RESULT_VALUE_26   ,
    	:New.PWEL_RESULT_VALUE_27   ,
    	:New.PWEL_RESULT_VALUE_28   ,
    	:New.PWEL_RESULT_VALUE_29   ,
    	:New.PWEL_RESULT_VALUE_30   ,
    	:New.PWEL_RESULT_TEXT_1     ,
    	:New.PWEL_RESULT_TEXT_2     ,
    	:New.PWEL_RESULT_TEXT_3     ,
    	:New.PWEL_RESULT_TEXT_4     ,
    	:New.PWEL_RESULT_TEXT_5     ,
    	:New.PWEL_RESULT_TEXT_6     ,
    	:New.PWEL_RESULT_TEXT_7     ,
    	:New.PWEL_RESULT_TEXT_8     ,
    	:New.PWEL_RESULT_TEXT_9     ,
    	:New.PWEL_RESULT_TEXT_10    ,
    	:New.PWEL_RESULT_TEXT_11    ,
    	:New.PWEL_RESULT_TEXT_12    ,
    	:New.PWEL_RESULT_TEXT_13    ,
    	:New.PWEL_RESULT_TEXT_14    ,
    	:New.PWEL_RESULT_TEXT_15
  );

EcDp_Performance_Test.aiSyncPwelResultFromPwel (ln_result_no, :New.OBJECT_ID, :New.CREATED_BY);

END IF;

-- UPDATE BLOCK
IF UPDATING THEN

  -- Get the instrumentation type and determine which data class should the row be insert into
  lv2_instr_type :=  ec_well_version.instrumentation_type(:New.OBJECT_ID, :New.DAYTIME, '<=');

  IF lv2_instr_type = '1' THEN
      lv2_data_class_name := 'PWEL_RESULT_1';
  ELSIF lv2_instr_type = '2' THEN
      lv2_data_class_name := 'PWEL_RESULT_2';
  ELSIF lv2_instr_type = '3' THEN
      lv2_data_class_name := 'PWEL_RESULT_3';
  ELSE
      lv2_data_class_name := 'PWEL_RESULT_1';
  END IF;

  lv2_device_data_class_name := 'PROD_TEST_RESULT';

  -- Get the production day for the well.
  ld_production_day := EcDp_ProductionDay.getProductionDay('WELL',:New.OBJECT_ID, :New.DAYTIME);

   -- Update ptst_result
   UPDATE ptst_result SET
   	DAYTIME         = :New.DAYTIME              ,
   	PRODUCTION_DAY  = ld_production_day         ,
    CLASS_NAME  	= lv2_device_data_class_name,
	END_DATE        = :New.END_DATE             ,
	DURATION        = :New.DURATION             ,
	USE_CALC        = :New.USE_CALC             ,
	TEST_TYPE       = :New.TEST_TYPE            ,
	ESTIMATE_TYPE   = :New.ESTIMATE_TYPE        ,
	TEST_NO         = :New.TEST_NO              ,
	SUMMARISED_IND  = :New.SUMMARISED_IND       ,
	VALID_FROM_DATE = :New.VALID_FROM_DATE      ,
	STATUS          = :New.STATUS               ,
	PREPROCESS_LOG  = :New.PREPROCESS_LOG       ,
	COMMENTS        = :New.PTST_RESULT_COMMENTS 	    ,
	VALUE_1         = :New.PTST_RESULT_VALUE_1  	    ,
	VALUE_2         = :New.PTST_RESULT_VALUE_2  	    ,
	VALUE_3         = :New.PTST_RESULT_VALUE_3  	    ,
	VALUE_4         = :New.PTST_RESULT_VALUE_4  	    ,
	VALUE_5         = :New.PTST_RESULT_VALUE_5  	    ,
	VALUE_6         = :New.PTST_RESULT_VALUE_6  	    ,
	VALUE_7         = :New.PTST_RESULT_VALUE_7  	    ,
	VALUE_8         = :New.PTST_RESULT_VALUE_8  	    ,
	VALUE_9         = :New.PTST_RESULT_VALUE_9  	    ,
	VALUE_10        = :New.PTST_RESULT_VALUE_10 	    ,
	TEXT_1          = :New.PTST_RESULT_TEXT_1   	    ,
	TEXT_2          = :New.PTST_RESULT_TEXT_2   	    ,
	TEXT_3          = :New.PTST_RESULT_TEXT_3   	    ,
	TEXT_4          = :New.PTST_RESULT_TEXT_4   	    ,
    REV_NO          = :New.REV_NO						,
	LAST_UPDATED_BY = :New.LAST_UPDATED_BY
   WHERE
   	result_no = :Old.result_no;

   -- Update pwel_result
   UPDATE pwel_result SET
	DATA_CLASS_NAME         = lv2_data_class_name          ,
	PRIMARY_IND             = :New.PRIMARY_IND             ,
	FLOWING_IND             = :New.FLOWING_IND             ,
	CHOKE_SIZE              = :New.CHOKE_SIZE              ,
	WH_USC_PRESS            = :New.WH_USC_PRESS            ,
	WH_USC_TEMP             = :New.WH_USC_TEMP             ,
	WH_DSC_PRESS            = :New.WH_DSC_PRESS            ,
	WH_DSC_TEMP             = :New.WH_DSC_TEMP             ,
	WH_PRESS                = :New.WH_PRESS                ,
	WH_TEMP                 = :New.WH_TEMP                 ,
	BH_PRESS                = :New.BH_PRESS                ,
	BH_TEMP                 = :New.BH_TEMP                 ,
	ANNULUS_PRESS           = :New.ANNULUS_PRESS           ,
	ANNULUS_TEMP            = :New.ANNULUS_TEMP            ,
	SAND_RATE               = :New.SAND_RATE               ,
	EROSION_RATE            = :New.EROSION_RATE            ,
	NET_OIL_RATE_ADJ        = :New.NET_OIL_RATE_ADJ        ,
	GAS_RATE_ADJ            = :New.GAS_RATE_ADJ            ,
	NET_COND_RATE_ADJ       = :New.NET_COND_RATE_ADJ       ,
	TOT_WATER_RATE_ADJ      = :New.TOT_WATER_RATE_ADJ      ,
	NET_OIL_DENSITY_ADJ     = :New.NET_OIL_DENSITY_ADJ     ,
	GAS_DENSITY_ADJ         = :New.GAS_DENSITY_ADJ         ,
	NET_COND_DENSITY_ADJ    = :New.NET_COND_DENSITY_ADJ    ,
	TOT_WATER_DENSITY_ADJ   = :New.TOT_WATER_DENSITY_ADJ   ,
	MPM_OIL_RATE_FLC        = :New.MPM_OIL_RATE_FLC        ,
	MPM_OIL_RATE            = :New.MPM_OIL_RATE            ,
	MPM_OIL_DENSITY         = :New.MPM_OIL_DENSITY         ,
	MPM_GAS_RATE_FLC        = :New.MPM_GAS_RATE_FLC        ,
	MPM_GAS_RATE            = :New.MPM_GAS_RATE            ,
	MPM_GAS_DENSITY         = :New.MPM_GAS_DENSITY         ,
	MPM_WATER_RATE_FLC      = :New.MPM_WATER_RATE_FLC      ,
	MPM_WATER_RATE          = :New.MPM_WATER_RATE          ,
	MPM_MIX_DENSITY         = :New.MPM_MIX_DENSITY         ,
	MPM_PRESS               = :New.MPM_PRESS               ,
	MPM_TEMP                = :New.MPM_TEMP                ,
	MPM_COND_RATE           = :New.MPM_COND_RATE           ,
	MPM_OIL_MASS_RATE       = :New.MPM_OIL_MASS_RATE       ,
	MPM_GAS_MASS_RATE       = :New.MPM_GAS_MASS_RATE       ,
	MPM_COND_MASS_RATE      = :New.MPM_COND_MASS_RATE      ,
	MPM_WATER_MASS_RATE     = :New.MPM_WATER_MASS_RATE     ,
	MPM_COND_DENSITY        = :New.MPM_COND_DENSITY        ,
	MPM_WATER_DENSITY       = :New.MPM_WATER_DENSITY       ,
	MPM_COND_RATE_FLC       = :New.MPM_COND_RATE_FLC       ,
	MPM_OIL_MASS_RATE_FLC   = :New.MPM_OIL_MASS_RATE_FLC   ,
	MPM_GAS_MASS_RATE_FLC   = :New.MPM_GAS_MASS_RATE_FLC   ,
	MPM_COND_MASS_RATE_FLC  = :New.MPM_COND_MASS_RATE_FLC  ,
	MPM_WATER_MASS_RATE_FLC = :New.MPM_WATER_MASS_RATE_FLC ,
	MPM_OIL_DENSITY_FLC     = :New.MPM_OIL_DENSITY_FLC     ,
	MPM_GAS_DENSITY_FLC     = :New.MPM_GAS_DENSITY_FLC     ,
	MPM_COND_DENSITY_FLC    = :New.MPM_COND_DENSITY_FLC    ,
	MPM_WATER_DENSITY_FLC   = :New.MPM_WATER_DENSITY_FLC   ,
	MPM_MIX_DENSITY_FLC     = :New.MPM_MIX_DENSITY_FLC     ,
	MPM_CONDUCT             = :New.MPM_CONDUCT             ,
	MPM_CONDUCT_TEMP        = :New.MPM_CONDUCT_TEMP        ,
	MPM_OIL_RATE_RAW        = :New.MPM_OIL_RATE_RAW        ,
	MPM_GAS_RATE_RAW        = :New.MPM_GAS_RATE_RAW        ,
	MPM_WATER_RATE_RAW      = :New.MPM_WATER_RATE_RAW      ,
	MPM_OIL_MASS_RATE_RAW   = :New.MPM_OIL_MASS_RATE_RAW   ,
	MPM_GAS_MASS_RATE_RAW   = :New.MPM_GAS_MASS_RATE_RAW   ,
	MPM_WATER_MASS_RATE_RAW = :New.MPM_WATER_MASS_RATE_RAW ,
	MPM_OIL_DENSITY_RAW     = :New.MPM_OIL_DENSITY_RAW     ,
	MPM_GAS_DENSITY_RAW     = :New.MPM_GAS_DENSITY_RAW     ,
	MPM_WATER_DENSITY_RAW   = :New.MPM_WATER_DENSITY_RAW   ,
	MPM_MIX_DENSITY_RAW     = :New.MPM_MIX_DENSITY_RAW     ,
	PUMP_SPEED              = :New.PUMP_SPEED              ,
	PUMP_POWER              = :New.PUMP_POWER              ,
	PUMP_STROKE             = :New.PUMP_STROKE             ,
	PUMP_TIMER              = :New.PUMP_TIMER              ,
	DRIVE_CURRENT           = :New.DRIVE_CURRENT           ,
	DRIVE_VOLTAGE           = :New.DRIVE_VOLTAGE           ,
	LIQUID_LEVEL            = :New.LIQUID_LEVEL            ,
	DRIVE_FREQUENCY         = :New.DRIVE_FREQUENCY         ,
	DILUENT_RATE            = :New.DILUENT_RATE            ,
	GL_CHOKE_SIZE           = :New.GL_CHOKE_SIZE           ,
	GL_PRESS                = :New.GL_PRESS                ,
	GL_TEMP                 = :New.GL_TEMP                 ,
	GL_RATE                 = :New.GL_RATE                 ,
	GL_DENSITY              = :New.GL_DENSITY              ,
	GL_DIFF_PRESS           = :New.GL_DIFF_PRESS           ,
	EST_GL_RATE             = :New.EST_GL_RATE             ,
	EST_DILUENT_RATE        = :New.EST_DILUENT_RATE        ,
	DECLINE_RATE_OIL        = :New.DECLINE_RATE_OIL        ,
	PUMP_RUNTIME            = :New.PUMP_RUNTIME            ,
	OIL_SHRINKAGE           = :New.OIL_SHRINKAGE           ,
	SOLUTION_GAS_FACTOR     = :New.SOLUTION_GAS_FACTOR     ,
	GAS_SP_GRAV             = :New.GAS_SP_GRAV             ,
	CHLORIDE                = :New.CHLORIDE                ,
	EMULSION                = :New.EMULSION                ,
	FORMATION_GLR           = :New.FORMATION_GLR           ,
	GOR                     = :New.GOR                     ,
	CGR                     = :New.CGR                     ,
	GLR                     = :New.GLR                     ,
	WATERCUT_PCT            = :New.WATERCUT_PCT            ,
	SAND_CONTENT            = :New.SAND_CONTENT            ,
	GAS_OUT_RATE            = :New.GAS_OUT_RATE            ,
	OIL_OUT_RATE            = :New.OIL_OUT_RATE            ,
	TDEV_PRESS              = :New.TDEV_PRESS              ,
	TDEV_TEMP               = :New.TDEV_TEMP               ,
	GAS_RATE                = :New.GAS_RATE                ,
	EST_NET_OIL_RATE        = :New.EST_NET_OIL_RATE        ,
	EST_GAS_RATE            = :New.EST_GAS_RATE            ,
	EST_NET_COND_RATE       = :New.EST_NET_COND_RATE       ,
	EST_WATER_RATE          = :New.EST_WATER_RATE          ,
	NET_OIL_MASS_RATE_ADJ   = :New.NET_OIL_MASS_RATE_ADJ   ,
	GAS_MASS_RATE_ADJ       = :New.GAS_MASS_RATE_ADJ       ,
	NET_COND_MASS_RATE_ADJ  = :New.NET_COND_MASS_RATE_ADJ  ,
	TOT_WATER_MASS_RATE_ADJ = :New.TOT_WATER_MASS_RATE_ADJ ,
	WET_DRY_GAS_RATIO       = :New.WET_DRY_GAS_RATIO       ,
	WGR                     = :New.WGR                     ,
	TREND_ANALYSIS_IND      = :New.TREND_ANALYSIS_IND      ,
	TREND_RESET_IND         = :New.TREND_RESET_IND         ,
	POWERWATER_RATE         = :New.POWERWATER_RATE         ,
	EST_POWERWATER_RATE     = :New.EST_POWERWATER_RATE     ,
	COMMENTS                = :New.PWEL_RESULT_COMMENTS    ,
	VALUE_1                 = :New.PWEL_RESULT_VALUE_1     ,
	VALUE_2                 = :New.PWEL_RESULT_VALUE_2     ,
	VALUE_3                 = :New.PWEL_RESULT_VALUE_3     ,
	VALUE_4                 = :New.PWEL_RESULT_VALUE_4     ,
	VALUE_5                 = :New.PWEL_RESULT_VALUE_5     ,
	VALUE_6                 = :New.PWEL_RESULT_VALUE_6     ,
	VALUE_7                 = :New.PWEL_RESULT_VALUE_7     ,
	VALUE_8                 = :New.PWEL_RESULT_VALUE_8     ,
	VALUE_9                 = :New.PWEL_RESULT_VALUE_9     ,
	VALUE_10                = :New.PWEL_RESULT_VALUE_10    ,
	VALUE_11                = :New.PWEL_RESULT_VALUE_11    ,
	VALUE_12                = :New.PWEL_RESULT_VALUE_12    ,
	VALUE_13                = :New.PWEL_RESULT_VALUE_13    ,
	VALUE_14                = :New.PWEL_RESULT_VALUE_14    ,
	VALUE_15                = :New.PWEL_RESULT_VALUE_15    ,
	VALUE_16                = :New.PWEL_RESULT_VALUE_16    ,
	VALUE_17                = :New.PWEL_RESULT_VALUE_17    ,
	VALUE_18                = :New.PWEL_RESULT_VALUE_18    ,
	VALUE_19                = :New.PWEL_RESULT_VALUE_19    ,
	VALUE_20                = :New.PWEL_RESULT_VALUE_20    ,
	VALUE_21                = :New.PWEL_RESULT_VALUE_21    ,
	VALUE_22                = :New.PWEL_RESULT_VALUE_22    ,
	VALUE_23                = :New.PWEL_RESULT_VALUE_23    ,
	VALUE_24                = :New.PWEL_RESULT_VALUE_24    ,
	VALUE_25                = :New.PWEL_RESULT_VALUE_25    ,
	VALUE_26                = :New.PWEL_RESULT_VALUE_26    ,
	VALUE_27                = :New.PWEL_RESULT_VALUE_27    ,
	VALUE_28                = :New.PWEL_RESULT_VALUE_28    ,
	VALUE_29                = :New.PWEL_RESULT_VALUE_29    ,
	VALUE_30                = :New.PWEL_RESULT_VALUE_30    ,
	TEXT_1                  = :New.PWEL_RESULT_TEXT_1      ,
	TEXT_2                  = :New.PWEL_RESULT_TEXT_2      ,
	TEXT_3                  = :New.PWEL_RESULT_TEXT_3      ,
	TEXT_4                  = :New.PWEL_RESULT_TEXT_4      ,
	TEXT_5                  = :New.PWEL_RESULT_TEXT_5      ,
	TEXT_6                  = :New.PWEL_RESULT_TEXT_6      ,
	TEXT_7                  = :New.PWEL_RESULT_TEXT_7      ,
	TEXT_8                  = :New.PWEL_RESULT_TEXT_8      ,
	TEXT_9                  = :New.PWEL_RESULT_TEXT_9      ,
	TEXT_10                 = :New.PWEL_RESULT_TEXT_10     ,
	TEXT_11                 = :New.PWEL_RESULT_TEXT_11     ,
	TEXT_12                 = :New.PWEL_RESULT_TEXT_12     ,
	TEXT_13                 = :New.PWEL_RESULT_TEXT_13     ,
	TEXT_14                 = :New.PWEL_RESULT_TEXT_14     ,
	TEXT_15                 = :New.PWEL_RESULT_TEXT_15     ,
  REV_NO                  = :New.REV_NO
   WHERE
   	result_no = :Old.result_no
   AND
   	object_id = :Old.object_id;

EcDp_Performance_Test.aiSyncPwelResultFromPwel (:Old.result_no, :Old.object_id, :New.last_updated_by);

END IF;

-- DELETE BLOCK
IF DELETING THEN
  SELECT COUNT(1)
  INTO ln_no_pwel_result_rec
  FROM pwel_result
  WHERE result_no = :Old.result_no;

  DELETE FROM pwel_result
  WHERE result_no = :Old.result_no
  AND object_id = :Old.object_id;

  -- we can have more well tests in 1 test result. i.e. only delete the test result if there no well test left.
  IF ln_no_pwel_result_rec = 1 then
  -- Delete row
    DELETE FROM ptst_result WHERE result_no = :Old.result_no;
  END IF;
END IF;
END;

