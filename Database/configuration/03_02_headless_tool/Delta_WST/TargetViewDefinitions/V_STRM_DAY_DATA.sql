CREATE OR REPLACE FORCE VIEW "V_STRM_DAY_DATA" ("OBJECT_ID", "OBJECT_CODE", "DAYTIME", "ON_STREAM_HRS", "GRS_MASS", "GRS_VOL", "GRS_VOL_M3", "NET_MASS", "NET_VOL", "NET_VOL_M3", "WATER_MASS", "WATER_VOL", "WATER_VOL_M3", "AVG_TEMP", "AVG_PRESS", "MIN_PRESS", "AVG_PL_PRESS", "DENSITY", "DENSITY_KGM3", "AVG_DIFF_PRESS", "RUN_SIZE", "ENERGY", "ENERGY_2", "ENERGY_CONTENT", "BS_W", "BS_W_WT", "WATER_WT", "H2S", "H2S_2", "CO2", "SALT", "SALT_MASS", "RVP", "TVP", "WDP", "GCV", "TOTALIZER", "SP_GRAV", "BOTTOM_STRIP_TEMP", "K_FACTOR", "ORIFICE_SIZE", "AVG_RATE_HR", "STEAM_QUALITY", "POWER_CONSUMPTION", "EGM_IND", "TOTALIZER_RESET_IND", "METER_PROVED_IND", "COMMENTS", "SALT_WT", "THEOR_GRS_MASS", "VALUE_1", "VALUE_2", "VALUE_3", "VALUE_4", "VALUE_5", "VALUE_6", "VALUE_7", "VALUE_8", "VALUE_9", "VALUE_10", "TEXT_1", "TEXT_2", "TEXT_3", "TEXT_4", "RECORD_STATUS", "CREATED_BY", "CREATED_DATE", "LAST_UPDATED_BY", "LAST_UPDATED_DATE", "REV_NO", "REV_TEXT", "APPROVAL_BY", "APPROVAL_DATE", "APPROVAL_STATE", "REC_ID") AS 
  (
 SELECT s.OBJECT_ID AS OBJECT_ID,
        s.OBJECT_CODE OBJECT_CODE,
        sd.DAYTIME AS DAYTIME,
        NULL AS ON_STREAM_HRS,
        NULL AS GRS_MASS,
        NULL AS GRS_VOL,
        NULL AS GRS_VOL_M3,
        NULL AS NET_MASS,
        NULL AS NET_VOL,
        NULL AS NET_VOL_M3,
        NULL AS WATER_MASS,
        NULL AS WATER_VOL,
        NULL AS WATER_VOL_M3,
        NULL AS AVG_TEMP,
        NULL AS AVG_PRESS,
        NULL AS MIN_PRESS,
        NULL AS AVG_PL_PRESS,
        NULL AS DENSITY,
        NULL AS DENSITY_KGM3,
        NULL AS AVG_DIFF_PRESS,
        NULL AS RUN_SIZE,
        NULL AS ENERGY,
        NULL AS ENERGY_2,
        NULL AS ENERGY_CONTENT,
        NULL AS BS_W,
        NULL AS BS_W_WT,
        NULL AS WATER_WT,
        NULL AS H2S,
        NULL AS H2S_2,
        NULL AS CO2,
        NULL AS SALT,
        NULL AS SALT_MASS,
        NULL AS RVP,
        NULL AS TVP,
        NULL AS WDP,
        NULL AS GCV,
        NULL AS TOTALIZER,
        NULL AS SP_GRAV,
        NULL AS BOTTOM_STRIP_TEMP,
        NULL AS K_FACTOR,
        NULL AS ORIFICE_SIZE,
        NULL AS AVG_RATE_HR,
        NULL AS STEAM_QUALITY,
        NULL AS POWER_CONSUMPTION,
        NULL AS EGM_IND,
        NULL AS TOTALIZER_RESET_IND,
        NULL AS METER_PROVED_IND,
        NULL AS COMMENTS,
        NULL AS SALT_WT,
        NULL AS THEOR_GRS_MASS,
        NULL AS VALUE_1,
        NULL AS VALUE_2,
        NULL AS VALUE_3,
        NULL AS VALUE_4,
        NULL AS VALUE_5,
        NULL AS VALUE_6,
        NULL AS VALUE_7,
        NULL AS VALUE_8,
        NULL AS VALUE_9,
        NULL AS VALUE_10,
        NULL AS TEXT_1,
        NULL AS TEXT_2,
        NULL AS TEXT_3,
        NULL AS TEXT_4,
        NULL AS RECORD_STATUS,
        NULL AS CREATED_BY,
        NULL AS CREATED_DATE,
        NULL AS LAST_UPDATED_BY,
        NULL AS LAST_UPDATED_DATE,
        NULL AS REV_NO,
        NULL AS REV_TEXT,
        NULL AS APPROVAL_BY,
        NULL AS APPROVAL_DATE,
        NULL AS APPROVAL_STATE,
        NULL AS REC_ID
  FROM stream s, strm_version sv, system_days sd
  WHERE s.object_id = sv.object_id
   AND sd.daytime >= s.start_date
   AND (s.end_date IS NULL OR sd.daytime < s.end_date)
   AND sd.daytime >= sv.daytime
   AND (sv.end_date IS NULL OR sd.daytime < sv.end_date)
   AND (sv.alloc_data_freq = 'DAY' OR sv.alloc_data_freq IS NULL)
   AND NOT (sv.stream_type in ('M','C') and nvl(sv.strm_meter_freq,'NA') = 'DAY')
   UNION ALL
   SELECT STRM_DAY_STREAM.OBJECT_ID AS OBJECT_ID,
          o.OBJECT_CODE OBJECT_CODE,
          STRM_DAY_STREAM.DAYTIME AS DAYTIME,
          STRM_DAY_STREAM.ON_STREAM_HRS,
          STRM_DAY_STREAM.GRS_MASS,
          STRM_DAY_STREAM.GRS_VOL,
          STRM_DAY_STREAM.GRS_VOL_M3,
          STRM_DAY_STREAM.NET_MASS,
          STRM_DAY_STREAM.NET_VOL,
          STRM_DAY_STREAM.NET_VOL_M3,
          STRM_DAY_STREAM.WATER_MASS,
          STRM_DAY_STREAM.WATER_VOL,
          STRM_DAY_STREAM.WATER_VOL_M3,
          STRM_DAY_STREAM.AVG_TEMP,
          STRM_DAY_STREAM.AVG_PRESS,
          STRM_DAY_STREAM.MIN_PRESS,
          STRM_DAY_STREAM.AVG_PL_PRESS,
          STRM_DAY_STREAM.DENSITY,
          STRM_DAY_STREAM.DENSITY_KGM3,
          STRM_DAY_STREAM.AVG_DIFF_PRESS,
          STRM_DAY_STREAM.RUN_SIZE,
          STRM_DAY_STREAM.ENERGY,
          STRM_DAY_STREAM.ENERGY_2,
          STRM_DAY_STREAM.ENERGY_CONTENT,
          STRM_DAY_STREAM.BS_W,
          STRM_DAY_STREAM.BS_W_WT,
          STRM_DAY_STREAM.WATER_WT,
          STRM_DAY_STREAM.H2S,
          STRM_DAY_STREAM.H2S_2,
          STRM_DAY_STREAM.CO2,
          STRM_DAY_STREAM.SALT,
          STRM_DAY_STREAM.SALT_MASS,
          STRM_DAY_STREAM.RVP,
          STRM_DAY_STREAM.TVP,
          STRM_DAY_STREAM.WDP,
          STRM_DAY_STREAM.GCV,
          STRM_DAY_STREAM.TOTALIZER,
          STRM_DAY_STREAM.SP_GRAV,
          STRM_DAY_STREAM.BOTTOM_STRIP_TEMP,
          STRM_DAY_STREAM.K_FACTOR,
          STRM_DAY_STREAM.ORIFICE_SIZE,
          STRM_DAY_STREAM.AVG_RATE_HR,
          STRM_DAY_STREAM.STEAM_QUALITY,
          STRM_DAY_STREAM.POWER_CONSUMPTION,
          STRM_DAY_STREAM.EGM_IND,
          STRM_DAY_STREAM.TOTALIZER_RESET_IND,
          STRM_DAY_STREAM.METER_PROVED_IND,
          STRM_DAY_STREAM.COMMENTS,
          STRM_DAY_STREAM.SALT_WT,
          STRM_DAY_STREAM.THEOR_GRS_MASS,
          STRM_DAY_STREAM.VALUE_1,
          STRM_DAY_STREAM.VALUE_2,
          STRM_DAY_STREAM.VALUE_3,
          STRM_DAY_STREAM.VALUE_4,
          STRM_DAY_STREAM.VALUE_5,
          STRM_DAY_STREAM.VALUE_6,
          STRM_DAY_STREAM.VALUE_7,
          STRM_DAY_STREAM.VALUE_8,
          STRM_DAY_STREAM.VALUE_9,
          STRM_DAY_STREAM.VALUE_10,
          STRM_DAY_STREAM.TEXT_1,
          STRM_DAY_STREAM.TEXT_2,
          STRM_DAY_STREAM.TEXT_3,
          STRM_DAY_STREAM.TEXT_4,
          STRM_DAY_STREAM.RECORD_STATUS,
          STRM_DAY_STREAM.CREATED_BY,
          STRM_DAY_STREAM.CREATED_DATE,
          STRM_DAY_STREAM.LAST_UPDATED_BY,
          STRM_DAY_STREAM.LAST_UPDATED_DATE,
          STRM_DAY_STREAM.REV_NO,
          STRM_DAY_STREAM.REV_TEXT,
          STRM_DAY_STREAM.APPROVAL_BY,
          STRM_DAY_STREAM.APPROVAL_DATE,
          STRM_DAY_STREAM.APPROVAL_STATE,
          STRM_DAY_STREAM.REC_ID
  FROM STRM_DAY_STREAM, STRM_VERSION oa, STREAM o
  WHERE STRM_DAY_STREAM.object_id = oa.object_id
    AND oa.object_id = o.object_id
    AND STRM_DAY_STREAM.daytime >= oa.daytime
    AND STRM_DAY_STREAM.daytime < nvl(oa.end_date,STRM_DAY_STREAM.daytime + 1)
    AND (Nvl(oa.alloc_data_freq,'NA') <> 'DAY'
    OR (oa.alloc_data_freq = 'DAY' and oa.stream_type = 'M' and oa.strm_meter_freq = 'DAY'))
)