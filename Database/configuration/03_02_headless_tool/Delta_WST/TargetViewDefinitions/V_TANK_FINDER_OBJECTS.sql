CREATE OR REPLACE FORCE VIEW "V_TANK_FINDER_OBJECTS" ("CLASS_NAME", "NAME", "CODE", "OBJECT_ID", "START_DATE", "DAYTIME", "OBJECT_END_DATE", "END_DATE", "OP_PU_ID", "OP_SUB_PU_ID", "OP_AREA_ID", "OP_SUB_AREA_ID", "OP_FCTY_CLASS_2_ID", "OP_FCTY_CLASS_1_ID", "CP_AREA_ID", "CP_COL_POINT_ID", "CP_OPERATOR_ROUTE_ID", "CP_PU_ID", "CP_SUB_AREA_ID", "CP_SUB_PU_ID", "DESCRIPTION", "COMMENTS", "RECORD_STATUS", "CREATED_BY", "CREATED_DATE", "LAST_UPDATED_BY", "LAST_UPDATED_DATE", "REV_NO", "REV_TEXT", "BF_USAGE", "BITUMEN_DENS_METHOD", "BS_W_VOL_METHOD", "BS_W_WT_METHOD", "CORR_DENSITY_METHOD", "CORR_GRAVITY_METHOD", "CP_AREA_CODE", "CP_COL_POINT_CODE", "CP_OPERATOR_ROUTE_CODE", "CP_PU_CODE", "CP_SUB_AREA_CODE", "CP_SUB_PU_CODE", "DATE_1", "DATE_2", "DATE_3", "DATE_4", "DATE_5", "DENSITY_METHOD", "DILUENT_DENS_METHOD", "DILUENT_METHOD", "EXCLUDE_TANK_WELL", "FREE_WAT_VOL_MET", "GROUP_REF_CODE_1", "GROUP_REF_CODE_2", "GROUP_REF_CODE_3", "GROUP_REF_CODE_4", "GROUP_REF_CODE_5", "GROUP_REF_CODE_6", "GROUP_REF_CODE_7", "GROUP_REF_CODE_8", "GROUP_REF_CODE_9", "GROUP_REF_CODE_10", "GRS_MASS_METHOD", "GRS_VOL_METHOD", "NET_MASS_METHOD", "NET_VOL_METHOD", "OBS_DENS_METHOD", "LOCATION", "OP_AREA_CODE", "OP_FCTY_CLASS_1_CODE", "OP_FCTY_CLASS_2_CODE", "OP_PU_CODE", "OP_SUB_AREA_CODE", "OP_SUB_PU_CODE", "ROOF_DISP_METHOD", "STRAP_LEVEL_UOM", "STRAP_VALUE_TYPE", "STRAPPING_METHOD", "PORTABLE_TANK", "TANK_CLOSING_UNIT", "TANK_METER_FREQ", "TANK_TYPE", "TANK_WELL", "TEXT_1", "TEXT_2", "TEXT_3", "TEXT_4", "TEXT_5", "TEXT_6", "TEXT_7", "TEXT_8", "TEXT_9", "TEXT_10", "VCF_METHOD", "WATER_VOL_METHOD", "UNIT") AS 
  (
------------------------------------------------------------------------------------
--  v_tank_finder_objects
--
-- $Revision: 1.1.2.4 $
--
--  Purpose:   Get all data from tank and chem_tank for tank finder screen.
--             Used in tank finder screen
--  Note:
--
--  When           Who           Why
--  -------------- ------------ --------
--  28-MAR-2013   Lim Chun Guan  Used in tank finder screen
--  18-DEC-2013   wonggkai       ECPD-26413: Added attributes from TANK_VERSION and CHEM_TANK_VERSION
--  07-JAN-2014   wonggkai       ECPD-26413: Modified added Codes' Text to Codes' Description
--  15-JAN-2014   wonggkai       ECPD-26413: Removed unused APPROVAL_BY, APPROVAL_DATE, APPROVAL_STATE
-------------------------------------------------------------------------------------
SELECT
'TANK' AS CLASS_NAME,
b.NAME AS NAME,
       a.OBJECT_CODE AS CODE,
       b.OBJECT_ID AS OBJECT_ID,
       a.START_DATE AS START_DATE,
       b.DAYTIME AS DAYTIME,
       a.END_DATE AS OBJECT_END_DATE,
	   b.END_DATE AS END_DATE,
       b.OP_PU_ID AS OP_PU_ID,
       b.OP_SUB_PU_ID AS OP_SUB_PU_ID,
       b.OP_AREA_ID AS OP_AREA_ID,
       b.OP_SUB_AREA_ID AS OP_SUB_AREA_ID,
       b.OP_FCTY_CLASS_2_ID AS OP_FCTY_CLASS_2_ID,
       b.OP_FCTY_CLASS_1_ID AS OP_FCTY_CLASS_1_ID,
       b.CP_AREA_ID AS CP_AREA_ID,
       b.CP_COL_POINT_ID AS CP_COL_POINT_ID,
       b.CP_OPERATOR_ROUTE_ID AS CP_OPERATOR_ROUTE_ID,
       b.CP_PU_ID AS CP_PU_ID,
       b.CP_SUB_AREA_ID AS CP_SUB_AREA_ID,
       b.CP_SUB_PU_ID AS CP_SUB_PU_ID,
	   a.DESCRIPTION AS DESCRIPTION,
	   b.COMMENTS AS COMMENTS,
       b.record_status,
       b.created_by,
       b.created_date,
       b.last_updated_by,
       b.last_updated_date,
       b.rev_no,
       b.rev_text,
       b.bf_usage AS BF_USAGE,
      ec_prosty_codes.CODE_TEXT(b.BITUMEN_DENS_METHOD,'TANK_BITUMEN_DENS_METHOD') AS BITUMEN_DENS_METHOD,
      ec_prosty_codes.CODE_TEXT(b.BS_W_VOL_METHOD,'TANK_BSW_VOL_METHOD') AS BS_W_VOL_METHOD,
      ec_prosty_codes.CODE_TEXT(b.BS_W_WT_METHOD,'TANK_BSW_WT_METHOD') AS BS_W_WT_METHOD,
      b.CORR_DENSITY_METHOD,
      b.CORR_GRAVITY_METHOD,
      b.CP_AREA_CODE,
      b.CP_COL_POINT_CODE,
      b.CP_OPERATOR_ROUTE_CODE,
      b.CP_PU_CODE,
      b.CP_SUB_AREA_CODE,
      b.CP_SUB_PU_CODE,
      b.DATE_1,
      b.DATE_2,
      b.DATE_3,
      b.DATE_4,
      b.DATE_5,
      ec_prosty_codes.CODE_TEXT(b.DENSITY_METHOD,'TANK_STD_DENSITY_METHOD') AS DENSITY_METHOD,
      ec_prosty_codes.CODE_TEXT(b.DILUENT_DENS_METHOD,'TANK_DILUENT_DENS_METHOD') AS DILUENT_DENS_METHOD,
      ec_prosty_codes.CODE_TEXT(b.DILUENT_METHOD,'TANK_DILUENT_METHOD') AS DILUENT_METHOD,
      b.EXCLUDE_TANK_WELL,
      ec_prosty_codes.CODE_TEXT(b.FREE_WAT_VOL_MET,'TANK_FREE_WATER_VOL_METHOD') AS FREE_WAT_VOL_MET,
      b.GROUP_REF_CODE_1,
      b.GROUP_REF_CODE_2,
      b.GROUP_REF_CODE_3,
      b.GROUP_REF_CODE_4,
      b.GROUP_REF_CODE_5,
      b.GROUP_REF_CODE_6,
      b.GROUP_REF_CODE_7,
      b.GROUP_REF_CODE_8,
      b.GROUP_REF_CODE_9,
      b.GROUP_REF_CODE_10,
      ec_prosty_codes.CODE_TEXT(b.NET_MASS_METHOD,'TANK_GRS_MASS_METHOD') AS GRS_MASS_METHOD,
      ec_prosty_codes.CODE_TEXT(b.NET_MASS_METHOD,'TANK_GRS_VOL_METHOD') AS GRS_VOL_METHOD,
      ec_prosty_codes.CODE_TEXT(b.NET_MASS_METHOD,'TANK_NET_MASS_METHOD') AS NET_MASS_METHOD,
      ec_prosty_codes.CODE_TEXT(b.NET_VOL_METHOD,'TANK_NET_VOL_METHOD') AS NET_VOL_METHOD,
      ec_prosty_codes.CODE_TEXT(b.OBS_DENS_METHOD,'TANK_OBS_DENSITY_METHOD') AS OBS_DENS_METHOD,
      NULL AS LOCATION,
      b.OP_AREA_CODE,
      b.OP_FCTY_CLASS_1_CODE,
      b.OP_FCTY_CLASS_2_CODE,
      b.OP_PU_CODE,
      b.OP_SUB_AREA_CODE,
      b.OP_SUB_PU_CODE,
      ec_prosty_codes.CODE_TEXT(b.ROOF_DISP_METHOD,'TANK_ROOF_DISPL_METHOD') AS ROOF_DISP_METHOD,
      ec_prosty_codes.CODE_TEXT(b.STRAP_LEVEL_UOM,'TANK_STRAP_UOM') AS STRAP_LEVEL_UOM,
      b.STRAP_VALUE_TYPE,
      ec_prosty_codes.CODE_TEXT(b.STRAPPING_METHOD,'STRAPPING_METHOD') AS STRAPPING_METHOD,
      NULL AS PORTABLE_TANK,
      NULL AS TANK_CLOSING_UNIT,
      b.TANK_METER_FREQ,
      ec_prosty_codes.CODE_TEXT(b.TANK_TYPE,'TANK_TYPE') AS TANK_TYPE,
      ecdp_objects.GetObjCode('BFDD0C7010A34F8FA5489FA51B67C68D') AS TANK_WELL,
      b.TEXT_1,
      b.TEXT_2,
      b.TEXT_3,
      b.TEXT_4,
      b.TEXT_5,
      b.TEXT_6,
      b.TEXT_7,
      b.TEXT_8,
      b.TEXT_9,
      b.TEXT_10,
      ec_prosty_codes.CODE_TEXT(b.VCF_METHOD,'TANK_TYPE') AS VCF_METHOD,
      ec_prosty_codes.CODE_TEXT(b.WATER_VOL_METHOD,'TANK_WATER_VOL_METHOD') AS WATER_VOL_METHOD,
      NULL AS UNIT
FROM TANK a, TANK_VERSION b
WHERE a.OBJECT_ID = b.OBJECT_ID
UNION
SELECT
'CHEM_TANK' AS CLASS_NAME,
b.NAME AS NAME,
       a.OBJECT_CODE AS CODE,
       b.OBJECT_ID AS OBJECT_ID,
       a.START_DATE AS START_DATE,
       b.DAYTIME AS DAYTIME,
       a.END_DATE AS OBJECT_END_DATE,
       b.END_DATE AS END_DATE,
       b.OP_PU_ID AS OP_PU_ID,
       b.OP_SUB_PU_ID AS OP_SUB_PU_ID,
       b.OP_AREA_ID AS OP_AREA_ID,
       b.OP_SUB_AREA_ID AS OP_SUB_AREA_ID,
       b.OP_FCTY_CLASS_2_ID AS OP_FCTY_CLASS_2_ID,
       b.OP_FCTY_CLASS_1_ID AS OP_FCTY_CLASS_1_ID,
       b.CP_AREA_ID AS CP_AREA_ID,
       b.CP_COL_POINT_ID AS CP_COL_POINT_ID,
       b.CP_OPERATOR_ROUTE_ID AS CP_OPERATOR_ROUTE_ID,
       b.CP_PU_ID AS CP_PU_ID,
       b.CP_SUB_AREA_ID AS CP_SUB_AREA_ID,
       b.CP_SUB_PU_ID AS CP_SUB_PU_ID,
	   a.DESCRIPTION AS DESCRIPTION,
	   b.COMMENTS AS COMMENTS,
       b.record_status,
       b.created_by,
       b.created_date,
       b.last_updated_by,
       b.last_updated_date,
       b.rev_no,
       b.rev_text,
       NULL AS BF_USAGE,
      NULL AS BITUMEN_DENS_METHOD,
      NULL AS BS_W_VOL_METHOD,
      NULL AS BS_W_WT_METHOD,
      NULL AS CORR_DENSITY_METHOD,
      NULL AS CORR_GRAVITY_METHOD,
      b.CP_AREA_CODE,
      b.CP_COL_POINT_CODE,
      b.CP_OPERATOR_ROUTE_CODE,
      b.CP_PU_CODE,
      b.CP_SUB_AREA_CODE,
      b.CP_SUB_PU_CODE,
      b.DATE_1,
      b.DATE_2,
      b.DATE_3,
      b.DATE_4,
      b.DATE_5,
      NULL AS DENSITY_METHOD,
      NULL AS DILUENT_DENS_METHOD,
      NULL AS DILUENT_METHOD,
      NULL AS EXCLUDE_TANK_WELL,
      NULL AS FREE_WAT_VOL_MET,
      b.GROUP_REF_CODE_1,
      b.GROUP_REF_CODE_2,
      b.GROUP_REF_CODE_3,
      b.GROUP_REF_CODE_4,
      b.GROUP_REF_CODE_5,
      b.GROUP_REF_CODE_6,
      b.GROUP_REF_CODE_7,
      b.GROUP_REF_CODE_8,
      b.GROUP_REF_CODE_9,
      b.GROUP_REF_CODE_10,
      NULL AS GRS_MASS_METHOD,
      NULL AS GRS_VOL_METHOD,
      NULL AS NET_MASS_METHOD,
      NULL AS NET_VOL_METHOD,
      NULL AS OBS_DENS_METHOD,
      b.LOCATION,
      b.OP_AREA_CODE,
      b.OP_FCTY_CLASS_1_CODE,
      b.OP_FCTY_CLASS_2_CODE,
      b.OP_PU_CODE,
      b.OP_SUB_AREA_CODE,
      b.OP_SUB_PU_CODE,
      NULL AS ROOF_DISP_METHOD,
      NULL AS STRAP_LEVEL_UOM,
      NULL AS STRAP_VALUE_TYPE,
      NULL AS STRAPPING_METHOD,
      b.PORTABLE_TANK,
      b.TANK_CLOSING_UNIT,
      b.TANK_METER_FREQ,
      NULL AS TANK_TYPE,
      NULL AS TANK_WELL,
      b.TEXT_1,
      b.TEXT_2,
      b.TEXT_3,
      b.TEXT_4,
      b.TEXT_5,
      b.TEXT_6,
      b.TEXT_7,
      b.TEXT_8,
      b.TEXT_9,
      b.TEXT_10,
      NULL AS VCF_METHOD,
      NULL AS WATER_VOL_METHOD,
      b.UNIT
FROM CHEM_TANK a, CHEM_TANK_VERSION b
WHERE a.OBJECT_ID = b.OBJECT_ID
)