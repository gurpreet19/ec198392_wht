CREATE OR REPLACE FORCE VIEW "V_METER_COMPOSITION" ("ANALYSIS_NO", "OBJECT_ID", "OBJECT_CLASS_NAME", "DAYTIME", "ANALYSIS_TYPE", "SAMPLING_METHOD", "VALID_FROM_DATE", "PRODUCTION_DAY", "ANALYSIS_STATUS", "VALUE_1", "VALUE_2", "VALUE_3", "VALUE_4", "VALUE_5", "VALUE_6", "VALUE_7", "VALUE_8", "VALUE_9", "VALUE_10", "VALUE_11", "VALUE_12", "VALUE_13", "VALUE_14", "VALUE_15", "VALUE_16", "VALUE_17", "VALUE_18", "VALUE_19", "VALUE_20", "VALUE_21", "VALUE_22", "VALUE_23", "VALUE_24", "VALUE_25", "VALUE_26", "VALUE_27", "VALUE_28", "VALUE_29", "VALUE_30", "VALUE_31", "VALUE_32", "VALUE_33", "VALUE_34", "VALUE_35", "VALUE_36", "VALUE_37", "VALUE_38", "VALUE_39", "VALUE_40", "VALUE_41", "VALUE_42", "VALUE_43", "VALUE_44", "VALUE_45", "VALUE_46", "VALUE_47", "TEXT_1", "TEXT_2", "TEXT_3", "TEXT_4", "TEXT_5", "TEXT_6", "TEXT_7", "TEXT_8", "TEXT_9", "TEXT_10", "TEXT_11", "TEXT_12", "TEXT_13", "TEXT_14", "TEXT_15", "TEXT_16", "TEXT_17", "TEXT_18", "TEXT_19", "TEXT_20", "TEXT_21", "TEXT_22", "TEXT_23", "TEXT_24", "TEXT_25", "TEXT_26", "TEXT_27", "TEXT_28", "TEXT_29", "TEXT_30", "TEXT_31", "TEXT_32", "TEXT_33", "TEXT_34", "TEXT_35", "TEXT_36", "TEXT_37", "TEXT_38", "TEXT_39", "TEXT_40", "TEXT_41", "TEXT_42", "DATE_1", "DATE_2", "DATE_3", "DATE_4", "DATE_5", "DATE_6", "DATE_7", "DATE_8", "DATE_9", "DATE_10", "DATE_11", "COMPONENT_NO", "COMPONENT_NAME", "WT_PCT", "MOL_PCT", "MOL_WT", "DENSITY", "VOL_PCT", "MEAS_MOL_WT", "MEAS_SPECIFIC_GRAVITY", "SORT_ORDER", "RECORD_STATUS", "CREATED_BY", "CREATED_DATE", "LAST_UPDATED_BY", "LAST_UPDATED_DATE", "REV_NO", "REV_TEXT") AS 
  (
----------------------------------------------------------------------------------------------------
-- File name: V_METER_COMPOSITION.sql
-- View name: V_METER_COMPOSITION
--
-- $Revision: 1.1.4.3 $
--
-- Purpose  : Use as source for classes used to present composition as a cross tab
--			: Notice there is also a trigger behind this view making it possible to to updates
--
-- Modification history:
--
-- Date       Whom  Change description:
-- ---------- ----  --------------------------------------------------------------------------------
-- 30.05.2011 KSN   Intial version
-- 29.10.2012 sharawan	ECPD-22176: Include VALUE_n, TEXT_n, DATE_n columns to the view. Modified the
--						view to take last_updated_date, last_updated_by, revision_text from fluid_analysis_component table.
----------------------------------------------------------------------------------------------------
select a.analysis_no,
       a.object_id,
       a.object_class_name,
       a.daytime,
       a.analysis_type,
       a.sampling_method,
       a.valid_from_date,
       a.production_day,
       a.analysis_status,
       a.VALUE_1 VALUE_1,
        a.VALUE_2 VALUE_2,
        a.VALUE_3 VALUE_3,
        a.VALUE_4 VALUE_4,
        a.VALUE_5 VALUE_5,
        a.VALUE_6 VALUE_6,
        a.VALUE_7 VALUE_7,
        a.VALUE_8 VALUE_8,
        a.VALUE_9 VALUE_9,
        a.VALUE_10 VALUE_10,
        a.VALUE_11 VALUE_11,
        a.VALUE_12 VALUE_12,
        a.VALUE_13 VALUE_13,
        a.VALUE_14 VALUE_14,
        a.VALUE_15 VALUE_15,
        a.VALUE_16 VALUE_16,
        a.VALUE_17 VALUE_17,
        a.VALUE_18 VALUE_18,
        a.VALUE_19 VALUE_19,
        a.VALUE_20 VALUE_20,
        a.VALUE_21 VALUE_21,
        a.VALUE_22 VALUE_22,
        a.VALUE_23 VALUE_23,
        a.VALUE_24 VALUE_24,
        a.VALUE_25 VALUE_25,
        a.VALUE_26 VALUE_26,
        a.VALUE_27 VALUE_27,
        a.VALUE_28 VALUE_28,
        a.VALUE_29 VALUE_29,
        a.VALUE_30 VALUE_30,
        a.VALUE_31 VALUE_31,
        a.VALUE_32 VALUE_32,
        a.VALUE_33 VALUE_33,
        a.VALUE_34 VALUE_34,
        a.VALUE_35 VALUE_35,
        a.VALUE_36 VALUE_36,
        a.VALUE_37 VALUE_37,
        a.VALUE_38 VALUE_38,
        a.VALUE_39 VALUE_39,
        a.VALUE_40 VALUE_40,
        a.VALUE_41 VALUE_41,
        a.VALUE_42 VALUE_42,
        a.VALUE_43 VALUE_43,
        a.VALUE_44 VALUE_44,
        a.VALUE_45 VALUE_45,
        a.VALUE_46 VALUE_46,
        a.VALUE_47 VALUE_47,
        a.TEXT_1 TEXT_1,
        a.TEXT_2 TEXT_2,
        a.TEXT_3 TEXT_3,
        a.TEXT_4 TEXT_4,
        a.TEXT_5 TEXT_5,
        a.TEXT_6 TEXT_6,
        a.TEXT_7 TEXT_7,
        a.TEXT_8 TEXT_8,
        a.TEXT_9 TEXT_9,
        a.TEXT_10 TEXT_10,
        a.TEXT_11 TEXT_11,
        a.TEXT_12 TEXT_12,
        a.TEXT_13 TEXT_13,
        a.TEXT_14 TEXT_14,
        a.TEXT_15 TEXT_15,
        a.TEXT_16 TEXT_16,
        a.TEXT_17 TEXT_17,
        a.TEXT_18 TEXT_18,
        a.TEXT_19 TEXT_19,
        a.TEXT_20 TEXT_20,
        a.TEXT_21 TEXT_21,
        a.TEXT_22 TEXT_22,
        a.TEXT_23 TEXT_23,
        a.TEXT_24 TEXT_24,
        a.TEXT_25 TEXT_25,
        a.TEXT_26 TEXT_26,
        a.TEXT_27 TEXT_27,
        a.TEXT_28 TEXT_28,
        a.TEXT_29 TEXT_29,
        a.TEXT_30 TEXT_30,
        a.TEXT_31 TEXT_31,
        a.TEXT_32 TEXT_32,
        a.TEXT_33 TEXT_33,
        a.TEXT_34 TEXT_34,
        a.TEXT_35 TEXT_35,
        a.TEXT_36 TEXT_36,
        a.TEXT_37 TEXT_37,
        a.TEXT_38 TEXT_38,
        a.TEXT_39 TEXT_39,
        a.TEXT_40 TEXT_40,
        a.TEXT_41 TEXT_41,
        a.TEXT_42 TEXT_42,
        a.DATE_1 DATE_1,
        a.DATE_2 DATE_2,
        a.DATE_3 DATE_3,
        a.DATE_4 DATE_4,
        a.DATE_5 DATE_5,
        a.DATE_6 DATE_6,
        a.DATE_7 DATE_7,
        a.DATE_8 DATE_8,
        a.DATE_9 DATE_9,
        a.DATE_10 DATE_10,
        a.DATE_11 DATE_11,
       c.component_no,
       ec_hydrocarbon_component.name(c.component_no) component_name,
       c.WT_PCT,
       c.MOL_PCT,
	   c.MOL_WT,
	   c.DENSITY,
	   c.VOL_PCT,
	   c.MEAS_MOL_WT,
	   c.MEAS_SPECIFIC_GRAVITY,
       l.sort_order,
       c.record_status,
       c.created_by,
       c.created_date,
       c.last_updated_by,
       c.last_updated_date,
       c.rev_no,
       c.rev_text
  from OBJECT_FLUID_ANALYSIS a, FLUID_ANALYSIS_COMPONENT c, comp_set_list l
 where a.analysis_no = c.analysis_no
   and a.analysis_type = l.component_set
   and c.component_no = l.component_no
   and l.daytime <= a.daytime
   and nvl(l.end_date, a.daytime + 1) > a.daytime
   and a.object_class_name = 'METER'
   and a.sampling_method in ('DAY_SAMPLER', 'MTH_SAMPLER')
)