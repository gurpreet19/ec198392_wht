CREATE OR REPLACE FORCE VIEW "V_DOWNTIME_EVENT_LOG" ("OBJECT_ID", "DAYTIME", "END_DATE", "ASSET_TYPE", "REASON1", "REASON2", "REASON3", "REASON4", "COMMENTS", "ASSET_NAME", "LOSS_OIL", "LOSS_GAS", "LOSS_COND", "LOSS_WATER", "LOSS_WATER_INJ", "LOSS_STEAM_INJ", "LOSS_GAS_INJ", "SCHEDULED", "FACILITY", "RECORD_STATUS", "CREATED_BY", "CREATED_DATE", "LAST_UPDATED_BY", "LAST_UPDATED_DATE", "REV_NO", "REV_TEXT", "APPROVAL_STATE", "APPROVAL_BY", "APPROVAL_DATE", "REC_ID") AS 
  SELECT FCTY_DEFERMENT_EVENT.OBJECT_ID AS OBJECT_ID
     , FCTY_DEFERMENT_EVENT.DAYTIME AS DAYTIME
     , FCTY_DEFERMENT_EVENT.END_DATE AS END_DATE
     , FCTY_DEFERMENT_EVENT.ASSET_TYPE AS ASSET_TYPE
     , FCTY_DEFERMENT_EVENT.REASON_CODE_1 AS REASON1
     , FCTY_DEFERMENT_EVENT.REASON_CODE_2 AS REASON2
     , FCTY_DEFERMENT_EVENT.REASON_CODE_3 AS REASON3
     , FCTY_DEFERMENT_EVENT.REASON_CODE_4 AS REASON4
     , FCTY_DEFERMENT_EVENT.COMMENTS AS COMMENTS
     , ecdp_objects.GetObjName(FCTY_DEFERMENT_EVENT.ASSET_ID ,FCTY_DEFERMENT_EVENT.DAYTIME) AS ASSET_NAME
     , ecdp_deferment_event.calculateDeferedGrpVolume(FCTY_DEFERMENT_EVENT.EVENT_NO, 'OIL') AS LOSS_OIL
     , ecdp_deferment_event.calculateDeferedGrpVolume(FCTY_DEFERMENT_EVENT.EVENT_NO, 'GAS') AS LOSS_GAS
     , NULL AS LOSS_COND
     , ecdp_deferment_event.calculateDeferedGrpVolume(FCTY_DEFERMENT_EVENT.EVENT_NO, 'WATER') AS LOSS_WATER
     , ecdp_deferment_event.calculateDeferedGrpVolume(FCTY_DEFERMENT_EVENT.EVENT_NO, 'WATER_INJ') AS LOSS_WATER_INJ
     , NULL AS LOSS_STEAM_INJ
     , ecdp_deferment_event.calculateDeferedGrpVolume(FCTY_DEFERMENT_EVENT.EVENT_NO, 'GAS_INJ') AS LOSS_GAS_INJ
     , FCTY_DEFERMENT_EVENT.SCHEDULED AS SCHEDULED
     , FCTY_DEFERMENT_EVENT.OBJECT_ID AS FACILITY
     , NULL AS RECORD_STATUS, NULL AS CREATED_BY, NULL AS CREATED_DATE, NULL AS LAST_UPDATED_BY, NULL AS LAST_UPDATED_DATE, NULL AS REV_NO, NULL AS REV_TEXT, NULL AS APPROVAL_STATE, NULL AS APPROVAL_BY, NULL AS APPROVAL_DATE, NULL AS REC_ID
FROM FCTY_DEFERMENT_EVENT
UNION
SELECT WELL_EQUIP_DOWNTIME.OBJECT_ID AS OBJECT_ID
--     , WELL_EQUIP_DOWNTIME.EVENT_NO AS EVENT_NO,
     , WELL_EQUIP_DOWNTIME.DAYTIME AS DAYTIME
     , WELL_EQUIP_DOWNTIME.END_DATE AS END_DATE
     , WELL_EQUIP_DOWNTIME.OBJECT_TYPE AS ASSET_TYPE -- OBJECT_TYPE,
     , WELL_EQUIP_DOWNTIME.REASON_CODE_1 AS REASON1
     , WELL_EQUIP_DOWNTIME.REASON_CODE_2 AS REASON2
     , WELL_EQUIP_DOWNTIME.REASON_CODE_3 AS REASON3
     , WELL_EQUIP_DOWNTIME.REASON_CODE_4 AS REASON4
     , WELL_EQUIP_DOWNTIME.COMMENTS AS COMMENTS
     , ecdp_objects.GetObjName(WELL_EQUIP_DOWNTIME.EQUIPMENT_ID ,WELL_EQUIP_DOWNTIME.DAYTIME) AS ASSET_NAME
     , EcBp_Well_Eqpm_Deferment.getEventLossRate(WELL_EQUIP_DOWNTIME.event_no, 'OIL')  AS LOSS_OIL
     , EcBp_Well_Eqpm_Deferment.getEventLossRate(WELL_EQUIP_DOWNTIME.event_no, 'GAS')  AS LOSS_GAS
     , EcBp_Well_Eqpm_Deferment.getEventLossRate(WELL_EQUIP_DOWNTIME.event_no, 'COND')  AS LOSS_COND
     , NULL AS LOSS_WATER
     , EcBp_Well_Eqpm_Deferment.getEventLossRate(WELL_EQUIP_DOWNTIME.event_no, 'WAT_INJ')  AS LOSS_WATER_INJ
     , EcBp_Well_Eqpm_Deferment.getEventLossRate(WELL_EQUIP_DOWNTIME.event_no, 'STEAM_INJ')  AS LOSS_STEAM_INJ
     , EcBp_Well_Eqpm_Deferment.getEventLossRate(WELL_EQUIP_DOWNTIME.event_no, 'GAS_INJ')  AS LOSS_GAS_INJ
     , NULL AS SCHEDULED
     , ecdp_well.getFacility(WELL_EQUIP_DOWNTIME.OBJECT_ID,WELL_EQUIP_DOWNTIME.DAYTIME) AS FACILITY
     , NULL AS RECORD_STATUS, NULL AS CREATED_BY, NULL AS CREATED_DATE, NULL AS LAST_UPDATED_BY, NULL AS LAST_UPDATED_DATE, NULL AS REV_NO, NULL AS REV_TEXT, NULL AS APPROVAL_STATE, NULL AS APPROVAL_BY, NULL AS APPROVAL_DATE, NULL AS REC_ID
FROM WELL_EQUIP_DOWNTIME
UNION
SELECT DEF_DAY_MASTER_EVENT.DEFER_LEVEL_OBJECT_ID AS OBJECT_ID
     , DEF_DAY_MASTER_EVENT.DAYTIME AS DAYTIME
     , DEF_DAY_MASTER_EVENT.END_DATE AS END_DATE
--     , DEF_DAY_MASTER_EVENT.INCIDENT_NO AS EVENT_NO
     , DEF_DAY_MASTER_EVENT.ASSET_TYPE AS ASSET_TYPE
     , DEF_DAY_MASTER_EVENT.DEF_CODE_1 AS REASON1
     , DEF_DAY_MASTER_EVENT.DEF_CODE_2 AS REASON2
     , DEF_DAY_MASTER_EVENT.DEF_CODE_3 AS REASON3
     , DEF_DAY_MASTER_EVENT.DEF_CODE_4 AS REASON4
     , DEF_DAY_MASTER_EVENT.COMMENTS AS COMMENTS
     , ecdp_objects.GetObjName(DEF_DAY_MASTER_EVENT.ASSET_ID ,DEF_DAY_MASTER_EVENT.DAYTIME) AS ASSET_NAME
     , ecbp_defer_master_event.aggregrateMasterDeferredVolume(DEF_DAY_MASTER_EVENT.INCIDENT_NO, 'OIL' ) AS LOSS_OIL
     , ecbp_defer_master_event.aggregrateMasterDeferredVolume(DEF_DAY_MASTER_EVENT.INCIDENT_NO, 'GAS' ) AS LOSS_GAS
     , NULL AS LOSS_COND
     , NULL AS LOSS_WATER
     , ecbp_defer_master_event.aggregrateMasterDeferredVolume(DEF_DAY_MASTER_EVENT.INCIDENT_NO, 'WATER_INJ' ) AS LOSS_WATER_INJ
     , NULL AS LOSS_STEAM_INJ
     , ecbp_defer_master_event.aggregrateMasterDeferredVolume(DEF_DAY_MASTER_EVENT.INCIDENT_NO, 'GAS_INJ' ) AS LOSS_GAS_INJ
     , DEF_DAY_MASTER_EVENT.SCHEDULED AS SCHEDULED
     , DEF_DAY_MASTER_EVENT.DEFER_LEVEL_OBJECT_ID AS FACILITY
     , NULL AS RECORD_STATUS, NULL AS CREATED_BY, NULL AS CREATED_DATE, NULL AS LAST_UPDATED_BY, NULL AS LAST_UPDATED_DATE, NULL AS REV_NO, NULL AS REV_TEXT, NULL AS APPROVAL_STATE, NULL AS APPROVAL_BY, NULL AS APPROVAL_DATE, NULL AS REC_ID
FROM DEF_DAY_MASTER_EVENT