--DV_CT
UPDATE SYSTEM_MONTH SET LOCK_IND='Y' where LOCK_IND='X';

-- To fix DV_CT_MSG_MTH_PC_REF_ENTS
Insert into TV_UNIT_CONVERSION (TABLE_CLASS_NAME,FROM_UNIT,TO_UNIT,DAYTIME,MULT_FACT) values 
('UNIT_CONVERSION','KGPERM3','TONNESPERSM3',to_date('01-JAN-60 00:00:00','DD-MON-RR HH24:MI:SS'),'0.001');

--To fix DV_CT_PWEL_DAY_STATUS_ALL

update CLASS_ATTRIBUTE_CNFG
set DB_MAPPING_TYPE='FUNCTION',DB_SQL_SYNTAX = 'NULLIF(ECBP_WELL_THEORETICAL.findCondMassDay(PWEL_DAY_STATUS.object_id, PWEL_DAY_STATUS.daytime),0)/NULLIF(ECBP_WELL_THEORETICAL.findOilStdDensity(PWEL_DAY_STATUS.object_id, PWEL_DAY_STATUS.daytime),0)'
where class_name = 'CT_PWEL_DAY_STATUS_ALL' and attribute_name = 'AVG_COND_RATE';

update CLASS_ATTRIBUTE_CNFG
set DB_MAPPING_TYPE='FUNCTION', DB_SQL_SYNTAX = 'NULLIF(ECBP_WELL_THEORETICAL.findGasMassDay(PWEL_DAY_STATUS.object_id, PWEL_DAY_STATUS.daytime),0)/NULLIF(ECBP_WELL_THEORETICAL.findGasStdDensity(PWEL_DAY_STATUS.object_id, PWEL_DAY_STATUS.daytime),0)'
where class_name = 'CT_PWEL_DAY_STATUS_ALL' and attribute_name = 'AVG_GAS_RATE';

update CLASS_ATTRIBUTE_CNFG
set DB_MAPPING_TYPE='FUNCTION', DB_SQL_SYNTAX = 'NULLIF(ECBP_WELL_THEORETICAL.findWaterMassDay(PWEL_DAY_STATUS.object_id, PWEL_DAY_STATUS.daytime),0)/NULLIF(ECBP_WELL_THEORETICAL.findWatStdDensity(PWEL_DAY_STATUS.object_id, PWEL_DAY_STATUS.daytime),0)'
where class_name = 'CT_PWEL_DAY_STATUS_ALL' and attribute_name = 'AVG_WATER_RATE';

--TV_UOM_SETUP
UPDATE TV_UOM_SETUP SET DB_UNIT='Y',REPORT_UNIT='N',VIEW_UNIT='N' WHERE MEASUREMENT_TYPE='DISTANCE' AND UNIT='KM';
UPDATE TV_UOM_SETUP SET DB_UNIT='Y',REPORT_UNIT='Y',VIEW_UNIT='Y' WHERE MEASUREMENT_TYPE='DISTANCE' AND UNIT='MILE';

UPDATE TV_UOM_SETUP SET DB_UNIT='N',REPORT_UNIT='Y',VIEW_UNIT='N' WHERE MEASUREMENT_TYPE='ENERGY_CONTENT' AND UNIT='MJPERSM3';
UPDATE TV_UOM_SETUP SET DB_UNIT='Y',REPORT_UNIT='Y',VIEW_UNIT='Y' WHERE MEASUREMENT_TYPE='ENERGY_CONTENT' AND UNIT='BTUPERSCF';

UPDATE TV_UOM_SETUP SET DB_UNIT='Y',REPORT_UNIT='Y',VIEW_UNIT='Y' WHERE MEASUREMENT_TYPE='GAS_DENS' AND UNIT='KGPERM3';
UPDATE TV_UOM_SETUP SET DB_UNIT='N',REPORT_UNIT='Y',VIEW_UNIT='N' WHERE MEASUREMENT_TYPE='GAS_DENS' AND UNIT='LBSPERMCF';

UPDATE TV_UOM_SETUP SET DB_UNIT='N',REPORT_UNIT='Y',VIEW_UNIT='N' WHERE MEASUREMENT_TYPE='GAS_RATE' AND UNIT='MCFPERDAY';
UPDATE TV_UOM_SETUP SET DB_UNIT='N',REPORT_UNIT='Y',VIEW_UNIT='N' WHERE MEASUREMENT_TYPE='MASS_RATE' AND UNIT='KGPERDAY';

UPDATE TV_UOM_SETUP SET DB_UNIT='Y',REPORT_UNIT='Y',VIEW_UNIT='Y' WHERE MEASUREMENT_TYPE='OIL_DENS' AND UNIT='KGPERM3';
UPDATE TV_UOM_SETUP SET DB_UNIT='N',REPORT_UNIT='Y',VIEW_UNIT='N' WHERE MEASUREMENT_TYPE='OIL_DENS' AND UNIT='API';

UPDATE TV_UOM_SETUP SET DB_UNIT='Y',REPORT_UNIT='Y',VIEW_UNIT='Y' WHERE MEASUREMENT_TYPE='OIL_RATE' AND UNIT='M3PERDAY';
UPDATE TV_UOM_SETUP SET DB_UNIT='N',REPORT_UNIT='Y',VIEW_UNIT='N' WHERE MEASUREMENT_TYPE='OIL_RATE' AND UNIT='BBLSPERDAY';
UPDATE TV_UOM_SETUP SET DB_UNIT='N',REPORT_UNIT='Y',VIEW_UNIT='N' WHERE MEASUREMENT_TYPE='OIL_RATE' AND UNIT='TONNESPERDAY';

UPDATE TV_UOM_SETUP SET DB_UNIT='Y',REPORT_UNIT='Y',VIEW_UNIT='Y' WHERE MEASUREMENT_TYPE='OIL_VOL' AND UNIT='SM3';
UPDATE TV_UOM_SETUP SET DB_UNIT='N',REPORT_UNIT='Y',VIEW_UNIT='N' WHERE MEASUREMENT_TYPE='OIL_VOL' AND UNIT='BBLS';

UPDATE TV_UOM_SETUP SET DB_UNIT='N',REPORT_UNIT='Y',VIEW_UNIT='N' WHERE MEASUREMENT_TYPE='POWER' AND UNIT='MW';
UPDATE TV_UOM_SETUP SET DB_UNIT='N',REPORT_UNIT='Y',VIEW_UNIT='N' WHERE MEASUREMENT_TYPE='POWER' AND UNIT='KW';

UPDATE TV_UOM_SETUP SET DB_UNIT='Y',REPORT_UNIT='Y',VIEW_UNIT='Y' WHERE MEASUREMENT_TYPE='STD_GAS_DENS' AND UNIT='KGPERSM3';
UPDATE TV_UOM_SETUP SET DB_UNIT='N',REPORT_UNIT='Y',VIEW_UNIT='N' WHERE MEASUREMENT_TYPE='STD_GAS_DENS' AND UNIT='LBSPERMSCF';

UPDATE TV_UOM_SETUP SET DB_UNIT='N',REPORT_UNIT='N',VIEW_UNIT='N' WHERE MEASUREMENT_TYPE='STD_GAS_RATE' AND UNIT='MSCFPERDAY';
UPDATE TV_UOM_SETUP SET DB_UNIT='N',REPORT_UNIT='N',VIEW_UNIT='N' WHERE MEASUREMENT_TYPE='STD_GAS_RATE_HR' AND UNIT='MSCFPERHR';
UPDATE TV_UOM_SETUP SET DB_UNIT='N',REPORT_UNIT='N',VIEW_UNIT='N' WHERE MEASUREMENT_TYPE='STD_GAS_VOL_RATE_MTH' AND UNIT='MSCFPERMTH';

UPDATE TV_UOM_SETUP SET DB_UNIT='Y',REPORT_UNIT='Y',VIEW_UNIT='Y' WHERE MEASUREMENT_TYPE='STD_LIQ_VOL_RATE' AND UNIT='SM3PERDAY';
UPDATE TV_UOM_SETUP SET DB_UNIT='N',REPORT_UNIT='Y',VIEW_UNIT='N' WHERE MEASUREMENT_TYPE='STD_LIQ_VOL_RATE' AND UNIT='BBLSPERDAY';

UPDATE TV_UOM_SETUP SET DB_UNIT='Y',REPORT_UNIT='Y',VIEW_UNIT='Y' WHERE MEASUREMENT_TYPE='STD_LIQ_VOL_RATE_MTH' AND UNIT='SM3PERMTH';
UPDATE TV_UOM_SETUP SET DB_UNIT='N',REPORT_UNIT='Y',VIEW_UNIT='N' WHERE MEASUREMENT_TYPE='STD_LIQ_VOL_RATE_MTH' AND UNIT='BBLSPERMTH';

UPDATE TV_UOM_SETUP SET DB_UNIT='Y',REPORT_UNIT='Y',VIEW_UNIT='Y' WHERE MEASUREMENT_TYPE='STD_OIL_RATE' AND UNIT='SM3PERDAY';
UPDATE TV_UOM_SETUP SET DB_UNIT='N',REPORT_UNIT='Y',VIEW_UNIT='N' WHERE MEASUREMENT_TYPE='STD_OIL_RATE' AND UNIT='BBLSPERDAY';

UPDATE TV_UOM_SETUP SET DB_UNIT='Y',REPORT_UNIT='N',VIEW_UNIT='Y' WHERE MEASUREMENT_TYPE='WATER_DENS' AND UNIT='KGPERM3';

UPDATE TV_UOM_SETUP SET DB_UNIT='Y',REPORT_UNIT='Y',VIEW_UNIT='Y' WHERE MEASUREMENT_TYPE='WATER_RATE' AND UNIT='SM3PERDAY';
UPDATE TV_UOM_SETUP SET DB_UNIT='N',REPORT_UNIT='Y',VIEW_UNIT='N' WHERE MEASUREMENT_TYPE='WATER_RATE' AND UNIT='BBLSPERDAY';
UPDATE TV_UOM_SETUP SET DB_UNIT='N',REPORT_UNIT='Y',VIEW_UNIT='N' WHERE MEASUREMENT_TYPE='WATER_RATE' AND UNIT='M3PERDAY';

UPDATE TV_UOM_SETUP SET DB_UNIT='N',REPORT_UNIT='Y',VIEW_UNIT='N' WHERE MEASUREMENT_TYPE='WATER_RATE_MTH' AND UNIT='BBLSPERMTH';

alter table ctrl_system_attribute disable all triggers;
  update ctrl_system_attribute set ATTRIBUTE_TEXT = '''ECKERNEL_WST'',''ENERGYX_WST'',''ecistag''' where attribute_type = 'DT_OVERWRITE' ;
alter table ctrl_system_attribute enable all triggers;

--UPGCVX-1757
UPDATE TV_UOM_SETUP SET VIEW_UNIT = 'Y' where measurement_type = 'LNG_ENERGY' and UNIT = 'MMBTU';
UPDATE TV_UOM_SETUP SET VIEW_UNIT = 'N' where measurement_type = 'LNG_ENERGY' and UNIT = 'GJ';

--dv_contract_account
alter table contract_account disable all triggers;

update contract_account set end_date=ec_contract.end_date(CONTRACT_ACCOUNT.OBJECT_ID);

commit;
-- Turn on the triggers
alter table contract_account enable all triggers;
COMMIT;

--STORAGE_LIFT_NOMINATION
update CLASS_ATTRIBUTE_CNFG
set DB_SQL_SYNTAX = 'DECODE ( ECDP_OBJECTS.GETOBJCODE (STORAGE_LIFT_NOMINATION.OBJECT_ID),''STW_COND'', (trunc(STORAGE_LIFT_NOMINATION.START_LIFTING_DATE ) + (EC_PROSTY_CODES.ALT_CODE(STORAGE_LIFT_NOMINATION.NOM_FIRM_DATE_RANGE,''CARGO_RANGE_MIDDLE'')) + 1-(1/(24*60))))'
where class_name = 'STORAGE_LIFT_NOMINATION' and attribute_name = 'LDR_FINISH';