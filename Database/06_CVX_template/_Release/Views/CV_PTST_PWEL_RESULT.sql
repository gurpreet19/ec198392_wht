---------------------------------------------------------------------------------------------------
--  CV_PTST_PWEL_RESULT
--
--  Purpose:   		Consolidates PTST and PWEL data
--			Different from existing PTST_PWEL_RESULT data class in that this one
--			includes all available columns
--
--			Along with data class CT_PTST_PWEL_RESULT, replaces view CV_PWEL_RESULT_ALL
--
--			
--  Notes:
--
--  	MVAS 02/2007	New
--	LHBW 03/2007	Modified to exclude SYSTEM_DAYS to improve performance
--
--
--
----------------------------------------------------------------------------------------------------- 


CREATE OR REPLACE VIEW CV_PTST_PWEL_RESULT
	AS 
SELECT
    TRUNC(PTST.DAYTIME,'DD') AS DAYTIME,
-- PWEL
    PWEL.OBJECT_ID AS OBJECT_ID,
      PWEL.RESULT_NO AS RESULT_NO,
      PWEL.RESULT_NO_COMB AS RESULT_NO_COMB,      
      PWEL.PRIMARY_IND AS PRIMARY_IND,
      PWEL.FLOWING_IND AS FLOWING_IND,
      PWEL.CHOKE_SIZE AS CHOKE_SIZE,
      PWEL.WH_USC_PRESS AS WH_USC_PRESS,
      PWEL.WH_USC_TEMP AS WH_USC_TEMP,
      PWEL.WH_DSC_PRESS AS WH_DSC_PRESS,
      PWEL.WH_DSC_TEMP AS WH_DSC_TEMP,
    PWEL.WH_PRESS AS WH_PRESS,
    PWEL.WH_TEMP AS WH_TEMP,
     PWEL.BH_PRESS AS BH_PRESS,
    PWEL.BH_TEMP AS BH_TEMP,
    PWEL.ANNULUS_PRESS AS ANNULUS_PRESS,
     PWEL.ANNULUS_TEMP AS ANNULUS_TEMP,
      PWEL.SAND_RATE AS SAND_RATE,
      PWEL.EROSION_RATE AS EROSION_RATE,
    PWEL.NET_OIL_RATE_ADJ AS NET_OIL_RATE_ADJ,
    PWEL.GAS_RATE_ADJ AS GAS_RATE_ADJ,
      PWEL.NET_COND_RATE_ADJ AS NET_COND_RATE_ADJ,
    PWEL.TOT_WATER_RATE_ADJ AS TOT_WATER_RATE_ADJ,
    PWEL.NET_OIL_DENSITY_ADJ AS NET_OIL_DENSITY_ADJ,
      PWEL.GAS_DENSITY_ADJ AS GAS_DENSITY_ADJ,
      PWEL.NET_COND_DENSITY_ADJ AS NET_COND_DENSITY_ADJ,
      PWEL.TOT_WATER_DENSITY_ADJ AS TOT_WAT_DENSITY_ADJ,
      PWEL.MPM_OIL_RATE_FLC AS MPM_OIL_RATE_FLC,
      PWEL.MPM_OIL_RATE AS MPM_OIL_RATE,            
      PWEL.MPM_OIL_DENSITY AS MPM_OIL_DENSITY,          
      PWEL.MPM_GAS_RATE_FLC AS MPM_GAS_RATE_FLC,         
      PWEL.MPM_GAS_RATE AS MPM_GAS_RATE,            
      PWEL.MPM_GAS_DENSITY AS MPM_GAS_DENSITY,          
      PWEL.MPM_WATER_RATE_FLC AS MPM_WATER_RATE_FLC,      
      PWEL.MPM_WATER_RATE AS MPM_WATER_RATE,           
      PWEL.MPM_MIX_DENSITY AS MPM_MIX_DENSITY,         
      PWEL.MPM_PRESS AS MPM_PRESS,                
      PWEL.MPM_TEMP AS MPM_TEMP,                
      PWEL.MPM_COND_RATE AS MPM_COND_RATE,           
      PWEL.MPM_OIL_MASS_RATE AS MPM_OIL_M_RATE,        
      PWEL.MPM_GAS_MASS_RATE AS MPM_GAS_M_RATE,       
      PWEL.MPM_COND_MASS_RATE AS MPM_COND_M_RATE,       
      PWEL.MPM_WATER_MASS_RATE AS MPM_WATER_M_RATE,     
      PWEL.MPM_COND_DENSITY AS MPM_COND_DENSITY,        
      PWEL.MPM_WATER_DENSITY AS MPM_WATER_DENSITY,       
      PWEL.MPM_COND_RATE_FLC AS MPM_COND_RATE_FLC,       
      PWEL.MPM_OIL_MASS_RATE_FLC AS MPM_OIL_M_RATE_FLC,   
      PWEL.MPM_GAS_MASS_RATE_FLC AS MPM_GAS_M_RATE_FLC,   
      PWEL.MPM_COND_MASS_RATE_FLC AS MPM_COND_M_RATE_FLC,  
      PWEL.MPM_WATER_MASS_RATE_FLC AS MPM_WATER_M_RATE_FLC, 
      PWEL.MPM_OIL_DENSITY_FLC AS MPM_OIL_DENSITY_FLC,     
      PWEL.MPM_GAS_DENSITY_FLC AS MPM_GAS_DENSITY_FLC,     
      PWEL.MPM_COND_DENSITY_FLC AS MPM_COND_DENSITY_FLC,    
      PWEL.MPM_WATER_DENSITY_FLC AS MPM_WAT_DENSITY_FLC,   
      PWEL.MPM_MIX_DENSITY_FLC AS MPM_MIX_DENSITY_FLC,     
      PWEL.MPM_CONDUCT AS MPM_CONDUCT,             
      PWEL.MPM_CONDUCT_TEMP AS MPM_CONDUCT_TEMP,        
      PWEL.MPM_OIL_RATE_RAW AS MPM_OIL_RATE_RAW,         
      PWEL.MPM_GAS_RATE_RAW AS MPM_GAS_RATE_RAW,        
      PWEL.MPM_WATER_RATE_RAW AS MPM_WATER_RATE_RAW,      
    PWEL.PUMP_SPEED AS PUMP_SPEED,
    PWEL.PUMP_POWER AS PUMP_POWER,
    PWEL.PUMP_STROKE AS PUMP_STROKE,
    PWEL.PUMP_TIMER AS PUMP_TIMER,
    PWEL.DRIVE_CURRENT AS DRIVE_CURRENT,
      PWEL.DRIVE_VOLTAGE AS DRIVE_VOLTAGE,           
      PWEL.LIQUID_LEVEL AS LIQUID_LEVEL,            
    PWEL.DRIVE_FREQUENCY AS DRIVE_FREQUENCY,
      PWEL.DILUENT_RATE AS DILUENT_RATE,            
    PWEL.GL_CHOKE_SIZE AS GL_CHOKE_SIZE,
    PWEL.GL_PRESS AS GL_PRESS,
    PWEL.GL_TEMP AS GL_TEMP,
    PWEL.GL_DENSITY AS GL_DENSITY,
      PWEL.GL_RATE AS GL_RATE,                  
      PWEL.EST_GL_RATE AS EST_GL_RATE,              
      PWEL.EST_DILUENT_RATE AS EST_DILUENT_RATE,         
      PWEL.DECLINE_RATE_OIL AS DECLINE_RATE_OIL,        
    PWEL.PUMP_RUNTIME AS PUMP_RUNTIME,             
      PWEL.OIL_SHRINKAGE AS OIL_SHRINKAGE,            
      PWEL.SOLUTION_GAS_FACTOR AS SOLUTION_GAS_FACTOR,     
      PWEL.GAS_SP_GRAV AS GAS_SP_GRAV,             
    PWEL.CHLORIDE AS CHLORIDE,                
     PWEL.EMULSION AS EMULSION,                 
      PWEL.FORMATION_GLR AS FORMATION_GLR,           
      PWEL.GOR AS GOR,                     
      PWEL.CGR AS CGR,                     
      PWEL.GLR AS GLR,                    
    PWEL.WATERCUT_PCT AS WATERCUT_PCT,            
     PWEL.SAND_CONTENT AS SAND_CONTENT,        
      PWEL.GAS_OUT_RATE AS GAS_OUT_RATE,            
      PWEL.OIL_OUT_RATE AS OIL_OUT_RATE,             
      PWEL.TDEV_PRESS AS TDEV_PRESS,              
      PWEL.TDEV_TEMP AS TDEV_TEMP,               
      PWEL.GAS_RATE AS GAS_RATE,                
      PWEL.EST_NET_OIL_RATE AS EST_NET_OIL_RATE,         
      PWEL.EST_GAS_RATE AS EST_GAS_RATE,            
      PWEL.EST_NET_COND_RATE AS EST_NET_COND_RATE,       
      PWEL.EST_WATER_RATE AS EST_WATER_RATE,          
      PWEL.NET_OIL_MASS_RATE_ADJ AS NET_OIL_M_RATE_ADJ,   
      PWEL.GAS_MASS_RATE_ADJ AS GAS_M_RATE_ADJ,        
      PWEL.NET_COND_MASS_RATE_ADJ AS NET_COND_M_RATE_ADJ,   
      PWEL.TOT_WATER_MASS_RATE_ADJ AS TOT_WATER_M_RATE_ADJ, 
      PWEL.WET_DRY_GAS_RATIO AS WET_DRY_GAS_RATIO,       
      PWEL.WGR AS WGR,                    
      PWEL.TREND_ANALYSIS_IND AS PW_TREND_ANALYSIS_IND,     
      PWEL.TREND_RESET_IND AS TREND_RESET_IND,
      PWEL.FWS_RATE AS FWS_RATE,
      PWEL.WELL_METER_FACTOR AS WELL_METER_FACTOR,
      PWEL.TEST_DEVICE AS TEST_DEVICE,
      PWEL.WT_MULTISELECT AS WT_MULTISELECT,
      PWEL.RATE_SOURCE AS RATE_SOURCE,
      PWEL.WET_GAS_GRAVITY AS WET_GAS_GRAVITY,
      PWEL.AVG_FLOW_MASS AS AVG_FLOW_MASS,
      PWEL.USE_CALC AS PW_USE_CALC,  
      PWEL.COMMENTS AS PW_COMMENTS,
      PWEL.VALUE_1 AS PW_VALUE_1,                 
      PWEL.VALUE_2 AS PW_VALUE_2,                 
      PWEL.VALUE_3 AS PW_VALUE_3,                 
      PWEL.VALUE_4 AS PW_VALUE_4,                 
      PWEL.VALUE_5 AS PW_VALUE_5,                 
      PWEL.VALUE_6 AS PW_VALUE_6,                 
      PWEL.VALUE_7 AS PW_VALUE_7,                 
      PWEL.VALUE_8 AS PW_VALUE_8,                 
      PWEL.VALUE_9 AS PW_VALUE_9,                 
      PWEL.VALUE_10 AS PW_VALUE_10,                
      PWEL.VALUE_11 AS PW_VALUE_11,                
      PWEL.VALUE_12 AS PW_VALUE_12,                
      PWEL.VALUE_13 AS PW_VALUE_13,                 
      PWEL.VALUE_14 AS PW_VALUE_14,                 
      PWEL.VALUE_15 AS PW_VALUE_15,                
      PWEL.VALUE_16 AS PW_VALUE_16,                
      PWEL.VALUE_17 AS PW_VALUE_17,                
      PWEL.VALUE_18 AS PW_VALUE_18,                
      PWEL.VALUE_19 AS PW_VALUE_19,                
      PWEL.VALUE_20 AS PW_VALUE_20,                
      PWEL.VALUE_21 AS PW_VALUE_21,                
      PWEL.VALUE_22 AS PW_VALUE_22,                
      PWEL.VALUE_23 AS PW_VALUE_23,                
      PWEL.VALUE_24 AS PW_VALUE_24,                 
      PWEL.VALUE_25 AS PW_VALUE_25,                 
      PWEL.VALUE_26 AS PW_VALUE_26,                 
      PWEL.VALUE_27 AS PW_VALUE_27,                 
      PWEL.VALUE_28 AS PW_VALUE_28,                
      PWEL.VALUE_29 AS PW_VALUE_29,                
      PWEL.VALUE_30 AS PW_VALUE_30, 
      PWEL.TEXT_1 AS PW_TEXT_1,                
      PWEL.TEXT_2 AS PW_TEXT_2,                 
      PWEL.TEXT_3 AS PW_TEXT_3,               
      PWEL.TEXT_4 AS PW_TEXT_4,                  
      PWEL.TEXT_5 AS PW_TEXT_5,                 
      PWEL.TEXT_6 AS PW_TEXT_6,                
      PWEL.TEXT_7 AS PW_TEXT_7,                
      PWEL.TEXT_8 AS PW_TEXT_8,                
      PWEL.TEXT_9 AS PW_TEXT_9,               
      PWEL.TEXT_10 AS PW_TEXT_10,               
      PWEL.TEXT_11 AS PW_TEXT_11,               
      PWEL.TEXT_12 AS PW_TEXT_12,               
      PWEL.TEXT_13 AS PW_TEXT_13,               
      PWEL.TEXT_14 AS PW_TEXT_14,               
      PWEL.TEXT_15 AS PW_TEXT_15,
    PWEL.RECORD_STATUS AS RECORD_STATUS,
    PWEL.CREATED_BY AS CREATED_BY,
    PWEL.CREATED_DATE AS CREATED_DATE,
    PWEL.LAST_UPDATED_BY AS LAST_UPDATED_BY,
    PWEL.LAST_UPDATED_DATE AS LAST_UPDATED_DATE,
    PWEL.REV_NO AS REV_NO,
    PWEL.REV_TEXT AS REV_TEXT,
-- PTST
      PTST.DAYTIME AS START_DATE,
      PTST.END_DATE AS END_DATE,
    PTST.DURATION AS DURATION,
    PTST.TEST_TYPE AS TEST_TYPE,
      PTST.ESTIMATE_TYPE AS ESTIMATE_TYPE,
      PTST.TEST_NO AS TEST_NO,
      PTST.SUMMARISED_IND AS SUMMARISED_IND,
    PTST.VALID_FROM_DATE AS VALID_FROM_DATE,
    PTST.STATUS AS STATUS,
      PTST.PREPROCESS_LOG AS PREPROCESS_LOG,
      PTST.TREND_ANALYSIS_IND AS PT_TREND_ANALYSIS_IND,
      PTST.USE_CALC AS PT_USE_CALC,
    PTST.COMMENTS AS PT_COMMENTS,
      PTST.VALUE_1 AS PT_VALUE_1,
      PTST.VALUE_2 AS PT_VALUE_2,
      PTST.VALUE_3 AS PT_VALUE_3,
      PTST.VALUE_4 AS PT_VALUE_4,
      PTST.VALUE_5 AS PT_VALUE_5,
      PTST.VALUE_6 AS PT_VALUE_6,
      PTST.VALUE_7 AS PT_VALUE_7,
     PTST.VALUE_8 AS PT_VALUE_8,
      PTST.VALUE_9 AS PT_VALUE_9,
      PTST.VALUE_10 AS PT_VALUE_10,
      PTST.TEXT_1 AS PT_TEXT_1,
      PTST.TEXT_2 AS PT_TEXT_2,
      PTST.TEXT_3 AS PT_TEXT_3,
      PTST.TEXT_4 AS PT_TEXT_4
FROM
    PWEL_RESULT PWEL, 
    PTST_RESULT PTST
WHERE 
    PTST.RESULT_NO = PWEL.RESULT_NO
    ;







