CREATE OR REPLACE VIEW CV_PWEL_DAY_STATUS_RBF 
AS
SELECT  pwel_day_status.daytime AS production_day,
          pwel_day_status.object_id AS object_id, 
          pwel_day_status.daytime AS daytime,
          pwel_day_status.on_stream_hrs AS on_stream_hrs,
          pwel_day_status.avg_bh_press AS avg_bh_press,
          pwel_day_status.avg_bh_temp AS avg_bh_temp,
          pwel_day_status.avg_bh_press_2 AS avg_bh_press_2,
          pwel_day_status.avg_annulus_press AS avg_annulus_press,
          pwel_day_status.annulus_press AS annulus_press,
          pwel_day_status.annulus_press_2 AS annulus_press_2,
          pwel_day_status.annulus_press_3 AS annulus_press_3,
          pwel_day_status.avg_bh_temp_2 AS avg_bh_temp_2,
          pwel_day_status.gl_hrs AS gl_hrs,
          pwel_day_status.gl_vol AS gl_vol,
          pwel_day_status.avg_gl_density_kgm3 AS avg_gl_density_kgm3,
          pwel_day_status.avg_gl_diff_press AS avg_gl_diff_press,
          pwel_day_status.avg_gl_mass AS avg_gl_mass,
          pwel_day_status.avg_gl_rate AS avg_gl_rate,
          pwel_day_status.avg_gl_temp AS avg_gl_temp,
          pwel_day_status.avg_gl_choke AS avg_gl_choke,
          pwel_day_status.avg_choke_size AS avg_choke_size,
          pwel_day_status.avg_2nd_choke_size AS avg_2nd_choke_size,
          pwel_day_status.avg_choke_line_press AS avg_choke_line_press,
          pwel_day_status.avg_choke_line_temp AS avg_choke_line_temp,
          pwel_day_status.avg_flow_line_press AS avg_flow_line_press,
          pwel_day_status.avg_flow_rate AS avg_flow_rate,
          pwel_day_status.avg_tubing_press AS avg_tubing_press,
          pwel_day_status.avg_wh_temp AS avg_wh_temp,
          pwel_day_status.avg_wh_press AS avg_wh_press,
          pwel_day_status.avg_wh_usc_press AS avg_wh_usc_press,
          pwel_day_status.avg_wh_usc_temp AS avg_wh_usc_temp,
          pwel_day_status.avg_wh_dsc_press AS avg_wh_dsc_press,
          pwel_day_status.avg_wh_dsc_temp AS avg_wh_dsc_temp,
          pwel_day_status.avg_oil_rate AS avg_oil_rate,
          pwel_day_status.avg_gas_rate AS avg_gas_rate,
          pwel_day_status.avg_cond_rate AS avg_cond_rate,
          pwel_day_status.avg_water_rate AS avg_water_rate,
          pwel_day_status.avg_oil_mass AS avg_oil_mass,
          pwel_day_status.avg_gas_mass AS avg_gas_mass,
          pwel_day_status.avg_cond_mass AS avg_cond_mass,
          pwel_day_status.avg_water_mass AS avg_water_mass,
          pwel_day_status.avg_sand_rate AS avg_sand_rate,
          pwel_day_status.max_sand_rate AS max_sand_rate,
          pwel_day_status.avg_erosion_rate AS avg_erosion_rate,
          pwel_day_status.usm_flare AS usm_flare,
          pwel_day_status.usm_vent AS usm_vent,
          pwel_day_status.usm_fuel AS usm_fuel,
          pwel_day_status.dsm_flare AS dsm_flare,
          pwel_day_status.dsm_vent AS dsm_vent,
          pwel_day_status.dsm_fuel AS dsm_fuel,
          pwel_day_status.corrosion_rate AS corrosion_rate,
          pwel_day_status.theor_gas_rate AS theor_gas_rate,
          pwel_day_status.theor_net_oil_rate AS theor_net_oil_rate,
          pwel_day_status.theor_cond_rate AS theor_cond_rate,
          pwel_day_status.theor_water_rate AS theor_water_rate,
          pwel_day_status.avg_diluent_rate AS avg_diluent_rate,
          pwel_day_status.intake_press AS intake_press,
          pwel_day_status.avg_dh_pump_power AS avg_dh_pump_power,
          pwel_day_status.avg_dh_pump_speed AS avg_dh_pump_speed,
          pwel_day_status.avg_liquid_rate_m3 AS avg_liquid_rate_m3,
          pwel_day_status.bs_w AS bs_w,
          pwel_day_status.vibration AS vibration,
          pwel_day_status.phase_voltage AS phase_voltage,
          pwel_day_status.phase_current AS phase_current,
          pwel_day_status.ac_frequency AS ac_frequency,
          pwel_day_status.current_unbalance AS current_unbalance,
          pwel_day_status.voltage_unbalance AS voltage_unbalance,
          pwel_day_status.leg_ground_monitor AS leg_ground_monitor,
          pwel_day_status.chem_inj_vol AS chem_inj_vol,
          pwel_day_status.orifice_diff_press AS orifice_diff_press,
          pwel_day_status.avg_diff_press AS avg_diff_press,
          pwel_day_status.avg_powerwater_rate AS avg_powerwater_rate,
          pwel_day_status.comments AS comments,
          pwel_day_status.record_status, pwel_day_status.created_by,
          pwel_day_status.created_date, pwel_day_status.last_updated_by,
          pwel_day_status.last_updated_date, pwel_day_status.rev_no,
          pwel_day_status.rev_text,
          pwel_day_status.value_1,
          pwel_day_status.value_2,
          pwel_day_status.value_3,
          pwel_day_status.value_4,
          pwel_day_status.value_5,
          pwel_day_status.value_6,
          pwel_day_status.value_7,
          pwel_day_status.value_8,
          pwel_day_status.value_9,
          pwel_day_status.value_10,
          pwel_day_status.value_11,
          pwel_day_status.value_12,
          pwel_day_status.value_13,
          pwel_day_status.value_14,
          pwel_day_status.value_15,
          pwel_day_status.value_16,
          pwel_day_status.value_17,
          pwel_day_status.value_18,
          pwel_day_status.value_19,
          pwel_day_status.value_20,
          pwel_day_status.value_21,
          pwel_day_status.value_22,
          pwel_day_status.value_23,
          pwel_day_status.value_24,
          pwel_day_status.value_25,
          pwel_day_status.value_26,
          pwel_day_status.value_27,
          pwel_day_status.value_28,
          pwel_day_status.value_29,
          pwel_day_status.value_30,
          pwel_day_status.text_1,
          pwel_day_status.text_2,
          pwel_day_status.text_3,
          pwel_day_status.text_4,
          pwel_day_status.text_5,
          pwel_day_status.text_6,
          pwel_day_status.text_7,
          pwel_day_status.text_8,
          pwel_day_status.text_9,
          pwel_day_status.text_10,
          pwel_day_status.text_11,
          pwel_day_status.text_12,
          pwel_day_status.text_13,
          pwel_day_status.text_14,
          pwel_day_status.text_15,
          pwel_day_status.approval_state AS approval_state,
          pwel_day_status.approval_by AS approval_by,
          pwel_day_status.approval_date AS approval_date,
          pwel_day_status.rec_id AS rec_id,
          pwel_day_status.avg_flow_mass AS avg_flow_mass,
          pwel_day_status.sub_day_theor_oil AS sub_day_theor_oil,
          pwel_day_status.sub_day_theor_gas AS sub_day_theor_gas,
          pwel_day_status.sub_day_theor_water AS sub_day_theor_water,
          pwel_day_status.sub_day_theor_cond AS sub_day_theor_cond,
          pwel_day_status.sub_day_theor_diluent AS sub_day_theor_diluent,
          pwel_day_status.sub_day_theor_gas_lift AS sub_day_theor_gas_lift,
          wb.well_id AS well_id, wb.object_id AS well_bore_id,
          wb.object_code AS well_bore_code,
          wbi.object_id AS well_bore_interval_id,
          wbi.object_code AS well_bore_interval_code,
          pi.object_id AS perf_interval_id,
          pi.object_code AS perf_interval_code,
          piv.resv_block_formation_id AS resv_block_formation_id-- Added this join cause 111 moved the resv_block_formation_id from perf_interval to perf_interval_version
     FROM system_days s,
          well_version oa,
          well o,
          webo_version wbv,
          pwel_day_status,
          webo_bore wb,
          webo_interval wbi,
          webo_interval_version wbiv,
          perf_interval pi,
          perf_interval_version piv
    WHERE s.daytime = pwel_day_status.daytime AND
    -- WELL
    pwel_day_status.object_id = o.object_id AND
    o.object_id = oa.object_id AND
      pwel_day_status.daytime >= oa.daytime AND
    (pwel_day_status.daytime < oa.end_date OR oa.end_date IS NULL) AND
-- WELL_BORE
    oa.object_id = wb.well_id AND
    wb.object_id = wbv.object_id AND
      pwel_day_status.daytime>= wbv.daytime AND
    (pwel_day_status.daytime < wbv.end_date OR WBV.end_date IS NULL) AND
-- WELL_BORE_INTERVAL
      wb.object_id = wbi.WELL_BORE_ID AND 
    wbi.object_id = wbiv.object_id AND 
      pwel_day_status.daytime >= wbiv.daytime AND
    (pwel_day_status.daytime < wbiv.end_date OR wbiv.end_date IS NULL) AND
-- PERF_INTERVAL
      wbi.object_id = pi.webo_interval_id AND 
    pi.object_id = piv.object_id AND 
      pwel_day_status.daytime >= piv.daytime AND
    (pwel_day_status.daytime < piv.end_date OR piv.end_date IS NULL) 
     ;