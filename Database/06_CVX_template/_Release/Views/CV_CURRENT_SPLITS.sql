CREATE OR REPLACE FORCE VIEW CV_CURRENT_SPLITS 
AS
   SELECT DISTINCT W1.OBJECT_ID AS OBJECT_ID,
                   WV1.GEO_FIELD_CODE AS FIELD_CODE,
                   W1.OBJECT_ID AS WELL_ID,
                   W1.OBJECT_CODE AS WELL_CODE,
                   WV1.NAME AS WELL_NAME,
                   WV1.TEXT_1 AS WELL_UID,
                   B1.OBJECT_ID AS WB_ID,
                   B1.OBJECT_CODE AS WB_CODE,
                   BV1.NAME AS WB_NAME,
                   BV1.TEXT_1 AS WB_UID,
                   BS1.DAYTIME AS WB_SPLIT_DAYTIME,
                   BS1.OIL_CONTRIB_PCT AS WB_SPLIT_OIL, 
                   BS1.GAS_CONTRIB_PCT AS WB_SPLIT_GAS,
                   BS1.COND_CONTRIB_PCT AS WB_SPLIT_COND,
                   BS1.WATER_CONTRIB_PCT AS WB_SPLIT_WATER, 
                   BS1.STEAM_CONTRIB_PCT AS WB_SPLIT_STEAM_INJ,
                   BS1.GAS_INJ_PCT AS WB_SPLIT_GAS_INJ,
                   BS1.WAT_INJ_PCT AS WB_SPLIT_WATER_INJ,
                   I1.OBJECT_ID AS WBI_ID,
                   I1.OBJECT_CODE AS WBI_CODE,
                   IV1.NAME AS WBI_NAME,
                   IV1.TEXT_1 AS WBI_UID,
                   IS1.DAYTIME AS WBI_SPLIT_DAYTIME,
                   IS1.OIL_PCT AS WBI_SPLIT_OIL, 
                   IS1.GAS_PCT AS WBI_SPLIT_GAS,
                   IS1.COND_PCT AS WBI_SPLIT_COND,
                   IS1.WATER_PCT AS WBI_SPLIT_WATER,
                   IS1.STEAM_PCT AS WBI_SPLIT_STEAM_INJ,
                   IS1.GAS_INJ_PCT AS WBI_SPLIT_GAS_INJ,
                   IS1.WAT_INJ_PCT AS WBI_SPLIT_WATER_INJ,
                   P1.OBJECT_ID AS PI_ID,
                   P1.OBJECT_CODE AS PI_CODE,
                   PV1.NAME AS PI_NAME,
                   PV1.TEXT_1 AS PI_UID,
                   PS1.DAYTIME AS PI_SPLIT_DAYTIME,
                   PS1.OIL_PCT AS PI_SPLIT_OIL, 
                   PS1.GAS_PCT AS PI_SPLIT_GAS,
                   PS1.COND_PCT AS PI_SPLIT_COND,
                   PS1.WATER_PCT AS PI_SPLIT_WATER,
                   PS1.STEAM_PCT AS PI_SPLIT_STEAM_INJ,
                   PS1.GAS_INJ_PCT AS PI_SPLIT_GAS_INJ,
                   PS1.WAT_INJ_PCT AS PI_SPLIT_WATER_INJ,
                   RES_ZONE.RESV_CODE AS RESV_CODE,
                   RES_ZONE.RESV_NAME AS RESV_NAME,
                   RES_ZONE.RESV_UID AS RESV_UID,
                   RES_ZONE.ZONE_CODE AS ZONE_CODE,
                   RES_ZONE.ZONE_NAME AS ZONE_NAME,
                   RES_ZONE.ZONE_UID AS ZONE_UID,
                   W1.RECORD_STATUS AS RECORD_STATUS,
                   W1.CREATED_BY AS CREATED_BY,
                   W1.CREATED_DATE AS CREATED_DATE,
                   W1.LAST_UPDATED_BY AS LAST_UPDATED_BY,
                   W1.LAST_UPDATED_DATE AS LAST_UPDATED_DATE,
                   W1.REV_NO AS REV_NO,
                   W1.REV_TEXT AS REV_TEXT
   FROM WELL W1, WELL_VERSION WV1,
        WEBO_BORE B1, WEBO_VERSION BV1,
        WEBO_SPLIT_FACTOR BS1,
        WEBO_INTERVAL I1, WEBO_INTERVAL_VERSION IV1,
        WEBO_INTERVAL_GOR IS1,
        PERF_INTERVAL P1, PERF_INTERVAL_VERSION PV1, 
        PERF_INTERVAL_GOR PS1,
        RESV_BLOCK_FORMATION RBF1, RBF_VERSION RBFV1,
        RESV_FORMATION R1, RESV_FORMATION_VERSION RV1,
        ( SELECT R2.OBJECT_ID, 
                 R2.OBJECT_CODE RESV_CODE,
                 RV2.NAME RESV_NAME, 
                 RV2.TEXT_1 RESV_UID, 
                 NULL ZONE_CODE, 
                 NULL ZONE_NAME, 
                 NULL ZONE_UID
          FROM RESV_FORMATION R2, RESV_FORMATION_VERSION RV2
          WHERE R2.RESV_FORMATION_ID IS NULL
          AND R2.OBJECT_ID = RV2.OBJECT_ID
          UNION
          SELECT R3.OBJECT_ID, 
                 R4.OBJECT_CODE RESV_CODE, 
                 RV4.NAME RESV_NAME, 
                 RV4.TEXT_1 RESV_UID,
                 R3.OBJECT_CODE ZONE_CODE, 
                 RV3.NAME ZONE_NAME, 
                 RV3.TEXT_1 ZONE_UID
          FROM RESV_FORMATION R3, RESV_FORMATION_VERSION RV3,
               RESV_FORMATION R4, RESV_FORMATION_VERSION RV4
          WHERE R3.RESV_FORMATION_ID IS NOT NULL
          AND R3.OBJECT_ID = RV3.OBJECT_ID
          AND R3.RESV_FORMATION_ID = R4.OBJECT_ID
          AND R4.OBJECT_ID = RV4.OBJECT_ID ) RES_ZONE
   WHERE W1.OBJECT_ID = WV1.OBJECT_ID
   AND WV1.END_DATE IS NULL
   AND W1.OBJECT_ID = B1.WELL_ID
   AND B1.OBJECT_ID = BV1.OBJECT_ID
   AND BV1.END_DATE IS NULL
   AND B1.OBJECT_ID = BS1.WELL_BORE_ID (+)
   AND BS1.END_DATE IS NULL
   AND B1.OBJECT_ID = I1.WELL_BORE_ID
   AND I1.OBJECT_ID = IV1.OBJECT_ID
   AND IV1.END_DATE IS NULL
   AND I1.OBJECT_ID = IS1.OBJECT_ID (+)
   AND IS1.END_DATE IS NULL
   AND I1.OBJECT_ID = P1.WEBO_INTERVAL_ID
   AND P1.OBJECT_ID = PV1.OBJECT_ID
   AND PV1.END_DATE IS NULL
   AND P1.OBJECT_ID = PS1.OBJECT_ID (+)
   AND PS1.END_DATE IS NULL
   AND PV1.RESV_BLOCK_FORMATION_ID = RBF1.OBJECT_ID -- Added this join cause 111 moved the resv_block_formation_id from perf_interval to perf_interval_version
   AND RBF1.OBJECT_ID = RBFV1.OBJECT_ID
   AND RBFV1.END_DATE IS NULL
   AND RBF1.RESV_FORMATION_ID = R1.OBJECT_ID
   AND R1.OBJECT_ID = RV1.OBJECT_ID
   AND RV1.END_DATE IS NULL
   AND R1.OBJECT_CODE NOT LIKE '%NON-WF%'
   AND R1.OBJECT_ID = RES_ZONE.OBJECT_ID;