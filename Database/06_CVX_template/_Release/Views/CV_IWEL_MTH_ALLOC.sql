CREATE OR REPLACE FORCE VIEW CV_IWEL_MTH_ALLOC
(
   OBJECT_ID,
   PRODUCTION_MTH,
   CODE,
   NAME,
   OBJECT_START_DATE,
   OBJECT_END_DATE,
   NODE_CLASS_NAME,
   SND_LABEL,
   DESCRIPTION,
   WELL_UID,
   TOP_DEPTH,
   WELL_CLASS,
   WELL_TYPE,
   PROD_METHOD,
   PUMP_TYPE,
   WELL_METER_FREQ,
   INSTRUMENTATION_TYPE,
   DAY_METHOD_LABEL,
   GAS_LIFT_METHOD,
   DILUENT_METHOD,
   PT_RESDATA_CLASS,
   CALC_METHOD,
   CALC_METHOD_MASS,
   CALC_INJ_METHOD,
   CALC_WATER_INJ_METHOD,
   CALC_STEAM_INJ_METHOD,
   GI_EVENT_INJ_DATA_METHOD,
   WI_EVENT_INJ_DATA_METHOD,
   SI_EVENT_INJ_DATA_METHOD,
   POTENTIAL_METHOD,
   POTENTIAL_MASS_METHOD,
   POTENTIAL_GAS_INJ_METHOD,
   POT_WATER_INJ_METHOD,
   POT_STEAM_INJ_METHOD,
   ON_STREAM_METHOD,
   BSW_VOL_METHOD,
   GOR_METHOD,
   CGR_METHOD,
   WGR_METHOD,
   SAND_METHOD,
   WDF_METHOD,
   SUB_DAY_METHOD_LABEL,
   CALC_SUB_DAY_METHOD,
   GAS_LIFT_SUB_DAY_METHOD,
   DILUENT_SUB_DAY_METHOD,
   OTHER_CONF_OPTS_LABEL,
   WELL_TEST_METHOD,
   APPROACH_METHOD,
   CALC_RULE_CODE,
   WELL_CALC_RULE,
   ALLOC_FIXED_GOR,
   ALLOC_FIXED_WC,
   CALC_RULE_ID,
   CALC_SEQ_NO,
   ALLOC_FLAG,
   CAN_PROC_OIL,
   CAN_PROC_GAS,
   CAN_PROC_WAT,
   CAN_PROC_GASLIFT,
   CAN_PROC_GASINJ,
   CAN_PROC_WATINJ,
   CAN_PROC_STEAMINJ,
   CAN_PROC_COND,
   CAN_PROC_DILUENT,
   DIAGRAM_LAYOUT_INFO,
--   POTEN_2ND_VALUE,
--   POTEN_3RD_VALUE,
   CHOKE_UOM,
   STD_OIL_DENSITY_METHOD,
   STD_GAS_DENSITY_METHOD,
   STD_WAT_DENSITY_METHOD,
   OP_NODE_ID,
   GP_NODE_ID,
   WP_NODE_ID,
   CP_NODE_ID,
   GL_NODE_ID,
   DL_NODE_ID,
   GI_NODE_ID,
   WI_NODE_ID,
   SI_NODE_ID,
   ACTIVE_PRODUCTION_DAY,
   WELL_REFERENCE_OBJECT,
   FORECAST_TYPE,
   FORECAST_SCENARIO,
   FLUID_QUALITY,
   ISPRODUCER,
   ISPRODUCEROROTHER,
   ISINJECTOR,
   ISOTHER,
   ISNOTOTHER,
   ISOILPRODUCER,
   ISGASPRODUCER,
   ISCONDENSATEPRODUCER,
   ISWATERPRODUCER,
   ISGASINJECTOR,
   ISWATERINJECTOR,
   ISAIRINJECTOR,
   ISSTEAMINJECTOR,
   ISWASTEINJECTOR,
   GL_CONTROL_DEVICE,
   GL_CHOKE_UOM,
   GATHERING_POINT,
   DEVELOPMENT_AREA,
   CALC_DC_SEQ_NO,
   CALC_RULE_DC_ID,
   OP_IND,
   GP_IND,
   WP_IND,
   CP_IND,
   GL_IND,
   DL_IND,
   WI_IND,
   GI_IND,
   SI_IND,
   GEO_COUNTRY_CODE,
   GEO_COUNTRY_ID,
   GEO_REGION_CODE,
   GEO_REGION_ID,
   GEO_LICENCE_CODE,
   GEO_LICENCE_ID,
   CHOKE_ID,
   CHOKE_CODE,
   GL_CHOKE_ID,
   GL_CHOKE_CODE,
   GEO_FIELD_CODE,
   GEO_FIELD_ID,
   WELL_HOLE_ID,
   WELL_HOLE_CODE,
   COMMERCIAL_ENTITY_ID,
   COMMERCIAL_ENTITY_CODE,
   PROCESS_TRAIN_ID,
   PROCESS_TRAIN_CODE,
   TEST_DEVICE_ID,
   TEST_DEVICE_CODE,
   OP_PRODUCTIONUNIT_CODE,
   OP_PRODUCTIONUNIT_ID,
   OP_PROD_SUB_UNIT_CODE,
   OP_PROD_SUB_UNIT_ID,
   OP_AREA_CODE,
   OP_AREA_ID,
   OP_SUB_AREA_CODE,
   OP_SUB_AREA_ID,
   OP_FCTY_2_CODE,
   OP_FCTY_2_ID,
   OP_FCTY_1_CODE,
   OP_FCTY_1_ID,
   DAYTIME,   
   INJ_TYPE,
   GAS_INJ_DAYS,
   WATER_INJ_DAYS,
   STEAM_INJ_DAYS,
   GAS_OPERATING_DAYS,
   WATER_OPERATING_DAYS,
   STEAM_OPERATING_DAYS,
   ON_STREAM_HRS,
   ALLOC_GAS_INJ_VOL,
   ALLOC_GAS_INJ_VOL_TTD,
   ALLOC_GAS_INJ_VOL_YTD,
   ALLOC_GAS_INJ_MASS,
   ALLOC_GAS_INJ_MASS_TTD,
   ALLOC_GAS_INJ_MASS_YTD,
   ALLOC_WATER_INJ_VOL,
   ALLOC_WATER_INJ_VOL_TTD,
   ALLOC_WATER_INJ_VOL_YTD,
   ALLOC_WATER_INJ_MASS,
   ALLOC_WATER_INJ_MASS_TTD,
   ALLOC_WATER_INJ_MASS_YTD,
   ALLOC_STEAM_INJ_VOL,
   ALLOC_STEAM_INJ_VOL_TTD,
   ALLOC_STEAM_INJ_VOL_YTD,
   ALLOC_STEAM_INJ_MASS,
   ALLOC_STEAM_INJ_MASS_TTD,
   ALLOC_STEAM_INJ_MASS_YTD,
   GAS_INJ_RATE,
   WATER_INJ_RATE,
   STEAM_INJ_RATE,
   THEOR_GAS_INJ_VOL,
   THEOR_WATER_INJ_VOL,
   THEOR_STEAM_INJ_VOL,
   GAS_MASS_FACTOR,
   WATER_MASS_FACTOR,
   GAS_VOL_FACTOR,
   WATER_VOL_FACTOR,
   COMMENTS,
   RECORD_STATUS,
   CREATED_BY,
   CREATED_DATE,
   LAST_UPDATED_BY,
   LAST_UPDATED_DATE,
   REV_NO,
   REV_TEXT,
   APPROVAL_STATE,
   APPROVAL_BY,
   APPROVAL_DATE,
   REC_ID
)
AS
   SELECT                                    
          iwel_mth_alloc.OBJECT_ID AS OBJECT_ID,
          iwel_mth_alloc.DAYTIME AS PRODUCTION_MTH,
          o.object_code AS CODE,
          oa.name AS NAME,
          o.start_date AS OBJECT_START_DATE,
          o.end_date AS OBJECT_END_DATE,
          TO_CHAR ('WELL') AS NODE_CLASS_NAME,
          NVL (
             Ue_Stream_Node_Diagram.label (o.OBJECT_ID, oa.DAYTIME, 'WELL'),
             o.OBJECT_CODE)
             AS SND_LABEL,
          o.description AS DESCRIPTION,
          oa.text_1 AS WELL_UID,
          oa.value_1 AS TOP_DEPTH,
          oa.well_class AS WELL_CLASS,
          oa.well_type AS WELL_TYPE,
          oa.prod_method AS PROD_METHOD,
          oa.pump_type AS PUMP_TYPE,
          oa.well_meter_freq AS WELL_METER_FREQ,
          oa.instrumentation_type AS INSTRUMENTATION_TYPE,
          NULL AS DAY_METHOD_LABEL,
          oa.gas_lift_method AS GAS_LIFT_METHOD,
          oa.diluent_method AS DILUENT_METHOD,
          ecdp_performance_test.
          getResultDataClassName (o.object_id, oa.daytime)
             AS PT_RESDATA_CLASS,
          oa.calc_method AS CALC_METHOD,
          oa.calc_method_mass AS CALC_METHOD_MASS,
          oa.calc_inj_method AS CALC_INJ_METHOD,
          oa.calc_water_inj_method AS CALC_WATER_INJ_METHOD,
          oa.calc_steam_inj_method AS CALC_STEAM_INJ_METHOD,
          oa.gi_event_inj_data_method AS GI_EVENT_INJ_DATA_METHOD,
          oa.wi_event_inj_data_method AS WI_EVENT_INJ_DATA_METHOD,
          oa.si_event_inj_data_method AS SI_EVENT_INJ_DATA_METHOD,
          oa.potential_method AS POTENTIAL_METHOD,
          oa.potential_mass_method AS POTENTIAL_MASS_METHOD,
          oa.potential_gas_inj_method AS POTENTIAL_GAS_INJ_METHOD,
          oa.pot_water_inj_method AS POT_WATER_INJ_METHOD,
          oa.pot_steam_inj_method AS POT_STEAM_INJ_METHOD,
          oa.on_strm_method AS ON_STREAM_METHOD,
          oa.bsw_vol_method AS BSW_VOL_METHOD,
          oa.gor_method AS GOR_METHOD,
          oa.cgr_method AS CGR_METHOD,
          oa.wgr_method AS WGR_METHOD,
          oa.sand_method AS SAND_METHOD,
          oa.wdf_method AS WDF_METHOD,
          NULL AS SUB_DAY_METHOD_LABEL,
          oa.calc_sub_day_method AS CALC_SUB_DAY_METHOD,
          oa.gas_lift_sub_day_method AS GAS_LIFT_SUB_DAY_METHOD,
          oa.diluent_sub_day_method AS DILUENT_SUB_DAY_METHOD,
          NULL AS OTHER_CONF_OPTS_LABEL,
          oa.well_test_method AS WELL_TEST_METHOD,
          oa.approach_method AS APPROACH_METHOD,
          NVL (
             ec_calc_rule_version.name (oa.WELL_CALC_RULE, oa.DAYTIME, '<='),
             ec_ctrl_system_attribute.
             attribute_text (oa.daytime, 'DEF_WELL_CALC_RULE', '<='))
             AS CALC_RULE_CODE,
          oa.well_calc_rule AS WELL_CALC_RULE,
          oa.alloc_fixed_gor AS ALLOC_FIXED_GOR,
          oa.alloc_fixed_wc AS ALLOC_FIXED_WC,
          NVL (
             WELL_CALC_RULE,
             ecdp_objects.
             GetObjIDFromCode (
                'CALC_RULE',
                ec_ctrl_system_attribute.
                attribute_text (oa.daytime, 'DEF_WELL_CALC_RULE', '<=')))
             AS CALC_RULE_ID,
          100 AS CALC_SEQ_NO,
          oa.alloc_flag AS ALLOC_FLAG,
          TO_CHAR ('N') AS CAN_PROC_OIL,
          TO_CHAR ('N') AS CAN_PROC_GAS,
          TO_CHAR ('N') AS CAN_PROC_WAT,
          TO_CHAR ('N') AS CAN_PROC_GASLIFT,
          TO_CHAR ('N') AS CAN_PROC_GASINJ,
          TO_CHAR ('N') AS CAN_PROC_WATINJ,
          TO_CHAR ('N') AS CAN_PROC_STEAMINJ,
          TO_CHAR ('N') AS CAN_PROC_COND,
          TO_CHAR ('N') AS CAN_PROC_DILUENT,
          oa.diagram_layout_info AS DIAGRAM_LAYOUT_INFO,
--          oa.poten_2nd_value AS POTEN_2ND_VALUE,
--          oa.poten_3rd_value AS POTEN_3RD_VALUE,
          oa.choke_uom AS CHOKE_UOM,
          oa.std_oil_density_method AS STD_OIL_DENSITY_METHOD,
          oa.std_gas_density_method AS STD_GAS_DENSITY_METHOD,
          oa.std_wat_density_method AS STD_WAT_DENSITY_METHOD,
          PROC_NODE_OIL_ID AS OP_NODE_ID,
          PROC_NODE_GAS_ID AS GP_NODE_ID,
          PROC_NODE_WATER_ID AS WP_NODE_ID,
          PROC_NODE_COND_ID AS CP_NODE_ID,
          PROC_NODE_GAS_LIFT_ID AS GL_NODE_ID,
          PROC_NODE_DILUENT_ID AS DL_NODE_ID,
          PROC_NODE_GAS_INJ_ID AS GI_NODE_ID,
          PROC_NODE_WATER_INJ_ID AS WI_NODE_ID,
          PROC_NODE_STEAM_INJ_ID AS SI_NODE_ID,
          ecdp_productionday.
          findProductionDayDefinition ('WELL', o.object_id, oa.daytime)
             AS ACTIVE_PRODUCTION_DAY,
          oa.well_reference_obj_id AS WELL_REFERENCE_OBJECT,
          oa.forecast_type AS FORECAST_TYPE,
          oa.forecast_scenario AS FORECAST_SCENARIO,
          oa.fluid_quality AS FLUID_QUALITY,
          oa.isproducer AS ISPRODUCER,
          oa.isproducerorother AS ISPRODUCEROROTHER,
          oa.isinjector AS ISINJECTOR,
          oa.isother AS ISOTHER,
          oa.isnotother AS ISNOTOTHER,
          oa.isoilproducer AS ISOILPRODUCER,
          oa.isgasproducer AS ISGASPRODUCER,
          oa.iscondensateproducer AS ISCONDENSATEPRODUCER,
          oa.iswaterproducer AS ISWATERPRODUCER,
          oa.isgasinjector AS ISGASINJECTOR,
          oa.iswaterinjector AS ISWATERINJECTOR,
          oa.isairinjector AS ISAIRINJECTOR,
          oa.issteaminjector AS ISSTEAMINJECTOR,
          oa.iswasteinjector AS ISWASTEINJECTOR,
          oa.text_7 AS GL_CONTROL_DEVICE,
          oa.text_5 AS GL_CHOKE_UOM,
          oa.text_6 AS GATHERING_POINT,
          oa.text_8 AS DEVELOPMENT_AREA,
          100 AS CALC_DC_SEQ_NO,
          EcDp_Objects.GetObjIDFromCode ('CALC_RULE', 'EC_DEFER_01')
             AS CALC_RULE_DC_ID,
          NVL2 (PROC_NODE_OIL_ID, 'Y', 'N') AS OP_IND,
          NVL2 (PROC_NODE_GAS_ID, 'Y', 'N') AS GP_IND,
          NVL2 (PROC_NODE_WATER_ID, 'Y', 'N') AS WP_IND,
          NVL2 (PROC_NODE_COND_ID, 'Y', 'N') AS CP_IND,
          NVL2 (PROC_NODE_GAS_LIFT_ID, 'Y', 'N') AS GL_IND,
          NVL2 (PROC_NODE_DILUENT_ID, 'Y', 'N') AS DL_IND,
          NVL2 (PROC_NODE_WATER_INJ_ID, 'Y', 'N') AS WI_IND,
          NVL2 (PROC_NODE_GAS_INJ_ID, 'Y', 'N') AS GI_IND,
          NVL2 (PROC_NODE_STEAM_INJ_ID, 'Y', 'N') AS SI_IND,
          oa.group_ref_code_1 AS GEO_COUNTRY_CODE,
          oa.group_ref_id_1 AS GEO_COUNTRY_ID,
          oa.group_ref_code_2 AS GEO_REGION_CODE,
          oa.group_ref_id_2 AS GEO_REGION_ID,
          oa.group_ref_code_6 AS GEO_LICENCE_CODE,
          oa.group_ref_id_6 AS GEO_LICENCE_ID,
          oa.choke_id AS CHOKE_ID,
          EC_CHOKE.object_code (oa.CHOKE_ID) AS CHOKE_CODE,
          oa.gl_choke_id AS GL_CHOKE_ID,
          EC_CHOKE.object_code (oa.GL_CHOKE_ID) AS GL_CHOKE_CODE,
          oa.geo_field_code AS GEO_FIELD_CODE,
          oa.geo_field_id AS GEO_FIELD_ID,
          o.well_hole_id AS WELL_HOLE_ID,
          EC_WELL_HOLE.object_code (o.WELL_HOLE_ID) AS WELL_HOLE_CODE,
          oa.commercial_entity_id AS COMMERCIAL_ENTITY_ID,
          EC_COMMERCIAL_ENTITY.object_code (oa.COMMERCIAL_ENTITY_ID)
             AS COMMERCIAL_ENTITY_CODE,
          oa.process_train_id AS PROCESS_TRAIN_ID,
          EC_PROCESS_TRAIN.object_code (oa.PROCESS_TRAIN_ID)
             AS PROCESS_TRAIN_CODE,
          oa.test_device_id AS TEST_DEVICE_ID,
          EC_EQUIPMENT.object_code (oa.TEST_DEVICE_ID) AS TEST_DEVICE_CODE,
          oa.op_pu_code AS OP_PRODUCTIONUNIT_CODE,
          oa.op_pu_id AS OP_PRODUCTIONUNIT_ID,
          oa.op_sub_pu_code AS OP_PROD_SUB_UNIT_CODE,
          oa.op_sub_pu_id AS OP_PROD_SUB_UNIT_ID,
          oa.op_area_code AS OP_AREA_CODE,
          oa.op_area_id AS OP_AREA_ID,
          oa.op_sub_area_code AS OP_SUB_AREA_CODE,
          oa.op_sub_area_id AS OP_SUB_AREA_ID,
          oa.op_fcty_class_2_code AS OP_FCTY_2_CODE,
          oa.op_fcty_class_2_id AS OP_FCTY_2_ID,
          oa.op_fcty_class_1_code AS OP_FCTY_1_CODE,
          oa.op_fcty_class_1_id AS OP_FCTY_1_ID,
          iwel_mth_alloc.DAYTIME AS DAYTIME,          
          iwel_mth_alloc.INJ_TYPE AS INJ_TYPE,
          DECODE(INJ_TYPE,'GI',INJ_DAYS,NULL) AS GAS_INJ_DAYS,
          DECODE(INJ_TYPE,'WI',INJ_DAYS,NULL) AS WATER_INJ_DAYS,
          DECODE(INJ_TYPE,'SI',INJ_DAYS,NULL) AS STEAM_INJ_DAYS,
          DECODE(INJ_TYPE,'GI',IWEL_MTH_ALLOC.VALUE_1,NULL) AS GAS_OPERATING_DAYS,
          DECODE(INJ_TYPE,'WI',IWEL_MTH_ALLOC.VALUE_1,NULL) AS WATER_OPERATING_DAYS,
          DECODE(INJ_TYPE,'SI',IWEL_MTH_ALLOC.VALUE_1,NULL) AS STEAM_OPERATING_DAYS,
          iwel_mth_alloc.ON_STREAM_HRS AS ON_STREAM_HRS,
          DECODE(INJ_TYPE,'GI',ALLOC_INJ_VOL,NULL) AS ALLOC_GAS_INJ_VOL,
          ec_iwel_mth_alloc.math_alloc_inj_vol(iwel_mth_alloc.object_id,'GI',NULL,iwel_mth_alloc.daytime,'SUM') AS ALLOC_GAS_INJ_VOL_TTD,
          ec_iwel_mth_alloc.math_alloc_inj_vol(iwel_mth_alloc.object_id,'GI',TRUNC(iwel_mth_alloc.daytime,'YEAR'),iwel_mth_alloc.daytime,'SUM') AS ALLOC_GAS_INJ_VOL_YTD,
          DECODE(INJ_TYPE,'GI',ALLOC_INJ_MASS,NULL) AS ALLOC_GAS_INJ_MASS,
          ec_iwel_mth_alloc.math_alloc_inj_mass(iwel_mth_alloc.object_id,'GI',NULL,iwel_mth_alloc.daytime,'SUM') AS ALLOC_GAS_INJ_MASS_TTD,
          ec_iwel_mth_alloc.math_alloc_inj_mass(iwel_mth_alloc.object_id,'GI',TRUNC(iwel_mth_alloc.daytime,'YEAR'),iwel_mth_alloc.daytime,'SUM') AS ALLOC_GAS_INJ_MASS_YTD,
          DECODE(INJ_TYPE,'WI',ALLOC_INJ_VOL,NULL) AS ALLOC_WATER_INJ_VOL,
          ec_iwel_mth_alloc.math_alloc_inj_vol(iwel_mth_alloc.object_id,'WI',NULL,iwel_mth_alloc.daytime,'SUM') AS ALLOC_WATER_INJ_VOL_TTD,
          ec_iwel_mth_alloc.math_alloc_inj_vol(iwel_mth_alloc.object_id,'WI',TRUNC(iwel_mth_alloc.daytime,'YEAR'),iwel_mth_alloc.daytime,'SUM') AS ALLOC_WATER_INJ_VOL_YTD,
          DECODE(INJ_TYPE,'WI',ALLOC_INJ_MASS,NULL) AS ALLOC_WATER_INJ_MASS,
          ec_iwel_mth_alloc.math_alloc_inj_mass(iwel_mth_alloc.object_id,'WI',NULL,iwel_mth_alloc.daytime,'SUM') AS ALLOC_WATER_INJ_MASS_TTD,
          ec_iwel_mth_alloc.math_alloc_inj_mass(iwel_mth_alloc.object_id,'WI',TRUNC(iwel_mth_alloc.daytime,'YEAR'),iwel_mth_alloc.daytime,'SUM') AS ALLOC_WATER_INJ_MASS_YTD,
          DECODE(INJ_TYPE,'SI',ALLOC_INJ_VOL,NULL) AS ALLOC_STEAM_INJ_VOL,
          ec_iwel_mth_alloc.math_alloc_inj_vol(iwel_mth_alloc.object_id,'SI',NULL,iwel_mth_alloc.daytime,'SUM') AS ALLOC_STEAM_INJ_VOL_TTD,
          ec_iwel_mth_alloc.math_alloc_inj_vol(iwel_mth_alloc.object_id,'SI',TRUNC(iwel_mth_alloc.daytime,'YEAR'),iwel_mth_alloc.daytime,'SUM') AS ALLOC_STEAM_INJ_VOL_YTD,
          DECODE(INJ_TYPE,'SI',ALLOC_INJ_MASS,NULL) AS ALLOC_STEAM_INJ_MASS,
          ec_iwel_mth_alloc.math_alloc_inj_mass(iwel_mth_alloc.object_id,'SI',NULL,iwel_mth_alloc.daytime,'SUM') AS ALLOC_STEAM_INJ_MASS_TTD,
          ec_iwel_mth_alloc.math_alloc_inj_mass(iwel_mth_alloc.object_id,'SI',TRUNC(iwel_mth_alloc.daytime,'YEAR'),iwel_mth_alloc.daytime,'SUM') AS ALLOC_STEAM_INJ_MASS_YTD,
          DECODE(INJ_DAYS,0,0,DECODE(INJ_TYPE,'GI',ALLOC_INJ_VOL/INJ_DAYS,NULL)) AS GAS_INJ_RATE,
          DECODE(INJ_DAYS,0,0,DECODE(INJ_TYPE,'WI',ALLOC_INJ_VOL/INJ_DAYS,NULL)) AS WATER_INJ_RATE,
          DECODE(INJ_DAYS,0,0,DECODE(INJ_TYPE,'SI',ALLOC_INJ_VOL/INJ_DAYS,NULL)) AS STEAM_INJ_RATE,
          DECODE(INJ_TYPE,'GI',THEOR_INJ_VOL,NULL) AS THEOR_GAS_INJ_VOL,
          DECODE(INJ_TYPE,'WI',THEOR_INJ_VOL,NULL) AS THERO_WATER_INJ_VOL,
          DECODE(INJ_TYPE,'SI',THEOR_INJ_VOL,NULL) AS THEOR_STEAM_INJ_VOL,
          DECODE (inj_type,'GI',mass_factor,NULL) AS GAS_MASS_FACTOR,
          DECODE (inj_type,'WI',mass_factor,NULL) AS WATER_MASS_FACTOR,
          DECODE (inj_type,'GI',vol_factor,NULL) AS GAS_VOL_FACTOR,
          DECODE (inj_type,'WI',vol_factor,NULL) AS WATER_VOL_FACTOR,
          iwel_mth_alloc.COMMENTS AS COMMENTS,
          iwel_mth_alloc.RECORD_STATUS,
          iwel_mth_alloc.CREATED_BY,
          iwel_mth_alloc.CREATED_DATE,
          iwel_mth_alloc.LAST_UPDATED_BY,
          iwel_mth_alloc.LAST_UPDATED_DATE,
          iwel_mth_alloc.REV_NO,
          iwel_mth_alloc.REV_TEXT,
          iwel_mth_alloc.APPROVAL_STATE AS APPROVAL_STATE,
          iwel_mth_alloc.APPROVAL_BY AS APPROVAL_BY,
          iwel_mth_alloc.APPROVAL_DATE AS APPROVAL_DATE,
          iwel_mth_alloc.REC_ID AS REC_ID
     FROM WELL_VERSION oa, WELL o, iwel_mth_alloc
    WHERE     oa.object_id = iwel_mth_alloc.object_id
          AND iwel_mth_alloc.object_id = o.object_id
          AND iwel_mth_alloc.daytime >= TRUNC (oa.daytime, 'MONTH')
          AND oa.daytime =
                 (SELECT MIN (daytime)
                    FROM WELL_VERSION oa2
                   WHERE oa2.object_id = oa.object_id
                         AND oa2.well_class = 'I'
                         AND iwel_mth_alloc.DAYTIME >=
                                TRUNC (oa2.daytime, 'MONTH')
                         AND iwel_mth_alloc.DAYTIME <
                                NVL (oa2.end_date,
                                     TO_DATE ('01.01.2200', 'dd.mm.yyyy')));
