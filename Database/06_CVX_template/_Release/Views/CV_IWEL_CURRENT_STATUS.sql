CREATE OR REPLACE FORCE VIEW CV_IWEL_CURRENT_STATUS
(OWNER_CLASS_NAME, DATA_CLASS_NAME, OBJECT_ID, CODE, NAME,
 OBJECT_START_DATE, OBJECT_END_DATE, PRODUCTION_DAY, DAYTIME, NODE_CLASS_NAME,
 WELL_CLASS, WELL_TYPE, PROD_METHOD, CALC_METHOD, POTENTIAL_METHOD,
 WELL_TEST_METHOD, DESCRIPTION, ALLOC_FIXED_GOR, ALLOC_FIXED_WC, TOP_DEPTH,
 ALLOC_FLAG, CAN_PROC_OIL, WELL_UID, CAN_PROC_GAS, CAN_PROC_WAT,
 CAN_PROC_GASLIFT, CAN_PROC_GASINJ, CAN_PROC_WATINJ, DIAGRAM_LAYOUT_INFO, CHOKE_UOM,
 STD_OIL_DENSITY_METHOD, STD_GAS_DENSITY_METHOD, WELL_HOLE_ID, WELL_HOLE_CODE, OP_AREA_ID,
 OP_AREA_CODE, OP_SUB_AREA_ID, OP_SUB_AREA_CODE, OP_FCTY_1_ID, OP_FCTY_1_CODE,
 OP_FCTY_2_ID, OP_FCTY_2_CODE, GEO_COUNTRY_ID, GEO_COUNTRY_CODE, GEO_REGION_ID,
 GEO_REGION_CODE, GEO_LICENCE_ID, GEO_LICENCE_CODE, GEO_FIELD_ID, GEO_FIELD_CODE,
 WELL_STATUS, COMMENTS, TIME_SPAN, SUMMER_TIME, ACTIVE_STATUS,
 RECORD_STATUS, CREATED_BY, CREATED_DATE, LAST_UPDATED_BY, LAST_UPDATED_DATE,
 REV_NO, REV_TEXT)
BEQUEATH DEFINER
AS
SELECT OV.CLASS_NAME AS OWNER_CLASS_NAME,
       DV.CLASS_NAME AS DATA_CLASS_NAME,
       OV.OBJECT_ID AS OBJECT_ID,
       OV.CODE AS CODE,
       OV.NAME AS NAME,
       OV.OBJECT_START_DATE AS OBJECT_START_DATE,
       OV.OBJECT_END_DATE AS OBJECT_END_DATE,
       S.DAYTIME AS PRODUCTION_DAY,
       DV.DAYTIME AS DAYTIME,
       OV.NODE_CLASS_NAME AS NODE_CLASS_NAME,
       OV.WELL_CLASS AS WELL_CLASS,
       OV.WELL_TYPE AS WELL_TYPE,
       OV.PROD_METHOD AS PROD_METHOD,
       OV.CALC_METHOD AS CALC_METHOD,
       OV.POTENTIAL_METHOD AS POTENTIAL_METHOD,
       OV.WELL_TEST_METHOD AS WELL_TEST_METHOD,
       OV.DESCRIPTION AS DESCRIPTION,
       OV.ALLOC_FIXED_GOR AS ALLOC_FIXED_GOR,
       OV.ALLOC_FIXED_WC AS ALLOC_FIXED_WC,
       OV.TOP_DEPTH AS TOP_DEPTH,
       OV.ALLOC_FLAG AS ALLOC_FLAG,
       OV.CAN_PROC_OIL AS CAN_PROC_OIL,
       OV.WELL_UID AS WELL_UID,
       OV.CAN_PROC_GAS AS CAN_PROC_GAS,
       OV.CAN_PROC_WAT AS CAN_PROC_WAT,
       OV.CAN_PROC_GASLIFT AS CAN_PROC_GASLIFT,
       OV.CAN_PROC_GASINJ AS CAN_PROC_GASINJ,
       OV.CAN_PROC_WATINJ AS CAN_PROC_WATINJ,
       OV.DIAGRAM_LAYOUT_INFO AS DIAGRAM_LAYOUT_INFO,
       OV.CHOKE_UOM AS CHOKE_UOM,
       OV.STD_OIL_DENSITY_METHOD AS STD_OIL_DENSITY_METHOD,
       OV.STD_GAS_DENSITY_METHOD AS STD_GAS_DENSITY_METHOD,
       OV.WELL_HOLE_ID AS WELL_HOLE_ID,
       OV.WELL_HOLE_CODE AS WELL_HOLE_CODE,
       OV.OP_AREA_ID AS OP_AREA_ID,
       OV.OP_AREA_CODE AS OP_AREA_CODE,
       OV.OP_SUB_AREA_ID AS OP_SUB_AREA_ID,
       OV.OP_SUB_AREA_CODE AS OP_SUB_AREA_CODE,
       OV.OP_FCTY_1_ID AS OP_FCTY_1_ID,
       OV.OP_FCTY_1_CODE AS OP_FCTY_1_CODE,
       OV.OP_FCTY_2_ID AS OP_FCTY_2_ID,
       OV.OP_FCTY_2_CODE AS OP_FCTY_2_CODE,
       OV.GEO_COUNTRY_ID AS GEO_COUNTRY_ID,
       OV.GEO_COUNTRY_CODE AS GEO_COUNTRY_CODE,
       OV.GEO_REGION_ID AS GEO_REGION_ID,
       OV.GEO_REGION_CODE AS GEO_REGION_CODE,
       OV.GEO_LICENCE_ID AS GEO_LICENCE_ID,
       OV.GEO_LICENCE_CODE AS GEO_LICENCE_CODE,
       OV.GEO_FIELD_ID AS GEO_FIELD_ID,
       OV.GEO_FIELD_CODE AS GEO_FIELD_CODE,
       DV.WELL_STATUS AS WELL_STATUS,
       DV.COMMENTS AS COMMENTS,
       DV.TIME_SPAN AS TIME_SPAN,
       DV.SUMMER_TIME AS SUMMER_TIME,
       DV.ACTIVE_STATUS AS ACTIVE_STATUS,
       DV.RECORD_STATUS AS RECORD_STATUS,
       DV.CREATED_BY AS CREATED_BY,
       DV.CREATED_DATE AS CREATED_DATE,
       DV.LAST_UPDATED_BY AS LAST_UPDATED_BY,
       DV.LAST_UPDATED_DATE AS LAST_UPDATED_DATE,
       DV.REV_NO AS REV_NO,
       DV.REV_TEXT AS REV_TEXT
  FROM OV_WELL OV, SYSTEM_DAYS S, DV_IWEL_PERIOD_STATUS DV
 WHERE     S.DAYTIME >= OV.DAYTIME
       AND (S.DAYTIME < OV.END_DATE OR OV.END_DATE IS NULL)
       AND (S.DAYTIME < OV.OBJECT_END_DATE OR OV.OBJECT_END_DATE IS NULL)
       AND OV.OBJECT_ID = DV.OBJECT_ID
       AND DV.PRODUCTION_DAY = TRUNC (EC_IWEL_PERIOD_STATUS.PREV_EQUAL_DAYTIME (
                                         OV.OBJECT_ID,
                                         S.DAYTIME,
                                         DV.INJ_TYPE,
                                         'EVENT'),
                                      'DD');

