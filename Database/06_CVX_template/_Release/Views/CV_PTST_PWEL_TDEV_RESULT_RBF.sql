CREATE OR REPLACE FORCE VIEW cv_ptst_pwel_tdev_result_rbf AS
SELECT s.daytime AS daytime, s.daytime AS production_day,
          o.object_code AS code, oa.NAME AS NAME,
          o.start_date AS object_start_date, o.end_date AS object_end_date,
          NVL (ue_stream_node_diagram.label (o.object_id, oa.daytime, 'WELL'),
               o.object_code
              ) AS snd_label,
          o.description AS description, oa.text_1 AS well_uid,
          oa.value_1 AS top_depth, oa.well_class AS well_class,
          oa.well_type AS well_type, oa.prod_method AS prod_method,
          oa.pump_type AS pump_type, oa.well_meter_freq AS well_meter_freq,
          oa.instrumentation_type AS instrumentation_type,
          NULL AS day_method_label, 
		  --oa.gas_lift_method AS gas_lift_method,
          --oa.diluent_method AS diluent_method,
          ecdp_performance_test.getresultdataclassname
                                            (o.object_id,
                                             oa.daytime
                                            ) AS pt_resdata_class,
          oa.calc_method AS calc_method,
          oa.calc_method_mass AS calc_method_mass,
          oa.calc_inj_method AS calc_inj_method,
          oa.calc_water_inj_method AS calc_water_inj_method,
          oa.calc_steam_inj_method AS calc_steam_inj_method,
          oa.gi_event_inj_data_method AS gi_event_inj_data_method,
          oa.wi_event_inj_data_method AS wi_event_inj_data_method,
          oa.si_event_inj_data_method AS si_event_inj_data_method,
          oa.potential_method AS potential_method,
          oa.potential_mass_method AS potential_mass_method,
          oa.potential_gas_inj_method AS potential_gas_inj_method,
          oa.pot_water_inj_method AS pot_water_inj_method,
          oa.pot_steam_inj_method AS pot_steam_inj_method,
          oa.on_strm_method AS on_stream_method,
          oa.bsw_vol_method AS bsw_vol_method, oa.gor_method AS gor_method,
          oa.cgr_method AS cgr_method, oa.wgr_method AS wgr_method,
          oa.sand_method AS sand_method, oa.wdf_method AS wdf_method,
          NULL AS sub_day_method_label,
          oa.calc_sub_day_method AS calc_sub_day_method,
          oa.gas_lift_sub_day_method AS gas_lift_sub_day_method,
          oa.diluent_sub_day_method AS diluent_sub_day_method,
          NULL AS other_conf_opts_label,
          oa.well_test_method AS well_test_method,
          oa.approach_method AS approach_method,
          NVL
             (ec_calc_rule_version.NAME (oa.well_calc_rule, oa.daytime, '<='),
              ec_ctrl_system_attribute.attribute_text (oa.daytime,
                                                       'DEF_WELL_CALC_RULE',
                                                       '<='
                                                      )
             ) AS calc_rule_code,
          oa.well_calc_rule AS well_calc_rule,
          oa.alloc_fixed_gor AS alloc_fixed_gor,
          oa.alloc_fixed_wc AS alloc_fixed_wc,
          NVL
             (well_calc_rule,
              ecdp_objects.getobjidfromcode
                 ('CALC_RULE',
                  ec_ctrl_system_attribute.attribute_text
                                                        (oa.daytime,
                                                         'DEF_WELL_CALC_RULE',
                                                         '<='
                                                        )
                 )
             ) AS calc_rule_id,
          100 AS calc_seq_no, oa.alloc_flag AS alloc_flag,
          TO_CHAR ('N') AS can_proc_oil, TO_CHAR ('N') AS can_proc_gas,
          TO_CHAR ('N') AS can_proc_wat, TO_CHAR ('N') AS can_proc_gaslift,
          TO_CHAR ('N') AS can_proc_gasinj, TO_CHAR ('N') AS can_proc_watinj,
          TO_CHAR ('N') AS can_proc_steaminj, TO_CHAR ('N') AS can_proc_cond,
          TO_CHAR ('N') AS can_proc_diluent,
          oa.diagram_layout_info AS diagram_layout_info,
--          oa.poten_2nd_value AS poten_2nd_value,
--          oa.poten_3rd_value AS poten_3rd_value,
          oa.choke_uom AS choke_uom,
          oa.std_oil_density_method AS std_oil_density_method,
          oa.std_gas_density_method AS std_gas_density_method,
          oa.std_wat_density_method AS std_wat_density_method,
          proc_node_oil_id AS op_node_id, proc_node_gas_id AS gp_node_id,
          proc_node_water_id AS wp_node_id, proc_node_cond_id AS cp_node_id,
          proc_node_gas_lift_id AS gl_node_id,
          proc_node_diluent_id AS dl_node_id,
          proc_node_gas_inj_id AS gi_node_id,
          proc_node_water_inj_id AS wi_node_id,
          proc_node_steam_inj_id AS si_node_id,
          ecdp_productionday.findproductiondaydefinition
                                       ('WELL',
                                        o.object_id,
                                        oa.daytime
                                       ) AS active_production_day,
          oa.well_reference_obj_id AS well_reference_object,
          oa.forecast_type AS forecast_type,
          oa.forecast_scenario AS forecast_scenario,
          oa.fluid_quality AS fluid_quality, 
		  --oa.isproducer AS isproducer,
          --oa.isproducerorother AS isproducerorother,
          --oa.isinjector AS isinjector, 
		  --oa.isother AS isother,
          --oa.isnotother AS isnotother, 
		  --oa.isoilproducer AS isoilproducer,
          --oa.isgasproducer AS isgasproducer,
          --oa.iscondensateproducer AS iscondensateproducer,
          --oa.iswaterproducer AS iswaterproducer,
          --oa.isgasinjector AS isgasinjector,
          --oa.iswaterinjector AS iswaterinjector,
          --oa.isairinjector AS isairinjector,
          --oa.issteaminjector AS issteaminjector,
          --oa.iswasteinjector AS iswasteinjector,
          oa.text_7 AS gl_control_device, oa.text_5 AS gl_choke_uom,
          oa.text_6 AS gathering_point, oa.text_8 AS development_area,
          oa.value_9 AS wi_target_rate, oa.value_10 AS max_tub_press,
          oa.value_8 AS cond_yield_fac, oa.value_7 AS lpg_yield_fac,
          oa.group_ref_code_1 AS geo_country_code,
          oa.group_ref_id_1 AS geo_country_id,
          oa.group_ref_code_2 AS geo_region_code,
          oa.group_ref_id_2 AS geo_region_id,
          oa.group_ref_code_6 AS geo_licence_code,
          oa.group_ref_id_6 AS geo_licence_id, oa.choke_id AS choke_id,
          ec_choke.object_code (oa.choke_id) AS choke_code,
          oa.gl_choke_id AS gl_choke_id,
          ec_choke.object_code (oa.gl_choke_id) AS gl_choke_code,
          oa.geo_field_code AS geo_field_code,
          oa.geo_field_id AS geo_field_id, o.well_hole_id AS well_hole_id,
          ec_well_hole.object_code (o.well_hole_id) AS well_hole_code,
          oa.commercial_entity_id AS commercial_entity_id,
          ec_commercial_entity.object_code
                           (oa.commercial_entity_id)
                                                    AS commercial_entity_code,
          oa.process_train_id AS process_train_id,
          ec_process_train.object_code
                                   (oa.process_train_id)
                                                        AS process_train_code,
          oa.test_device_id AS test_device_id,
          ec_equipment.object_code (oa.test_device_id) AS test_device_code,
          oa.op_pu_code AS op_productionunit_code,
          oa.op_pu_id AS op_productionunit_id,
          oa.op_sub_pu_code AS op_sub_productionunit_code,
          oa.op_sub_pu_id AS op_sub_productionunit_id,
          oa.op_area_code AS op_area_code, oa.op_area_id AS op_area_id,
          oa.op_sub_area_code AS op_sub_area_code,
          oa.op_sub_area_id AS op_sub_area_id,
          oa.op_fcty_class_2_code AS op_fcty_2_code,
          oa.op_fcty_class_2_id AS op_fcty_2_id,
          oa.op_fcty_class_1_code AS op_fcty_1_code,
          oa.op_fcty_class_1_id AS op_fcty_1_id, pwel.object_id AS object_id,
          pwel.result_no AS result_no, pwel.result_no_comb AS result_no_comb,
          pwel.primary_ind AS primary_ind, pwel.flowing_ind AS flowing_ind,
          pwel.choke_size AS choke_size, pwel.DURATION AS pw_duration,
          pwel.wh_usc_press AS wh_usc_press, pwel.wh_usc_temp AS wh_usc_temp,
          pwel.wh_dsc_press AS wh_dsc_press, pwel.wh_dsc_temp AS wh_dsc_temp,
          pwel.wh_press AS wh_press, pwel.wh_temp AS wh_temp,
          pwel.bh_press AS bh_press, pwel.bh_temp AS bh_temp,
          pwel.annulus_press AS annulus_press,
          pwel.annulus_temp AS annulus_temp, pwel.sand_rate AS sand_rate,
          pwel.erosion_rate AS erosion_rate,
          pwel.net_oil_rate_adj AS net_oil_rate_adj,
          pwel.gas_rate_adj AS gas_rate_adj,
          pwel.net_cond_rate_adj AS net_cond_rate_adj,
          pwel.tot_water_rate_adj AS tot_water_rate_adj,
          pwel.net_oil_density_adj AS net_oil_density_adj,
          pwel.gas_density_adj AS gas_density_adj,
          pwel.net_cond_density_adj AS net_cond_density_adj,
          pwel.tot_water_density_adj AS tot_wat_density_adj,
          pwel.mpm_oil_rate_flc AS mpm_oil_rate_flc,
          pwel.mpm_oil_rate AS mpm_oil_rate,
          pwel.mpm_oil_density AS mpm_oil_density,
          pwel.mpm_gas_rate_flc AS mpm_gas_rate_flc,
          pwel.mpm_gas_rate AS mpm_gas_rate,
          pwel.mpm_gas_density AS mpm_gas_density,
          pwel.mpm_water_rate_flc AS mpm_wat_rate_flc,
          pwel.mpm_water_rate AS mpm_wat_rate,
          pwel.mpm_mix_density AS mpm_mix_density,
          pwel.mpm_press AS mpm_press, pwel.mpm_temp AS mpm_temp,
          pwel.mpm_cond_rate AS mpm_cond_rate,
          pwel.mpm_oil_mass_rate AS mpm_oil_m_rate,
          pwel.mpm_gas_mass_rate AS mpm_gas_m_rate,
          pwel.mpm_cond_mass_rate AS mpm_cond_m_rate,
          pwel.mpm_water_mass_rate AS mpm_wat_m_rate,
          pwel.mpm_cond_density AS mpm_cond_density,
          pwel.mpm_water_density AS mpm_wat_density,
          pwel.mpm_cond_rate_flc AS mpm_cond_rate_flc,
          pwel.mpm_oil_mass_rate_flc AS mpm_oil_m_rate_flc,
          pwel.mpm_gas_mass_rate_flc AS mpm_gas_m_rate_flc,
          pwel.mpm_cond_mass_rate_flc AS mpm_cond_m_rate_flc,
          pwel.mpm_water_mass_rate_flc AS mpm_wat_m_rate_flc,
          pwel.mpm_oil_density_flc AS mpm_oil_density_flc,
          pwel.mpm_gas_density_flc AS mpm_gas_density_flc,
          pwel.mpm_cond_density_flc AS mpm_cond_density_flc,
          pwel.mpm_water_density_flc AS mpm_wat_density_flc,
          pwel.mpm_mix_density_flc AS mpm_mix_density_flc,
          pwel.mpm_conduct AS mpm_conduct,
          pwel.mpm_conduct_temp AS mpm_conduct_temp,
          pwel.mpm_oil_rate_raw AS mpm_oil_rate_raw,
          pwel.mpm_gas_rate_raw AS mpm_gas_rate_raw,
          pwel.mpm_water_rate_raw AS mpm_wat_rate_raw,
          pwel.mpm_oil_mass_rate_raw AS mpm_oil_m_rate_raw,
          pwel.mpm_gas_mass_rate_raw AS mpm_gas_m_rate_raw,
          pwel.mpm_water_mass_rate_raw AS mpm_wat_m_rate_raw,
          pwel.mpm_oil_density_raw AS mpm_oil_density_raw,
          pwel.mpm_gas_density_raw AS mpm_gas_density_raw,
          pwel.mpm_water_density_raw AS mpm_wat_density_raw,
          pwel.mpm_mix_density_raw AS mpm_mix_density_raw,
          pwel.pump_speed AS pump_speed, pwel.pump_power AS pump_power,
          pwel.pump_stroke AS pump_stroke, pwel.pump_timer AS pump_timer,
          pwel.drive_current AS drive_current,
          pwel.drive_voltage AS drive_voltage,
          pwel.liquid_level AS liquid_level,
          pwel.drive_frequency AS drive_frequency,
          pwel.diluent_rate AS diluent_rate,
          pwel.gl_choke_size AS gl_choke_size, pwel.gl_press AS gl_press,
          pwel.gl_temp AS gl_temp, pwel.gl_rate AS gl_rate,
          pwel.gl_density AS gl_density, pwel.est_gl_rate AS est_gl_rate,
          pwel.est_diluent_rate AS est_diluent_rate,
          pwel.decline_rate_oil AS decline_rate_oil,
          pwel.pump_runtime AS pump_runtime,
          pwel.oil_shrinkage AS oil_shrinkage,
          pwel.solution_gas_factor AS solution_gas_factor,
          pwel.gas_sp_grav AS pw_gas_sp_grav, pwel.chloride AS pw_chloride,
          pwel.emulsion AS emulsion, pwel.formation_glr AS formation_glr,
          pwel.gor AS pw_gor, pwel.cgr AS pw_cgr, pwel.glr AS pw_glr,
          pwel.watercut_pct AS watercut_pct,
          pwel.sand_content AS sand_content,
          pwel.gas_out_rate AS gas_out_rate,
          pwel.oil_out_rate AS oil_out_rate, pwel.tdev_press AS tdev_press,
          pwel.tdev_temp AS tdev_temp, pwel.gas_rate AS gas_rate,
          pwel.est_net_oil_rate AS est_net_oil_rate,
          pwel.est_gas_rate AS est_gas_rate,
          pwel.est_net_cond_rate AS est_net_cond_rate,
          pwel.est_water_rate AS est_water_rate,
          pwel.net_oil_mass_rate_adj AS net_oil_m_rate_adj,
          pwel.gas_mass_rate_adj AS gas_m_rate_adj,
          pwel.net_cond_mass_rate_adj AS net_cond_m_rate_adj,
          pwel.tot_water_mass_rate_adj AS tot_water_m_rate_adj,
          pwel.wet_dry_gas_ratio AS wet_dry_gas_ratio, pwel.wgr AS wgr,
          pwel.trend_analysis_ind AS pw_trend_analysis_ind,
          pwel.trend_reset_ind AS trend_reset_ind,
          pwel.powerwater_rate AS powerwater_rate,
          pwel.est_powerwater_rate AS est_powerwater_rate,
          pwel.fws_rate AS fws_rate,
          pwel.well_meter_factor AS well_meter_factor,
          pwel.test_device AS test_device,
          pwel.wt_multiselect AS wt_multiselect, pwel.use_calc AS use_calc,
          pwel.rate_source AS rate_source,
          pwel.wet_gas_gravity AS wet_gas_gravity,
          pwel.avg_flow_mass AS avg_flow_mass, pwel.comments AS pw_comments,
          pwel.value_1 AS pw_value_1, pwel.value_2 AS pw_value_2,
          pwel.value_3 AS pw_value_3, pwel.value_4 AS pw_value_4,
          pwel.value_5 AS pw_value_5, pwel.value_6 AS pw_value_6,
          pwel.value_7 AS pw_value_7, pwel.value_8 AS pw_value_8,
          pwel.value_9 AS pw_value_9, pwel.value_10 AS pw_value_10,
          pwel.value_11 AS pw_value_11, pwel.value_12 AS pw_value_12,
          pwel.value_13 AS pw_value_13, pwel.value_14 AS pw_value_14,
          pwel.value_15 AS pw_value_15, pwel.value_16 AS pw_value_16,
          pwel.value_17 AS pw_value_17, pwel.value_18 AS pw_value_18,
          pwel.value_19 AS pw_value_19, pwel.value_20 AS pw_value_20,
          pwel.value_21 AS pw_value_21, pwel.value_22 AS pw_value_22,
          pwel.value_23 AS pw_value_23, pwel.value_24 AS pw_value_24,
          pwel.value_25 AS pw_value_25, pwel.value_26 AS pw_value_26,
          pwel.value_27 AS pw_value_27, pwel.value_28 AS pw_value_28,
          pwel.value_29 AS pw_value_29, pwel.value_30 AS pw_value_30,
          pwel.text_1 AS pw_text_1, pwel.text_2 AS pw_text_2,
          pwel.text_3 AS pw_text_3, pwel.text_4 AS pw_text_4,
          pwel.text_5 AS pw_text_5, pwel.text_6 AS pw_text_6,
          pwel.text_7 AS pw_text_7, pwel.text_8 AS pw_text_8,
          pwel.text_9 AS pw_text_9, pwel.text_10 AS pw_text_10,
          pwel.text_11 AS pw_text_11, pwel.text_12 AS pw_text_12,
          pwel.text_13 AS pw_text_13, pwel.text_14 AS pw_text_14,
          pwel.text_15 AS pw_text_15,
          ptst.trend_analysis_ind AS pt_trend_analysis_ind,
          ptst.daytime AS start_date, ptst.end_date AS end_date,
          ptst.DURATION AS pt_duration, ptst.test_type AS test_type,
          ptst.estimate_type AS estimate_type, ptst.test_no AS test_no,
          ptst.summarised_ind AS summarised_ind,
          ptst.valid_from_date AS valid_from_date, ptst.status AS status,
          ptst.preprocess_log AS preprocess_log, ptst.use_calc AS pt_use_calc,
          ptst.comments AS pt_comments, ptst.value_1 AS pt_value_1,
          ptst.value_2 AS pt_value_2, ptst.value_3 AS pt_value_3,
          ptst.value_4 AS pt_value_4, ptst.value_5 AS pt_value_5,
          ptst.value_6 AS pt_value_6, ptst.value_7 AS pt_value_7,
          ptst.value_8 AS pt_value_8, ptst.value_9 AS pt_value_9,
          ptst.value_10 AS pt_value_10, ptst.text_1 AS pt_text_1,
          ptst.text_2 AS pt_text_2, ptst.text_3 AS pt_text_3,
          ptst.text_4 AS pt_text_4, eqv.daytime AS td_daytime,
          eq.object_id AS td_object_id, eq.object_code AS td_code,
          eqv.NAME AS td_name, eq.start_date AS td_object_start_date,
          eq.end_date AS td_object_end_date,
          --eqv.eqpm_status_scr AS td_screen_status,
          eq.description AS td_description,
          eqv.instrumentation_type AS td_instrument_type,
          eqv.separator_id AS testseparator_id,
          ecdp_objects.getobjcode (eqv.separator_id) AS testseparator_code,
          eqv.tank_id AS tankmeter_id,
          ec_tank.object_code (eqv.tank_id) AS tankmeter_code,
          eqpm.tdev_press AS td_tdev_press, eqpm.tdev_temp AS td_tdev_temp,
          eqpm.inlet_press AS inlet_press, eqpm.inlet_temp AS inlet_temp,
          eqpm.oil_outlet_press AS oil_outlet_press,
          eqpm.oil_outlet_temp AS oil_outlet_temp,
          eqpm.gas_outlet_press AS gas_outlet_press,
          eqpm.gas_outlet_temp AS gas_outlet_temp,
          eqpm.sand_rate AS td_sand_rate,
          eqpm.erosion_rate AS td_erosion_rate,
          eqpm.orifice_size AS orifice_size,
          eqpm.orifice_transmitter AS orifice_transmitter,
          eqpm.gas_diff_press_1 AS gas_diff_press_1,
          eqpm.gas_diff_press_2 AS gas_diff_press_2,
          eqpm.water_in_oil_out AS water_in_oil_out,
          eqpm.oil_in_water_out AS oil_in_water_out,
          eqpm.net_oil_density_adj AS td_net_oil_dens_adj,
          eqpm.gas_density_adj AS td_gas_dens_adj,
          eqpm.net_cond_density_adj AS td_net_cond_dens_adj,
          eqpm.tot_water_density_adj AS td_tot_wat_dens_adj,
          eqpm.net_oil_rate_adj AS td_net_oil_rate_adj,
          eqpm.gas_rate_adj AS td_gas_rate_adj,
          eqpm.net_cond_rate_adj AS td_net_cond_rate_adj,
          eqpm.tot_water_rate_adj AS td_tot_wat_rate_adj,
          eqpm.net_oil_rate AS td_net_oil_rate, eqpm.gas_rate AS td_gas_rate,
          eqpm.tot_water_rate AS td_tot_wat_rate,
          eqpm.net_oil_density AS net_oil_density,
          eqpm.gas_density AS gas_density,
          eqpm.tot_water_density AS tot_wat_density,
          eqpm.net_oil_density_flc AS net_oil_density_flc,
          eqpm.gas_density_flc AS gas_density_flc,
          eqpm.tot_water_density_flc AS tot_wat_density_flc,
          eqpm.oil_out_density AS oil_out_density,
          eqpm.gas_out_density AS gas_out_density,
          eqpm.water_out_density AS water_out_density,
          eqpm.oil_out_density_flc AS oil_out_density_flc,
          eqpm.gas_out_density_flc AS gas_out_density_flc,
          eqpm.water_out_density_flc AS water_out_density_flc,
          eqpm.net_oil_rate_flc AS td_net_oil_rate_flc,
          eqpm.gas_rate_flc AS td_gas_rate_flc,
          eqpm.tot_water_rate_flc AS td_tot_wat_rate_flc,
          eqpm.oil_out_rate AS td_oil_out_rate,
          eqpm.gas_out_rate AS td_gas_out_rate,
          eqpm.water_out_rate AS td_wat_out_rate,
          eqpm.oil_out_rate_flc AS oil_out_rate_flc,
          eqpm.gas_out_rate_flc AS gas_out_rate_flc,
          eqpm.water_out_rate_flc AS water_out_rate_flc,
          eqpm.net_cond_rate_flc AS net_cond_rate_flc,
          eqpm.net_oil_mass_rate_flc AS net_oil_m_rate_flc,
          eqpm.gas_mass_rate_flc AS gas_m_rate_flc,
          eqpm.net_cond_mass_rate_flc AS net_cond_m_rate_flc,
          eqpm.tot_water_mass_rate_flc AS tot_wat_m_rate_flc,
          eqpm.net_cond_density_flc AS net_cond_density_flc,
          eqpm.net_oil_mass_rate_adj AS td_net_oil_m_rate_adj,
          eqpm.gas_mass_rate_adj AS td_gas_m_rate_adj,
          eqpm.net_cond_mass_rate_adj AS td_net_cond_m_rate_adj,
          eqpm.tot_water_mass_rate_adj AS td_tot_wat_m_rate_adj,
          eqpm.net_cond_rate AS net_cond_rate,
          eqpm.net_oil_mass_rate AS net_oil_m_rate,
          eqpm.gas_mass_rate AS gas_m_rate,
          eqpm.net_cond_mass_rate AS net_cond_m_rate,
          eqpm.tot_water_mass_rate AS tot_water_m_rate,
          eqpm.net_cond_density AS net_cond_density,
          eqpm.net_oil_vol AS net_oil_vol, eqpm.gas_vol AS gas_vol,
          eqpm.net_cond_vol AS net_cond_vol,
          eqpm.tot_water_vol AS tot_water_vol,
          eqpm.oil_out_rate_raw AS oil_out_rate_raw,
          eqpm.gas_out_rate_raw AS gas_out_rate_raw,
          eqpm.water_out_rate_raw AS water_out_rate_raw,
          eqpm.oil_out_vol_raw AS oil_out_vol_raw,
          eqpm.gas_out_vol_raw AS gas_out_vol_raw,
          eqpm.water_out_vol_raw AS water_out_vol_raw,
          eqpm.oil_out_rate_1_raw AS oil_out_rate_1_raw,
          eqpm.oil_out_rate_2_raw AS oil_out_rate_2_raw,
          eqpm.oil_out_rate_3_raw AS oil_out_rate_3_raw,
          eqpm.gas_out_rate_1_raw AS gas_out_rate_1_raw,
          eqpm.gas_out_rate_2_raw AS gas_out_rate_2_raw,
          eqpm.gas_out_rate_3_raw AS gas_out_rate_3_raw,
          eqpm.water_out_rate_1_raw AS water_out_rate_1_raw,
          eqpm.water_out_rate_2_raw AS water_out_rate_2_raw,
          eqpm.water_out_rate_3_raw AS water_out_rate_3_raw,
          eqpm.water_in_oil_out_wt AS water_in_oil_out_wt,
          eqpm.event_oil_out_bsw_wt AS event_oil_out_bsw_wt,
          eqpm.mpm_gas_density AS td_mpm_gas_density,
          eqpm.mpm_mix_density AS td_mpm_mix_density,
          eqpm.mpm_oil_density AS td_mpm_oil_density,
          eqpm.mpm_water_density AS td_mpm_wat_density,
          eqpm.mpm_gas_density_flc AS td_mpm_gas_density_flc,
          eqpm.mpm_oil_density_flc AS td_mpm_oil_density_flc,
          eqpm.mpm_gas_rate AS td_mpm_gas_rate,
          eqpm.mpm_oil_rate AS td_mpm_oil_rate,
          eqpm.mpm_water_rate AS td_mpm_wat_rate,
          eqpm.mpm_gas_rate_flc AS td_mpm_gas_rate_flc,
          eqpm.mpm_oil_rate_flc AS td_mpm_oil_rate_flc,
          eqpm.mpm_water_rate_flc AS td_mpm_wat_rate_flc,
          eqpm.mpm_gas_rate_raw AS td_mpm_gas_rate_raw,
          eqpm.mpm_oil_rate_raw AS td_mpm_oil_rate_raw,
          eqpm.mpm_water_rate_raw AS td_mpm_wat_rate_raw,
          eqpm.mpm_conduct AS td_mpm_conduct,
          eqpm.mpm_conduct_temp AS td_mpm_conduct_temp,
          eqpm.mpm_press AS td_mpm_press, eqpm.mpm_temp AS td_mpm_temp,
          eqpm.mpm_cond_rate AS td_mpm_cond_rate,
          eqpm.mpm_oil_mass_rate AS td_mpm_oil_m_rate,
          eqpm.mpm_gas_mass_rate AS td_mpm_gas_m_rate,
          eqpm.mpm_cond_mass_rate AS td_mpm_cond_m_rate,
          eqpm.mpm_water_mass_rate AS td_mpm_wat_m_rate,
          eqpm.mpm_cond_density AS td_mpm_cond_density,
          eqpm.mpm_cond_rate_flc AS td_mpm_cond_rate_flc,
          eqpm.mpm_oil_mass_rate_flc AS td_mpm_oil_m_rate_flc,
          eqpm.mpm_gas_mass_rate_flc AS td_mpm_gas_m_rate_flc,
          eqpm.mpm_cond_mass_rate_flc AS td_mpm_cond_m_rate_flc,
          eqpm.mpm_water_mass_rate_flc AS td_mpm_wat_m_rate_flc,
          eqpm.mpm_cond_density_flc AS td_mpm_cond_density_flc,
          eqpm.mpm_water_density_flc AS td_mpm_wat_density_flc,
          eqpm.mpm_mix_density_flc AS td_mpm_mix_density_flc,
          eqpm.mpm_oil_mass_rate_raw AS td_mpm_oil_m_rate_raw,
          eqpm.mpm_gas_mass_rate_raw AS td_mpm_gas_m_rate_raw,
          eqpm.mpm_water_mass_rate_raw AS td_mpm_wat_m_rate_raw,
          eqpm.mpm_oil_density_raw AS td_mpm_oil_density_raw,
          eqpm.mpm_gas_density_raw AS td_mpm_gas_density_raw,
          eqpm.mpm_water_density_raw AS td_mpm_wat_density_raw,
          eqpm.mpm_mix_density_raw AS td_mpm_mix_density_raw,
          eqpm.event_oil_out_bsw AS event_oil_out_bsw,
          eqpm.event_oil_out_density AS event_oil_out_density,
          eqpm.event_gas_out_density AS event_gas_out_density,
          eqpm.est_diluent_rate_flc AS est_diluent_rate_flc,
          eqpm.est_gl_rate_flc AS est_gl_rate_flc,
          eqpm.est_powerwater_rate_flc AS est_powerwater_rate_flc,
          eqpm.gl_rate AS td_gl_rate, eqpm.gl_press AS td_gl_press,
          eqpm.gas_sp_grav AS td_gas_sp_grav, eqpm.chloride AS td_chloride,
          eqpm.emulsion AS td_emulsion, eqpm.sand_content AS td_sand_content,
          eqpm.comments AS td_comments, eqpm.liquid_level AS td_liquid_level,
          eqpm.water_level AS td_water_level,
          eqpm.gas_lift_out_rate_raw AS gas_lift_out_rate_raw,
          eqpm.gas_lift_out_vol_raw AS gas_lift_out_vol_raw,
          eqpm.override_oil_mtr_factor AS override_oil_mtr_factor,
          eqpm.override_wat_mtr_factor AS override_wat_mtr_factor,
          eqpm.ovr_shrinkage_factor AS ovr_shrinkage_factor,
          eqpm.gas_lift_rate_raw AS gas_lift_rate_raw,
          eqpm.gas_lift_vol_raw AS gas_lift_vol_raw, eqpm.gor AS td_gor,
          eqpm.cgr AS td_cgr, eqpm.wor AS td_wor, eqpm.glr AS td_glr,
          eqpm.wgr AS td_wgr, eqpm.power_water_flc AS power_water_flc,
          eqpm.oil_shrinkage_override AS oil_shrinkage_override,
          eqpm.gas_shrinkage_override AS gas_shrinkage_override,
          eqpm.liquid_opening_reading AS liquid_opening_reading,
          eqpm.liquid_closing_reading AS liquid_closing_reading,
          eqpm.water_opening_reading AS water_opening_reading,
          eqpm.water_closing_reading AS water_closing_reading,
          eqpm.observed_gravity AS observed_gravity,
          eqpm.observed_temp AS observed_temp, eqpm.run_temp AS run_temp,
          eqpm.bsw AS bsw, eqpm.liquid_adjust_volume AS liquid_adjust_volume,
          eqpm.water_adjust_volume AS water_adjust_volume, eqpm.vcf AS vcf,
          eqpm.corr_gravity AS corr_gravity,
          eqpm.gas_vol_out_aga AS gas_vol_out_aga,
          eqpm.gas_lift_vol_out_aga AS gas_lift_vol_out_aga,
          eqpm.gas_static_press_read AS gas_static_press_read,
          eqpm.gas_diff_press_read AS gas_diff_press_read,
          eqpm.gas_flow_temp AS gas_flow_temp,
          eqpm.gl_static_press_read AS gl_static_press_read,
          eqpm.gl_diff_press_read AS gl_diff_press_read,
          eqpm.gl_flow_temp AS gl_flow_temp,
          eqpm.ovr_gas_meter_run_id AS ovr_gas_meter_run_id,
          eqpm.ovr_gas_orifice_plate_id AS ovr_gas_orifice_plate_id,
          eqpm.ovr_gl_meter_run_id AS ovr_gl_meter_run_id,
          eqpm.ovr_gl_orifice_plate_id AS ovr_gl_orifice_plate_id,
          eqpm.gl_sp_grav AS td_gl_sp_grav,
          eqpm.gas_static_chart_scale AS gas_static_chart_scale,
          eqpm.gas_static_chart_rating AS gas_static_chart_rating,
          eqpm.gas_diff_chart_scale AS gas_diff_chart_scale,
          eqpm.gl_static_chart_scale AS gl_static_chart_scale,
          eqpm.gl_static_chart_rating AS gl_static_chart_rating,
          eqpm.gl_diff_chart_scale AS gl_diff_chart_scale,
          eqpm.gl_diff_chart_rating AS gl_diff_chart_rating,
          eqpm.value_1 AS td_value_1, eqpm.value_2 AS td_value_2,
          eqpm.value_3 AS td_value_3, eqpm.value_4 AS td_value_4,
          eqpm.value_5 AS td_value_5, eqpm.value_6 AS td_value_6,
          eqpm.value_7 AS td_value_7, eqpm.value_8 AS td_value_8,
          eqpm.value_9 AS td_value_9, eqpm.value_10 AS td_value_10,
          eqpm.text_1 AS td_text_1, eqpm.text_2 AS td_text_2,
          eqpm.text_3 AS td_text_3, eqpm.text_4 AS td_text_4,
          eqv.text_8 AS gas_meter_type, eqv.text_7 AS two_phase,
          pwel.record_status AS record_status, pwel.created_by AS created_by,
          pwel.created_date AS created_date,
          pwel.last_updated_by AS last_updated_by,
          pwel.last_updated_date AS last_updated_date, pwel.rev_no AS rev_no,
          pwel.rev_text AS rev_text, NULL AS approval_state,
          NULL AS approval_by, NULL AS approval_date, NULL AS rec_id,
          wb.object_id AS well_bore_id, wb.object_code AS well_bore_code,
          wbi.object_id AS well_bore_interval_id,
          wbi.object_code AS well_bore_interval_code,
          pi.object_id AS perf_interval_id,
          pi.object_code AS perf_interval_code,
--resv block formation
          piv.resv_block_formation_id AS resv_block_formation_id-- Added this join cause 111 moved the resv_block_formation_id from perf_interval to perf_interval_version
     FROM system_days s,
          webo_bore wb,
          webo_version wbv,
          well o,
          well_version oa,
          test_device eq,
          pwel_result pwel,
          ptst_result ptst,
          test_device_version eqv,
          TEST_DEVICE_RESULT eqpm,--eqpm_result eqpm,
          webo_interval wbi,
          webo_interval_version wbiv,
          perf_interval pi,
          perf_interval_version piv
    WHERE oa.object_id = o.object_id
      AND s.daytime >= oa.daytime
      AND (s.daytime < oa.end_date OR oa.end_date IS NULL)
      AND (s.daytime < o.end_date OR o.end_date IS NULL)
      AND o.object_id = pwel.object_id
      AND s.daytime = TRUNC (ptst.daytime, 'DD')
      AND ptst.result_no = pwel.result_no
      AND eqv.object_id = eq.object_id
      AND s.daytime >= eqv.daytime
      AND (s.daytime < eqv.end_date OR eqv.end_date IS NULL)
      AND (s.daytime < eq.end_date OR eq.end_date IS NULL)
      AND eq.object_id = eqpm.object_id
      AND eqpm.result_no = pwel.result_no
      AND oa.object_id = wb.well_id
      AND wb.object_id = wbi.well_bore_id
      AND wb.object_id = wbv.object_id
      AND s.daytime >= wbv.daytime
      AND (s.daytime < wbv.end_date OR wbv.end_date IS NULL)
      AND (s.daytime < wb.end_date OR wb.end_date IS NULL)
      AND wbi.object_id = wbiv.object_id
      AND s.daytime >= wbiv.daytime
      AND (s.daytime < wbiv.end_date OR wbiv.end_date IS NULL)
      AND (s.daytime < wbi.end_date OR wbi.end_date IS NULL)
      AND wbi.object_id = pi.webo_interval_id
      AND pi.object_id = piv.object_id
      AND s.daytime >= piv.daytime
      AND (s.daytime < piv.end_date OR piv.end_date IS NULL)
      AND (s.daytime < pi.end_date OR pi.end_date IS NULL);
