--******************************************************************************************
--** SQL statements created by EC Configuration utility version 94001
--** Workbook source: C:\EC\EnergyComponents\CVX\11.1\Enhancements\02.DQ Tool\CollectionPointUpdate\collection_point hier entries.xls
--** Computer name  : PBYKBPD2347
--** User name      : Srikar Reddy
--** Date and time  : 1/31/2017 1:10:51 PM
--******************************************************************************************
set define off
--
--Extracting DELETE statements
--
--Extracting INSERT statements
INSERT INTO CT_DQ_HIER_DETERMINATION (OBJECT_TYPE, OBJECT_ID_SOURCE, DAYTIME_SOURCE, END_DATE_SOURCE, CP_AREA_ID_SOURCE, CP_SUB_AREA_ID_SOURCE, CP_OPERATOR_ROUTE_ID_SOURCE, FROM_SQL) VALUES ('OPERATOR_ROUTE', 'OBJECT_ID', 'DAYTIME', 'END_DATE', 'CP_AREA_ID', 'CP_SUB_AREA_ID', 'OBJECT_ID', 'FROM OV_OPERATOR_ROUTE');
INSERT INTO CT_DQ_HIER_DETERMINATION (OBJECT_TYPE, OBJECT_ID_SOURCE, DAYTIME_SOURCE, END_DATE_SOURCE, CP_AREA_ID_SOURCE, CP_SUB_AREA_ID_SOURCE, CP_OPERATOR_ROUTE_ID_SOURCE, CP_COL_POINT_ID_SOURCE, FROM_SQL) VALUES ('COLLECTION_POINT', 'OBJECT_ID', 'DAYTIME', 'END_DATE', 'CP_AREA_ID', 'CP_SUB_AREA_ID', 'CP_OPERATOR_ROUTE_ID', 'OBJECT_ID', 'FROM OV_COLLECTION_POINT');
--
--Extracting UPDATE statements
UPDATE TV_EC_CODES SET (DESCRIPTION, IS_ACTIVE) = (select 'Collection Point Hierarchy Determination', 'Y' from dual) WHERE CODE_TYPE = 'CT_DQ_HIER_OBJ_TYPE' AND CODE = 'COLLECTION_POINT';
UPDATE TV_EC_CODES SET (DESCRIPTION, IS_ACTIVE) = (select 'Operator Route Hierarchy Determination', 'Y' from dual) WHERE CODE_TYPE = 'CT_DQ_HIER_OBJ_TYPE' AND CODE = 'OPERATOR_ROUTE';
UPDATE TV_EC_CODES SET (IS_ACTIVE) = (select 'Y' from dual) WHERE CODE_TYPE = 'CT_DQ_LOGGING_LEVEL' AND CODE = 'CP_AREA_ID';
UPDATE TV_EC_CODES SET (IS_ACTIVE) = (select 'Y' from dual) WHERE CODE_TYPE = 'CT_DQ_LOGGING_LEVEL' AND CODE = 'CP_SUB_AREA_ID';
UPDATE TV_EC_CODES SET (IS_ACTIVE) = (select 'Y' from dual) WHERE CODE_TYPE = 'CT_DQ_LOGGING_LEVEL' AND CODE = 'CP_OPERATOR_ROUTE_ID';
UPDATE TV_EC_CODES SET (IS_ACTIVE) = (select 'Y' from dual) WHERE CODE_TYPE = 'CT_DQ_LOGGING_LEVEL' AND CODE = 'CP_COL_POINT_ID';
UPDATE CT_DQ_HIER_DETERMINATION SET (OP_SUB_PU_ID_SOURCE, CP_AREA_ID_SOURCE, CP_SUB_AREA_ID_SOURCE, CP_OPERATOR_ROUTE_ID_SOURCE, CP_COL_POINT_ID_SOURCE) = (select 'OP_PROD_SUB_UNIT_ID', 'CP_AREA_ID', 'CP_SUB_AREA_ID', 'CP_OPERATOR_ROUTE_ID', 'CP_COL_POINT_ID' from dual) WHERE OBJECT_TYPE = 'WELL' AND FROM_SQL = 'FROM OV_WELL';
UPDATE CT_DQ_HIER_DETERMINATION SET (OP_SUB_PU_ID_SOURCE, CP_AREA_ID_SOURCE, CP_SUB_AREA_ID_SOURCE, CP_OPERATOR_ROUTE_ID_SOURCE, CP_COL_POINT_ID_SOURCE) = (select 'OP_PROD_SUB_UNIT_ID', 'CP_AREA_ID', 'CP_SUB_AREA_ID', 'CP_OPERATOR_ROUTE_ID', 'CP_COL_POINT_ID' from dual) WHERE OBJECT_TYPE = 'STREAM' AND FROM_SQL = 'FROM OV_STREAM';
UPDATE CT_DQ_HIER_DETERMINATION SET (OP_SUB_PU_ID_SOURCE, CP_AREA_ID_SOURCE, CP_SUB_AREA_ID_SOURCE, CP_OPERATOR_ROUTE_ID_SOURCE, CP_COL_POINT_ID_SOURCE) = (select 'OP_PROD_SUB_UNIT_ID', 'CP_AREA_ID', 'CP_SUB_AREA_ID', 'CP_OPERATOR_ROUTE_ID', 'CP_COL_POINT_ID' from dual) WHERE OBJECT_TYPE = 'TANK' AND FROM_SQL = 'FROM OV_TANK';
UPDATE CT_DQ_HIER_DETERMINATION SET (OP_SUB_PU_ID_SOURCE, CP_AREA_ID_SOURCE, CP_SUB_AREA_ID_SOURCE, CP_OPERATOR_ROUTE_ID_SOURCE, CP_COL_POINT_ID_SOURCE) = (select 'OP_PROD_SUB_UNIT_ID', 'CP_AREA_ID', 'CP_SUB_AREA_ID', 'CP_OPERATOR_ROUTE_ID', 'CP_COL_POINT_ID' from dual) WHERE OBJECT_TYPE = 'WELL_HOLE' AND FROM_SQL = 'FROM OV_WELL_HOLE';
UPDATE CT_DQ_HIER_DETERMINATION SET (OP_SUB_PU_ID_SOURCE, CP_AREA_ID_SOURCE, CP_SUB_AREA_ID_SOURCE, CP_OPERATOR_ROUTE_ID_SOURCE, CP_COL_POINT_ID_SOURCE) = (select 'W.OP_PROD_SUB_UNIT_ID', 'W.CP_AREA_ID', 'W.CP_SUB_AREA_ID', 'W.CP_OPERATOR_ROUTE_ID', 'W.CP_COL_POINT_ID' from dual) WHERE OBJECT_TYPE = 'WELL_BORE' AND FROM_SQL = 'FROM WEBO_BORE WB, OV_WELL W
WHERE WB.WELL_ID = W.OBJECT_ID';
UPDATE CT_DQ_HIER_DETERMINATION SET (OP_SUB_PU_ID_SOURCE, CP_AREA_ID_SOURCE, CP_SUB_AREA_ID_SOURCE, CP_OPERATOR_ROUTE_ID_SOURCE, CP_COL_POINT_ID_SOURCE) = (select 'OP_PROD_SUB_UNIT_ID', 'CP_AREA_ID', 'CP_SUB_AREA_ID', 'CP_OPERATOR_ROUTE_ID', 'CP_COL_POINT_ID' from dual) WHERE OBJECT_TYPE = 'CHEM_TANK' AND FROM_SQL = 'FROM OV_CHEM_TANK';
UPDATE CT_DQ_HIER_DETERMINATION SET (OP_SUB_PU_ID_SOURCE, CP_AREA_ID_SOURCE, CP_SUB_AREA_ID_SOURCE, CP_OPERATOR_ROUTE_ID_SOURCE, CP_COL_POINT_ID_SOURCE) = (select 'W.OP_PROD_SUB_UNIT_ID', 'W.CP_AREA_ID', 'W.CP_SUB_AREA_ID', 'W.CP_OPERATOR_ROUTE_ID', 'W.CP_COL_POINT_ID' from dual) WHERE OBJECT_TYPE = 'PERF_INTERVAL' AND FROM_SQL = 'FROM PERF_INTERVAL PI, OV_WELL W
WHERE PI.WELL_ID = W.OBJECT_ID';
UPDATE CT_DQ_HIER_DETERMINATION SET (OP_SUB_PU_ID_SOURCE, CP_AREA_ID_SOURCE, CP_SUB_AREA_ID_SOURCE, CP_OPERATOR_ROUTE_ID_SOURCE, CP_COL_POINT_ID_SOURCE) = (select 'OP_PROD_SUB_UNIT_ID', 'CP_AREA_ID', 'CP_SUB_AREA_ID', 'CP_OPERATOR_ROUTE_ID', 'CP_COL_POINT_ID' from dual) WHERE OBJECT_TYPE = 'STORAGE' AND FROM_SQL = 'FROM OV_STORAGE';
UPDATE CT_DQ_HIER_DETERMINATION SET (OP_SUB_PU_ID_SOURCE, CP_AREA_ID_SOURCE, CP_SUB_AREA_ID_SOURCE, CP_OPERATOR_ROUTE_ID_SOURCE, CP_COL_POINT_ID_SOURCE) = (select 'W.OP_PROD_SUB_UNIT_ID', 'W.CP_AREA_ID', 'W.CP_SUB_AREA_ID', 'W.CP_OPERATOR_ROUTE_ID', 'W.CP_COL_POINT_ID' from dual) WHERE OBJECT_TYPE = 'WELL_BORE_INTERVAL' AND FROM_SQL = 'FROM WEBO_INTERVAL WBI, WEBO_BORE WB, OV_WELL W
WHERE WB.WELL_ID = W.OBJECT_ID
AND WBI.WELL_BORE_ID = WB.OBJECT_ID';
UPDATE CT_DQ_HIER_DETERMINATION SET (CP_AREA_ID_SOURCE, CP_SUB_AREA_ID_SOURCE, CP_OPERATOR_ROUTE_ID_SOURCE, CP_COL_POINT_ID_SOURCE) = (select 'CP_AREA_ID', 'CP_SUB_AREA_ID', 'CP_OPERATOR_ROUTE_ID', 'CP_COL_POINT_ID' from dual) WHERE OBJECT_TYPE = 'EQUIPMENT' AND FROM_SQL = 'FROM EQPM_VERSION';
UPDATE CT_DQ_HIER_DETERMINATION SET (OP_SUB_PU_ID_SOURCE) = (select 'OP_PROD_SUB_UNIT_ID' from dual) WHERE OBJECT_TYPE = 'FCTY_CLASS_2' AND FROM_SQL = 'FROM OV_FCTY_CLASS_2';
UPDATE CT_DQ_HIER_DETERMINATION SET (OP_SUB_PU_ID_SOURCE) = (select 'OP_PROD_SUB_UNIT_ID' from dual) WHERE OBJECT_TYPE = 'FCTY_CLASS_1' AND FROM_SQL = 'FROM OV_FCTY_CLASS_1';
--
--
set define on