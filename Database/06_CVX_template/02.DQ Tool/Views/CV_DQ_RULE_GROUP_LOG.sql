CREATE OR REPLACE FORCE VIEW CV_DQ_RULE_GROUP_LOG AS
SELECT 
RL.RUN_ID,
RL.RUN_TYPE,
RL.RULE_GROUP_ID,
RL.RULE_ID,
RL.PARM_START_DATE,
RL.PARM_END_DATE,
RL.HIER_GROUP_TYPE,
RL.HIER_OBJECT_ID,
RL.REC_OBJECT_ID,
RL.REC_DAYTIME,
RL.REC_ALT_UNIQUE_KEY,
RL.RUN_DATE, 
RL.COMPLETED_DATE, 
RL.RUN_STATUS,
RL.RUN_MESSAGE, 
(nvl(RL.COMPLETED_DATE,sysdate) - RL.RUN_DATE) * 24 * 60 AS DURATION,
(SELECT COUNT(distinct rule_id) FROM CT_DQ_RULE_RUN_LOG L WHERE L.RUN_ID = RL.RUN_ID)  AS RULE_COUNT,
(SELECT SUM(TOTAL_ERRORS) FROM CT_DQ_RULE_RUN_LOG L WHERE L.RUN_ID = RL.RUN_ID) AS TOTAL_ERRORS, 
(SELECT SUM(TOTAL_NEW_ERRORS) FROM CT_DQ_RULE_RUN_LOG L WHERE L.RUN_ID = RL.RUN_ID) AS TOTAL_NEW_ERRORS, 
(SELECT SUM(TOTAL_OLD_ERRORS) FROM CT_DQ_RULE_RUN_LOG L WHERE L.RUN_ID = RL.RUN_ID) AS TOTAL_OLD_ERRORS,
(SELECT SUM(TOTAL_DELETED_ERRORS) FROM CT_DQ_RULE_RUN_LOG L WHERE L.RUN_ID = RL.RUN_ID) AS TOTAL_DELETED_ERRORS,
(SELECT SUM(TOTAL_ROLLED_ERRORS) FROM CT_DQ_RULE_RUN_LOG L WHERE L.RUN_ID = RL.RUN_ID) AS TOTAL_ROLLED_ERRORS,
RL.RECORD_STATUS,
RL.CREATED_DATE,
RL.CREATED_BY,
RL.LAST_UPDATED_DATE,
RL.LAST_UPDATED_BY,
RL.REV_NO,
RL.REV_TEXT 
FROM CT_DQ_RUN_LOG RL;