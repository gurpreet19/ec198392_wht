CREATE OR REPLACE FORCE EDITIONABLE VIEW "V_SUM_RR_CONTRACT_BK" ("OBJECT_ID", "CLASS_NAME", "LINE_ITEM_VALUE", "QTY1", "QTY2", "QTY3", "QTY4", "PRICING_VALUE", "PRICING_VAT_VALUE", "PRICING_TOTAL", "MEMO_VALUE", "MEMO_VAT_VALUE", "MEMO_TOTAL", "BOOKING_VALUE", "BOOKING_VAT_VALUE", "BOOKING_TOTAL", "DAYTIME", "REPORT_REF_TYPE", "REF_TAG", "REV_TEXT", "APPROVAL_STATE", "APPROVAL_BY", "APPROVAL_DATE", "CREATED_BY", "CREATED_DATE", "LAST_UPDATED_BY", "LAST_UPDATED_DATE", "REC_ID", "REV_NO", "RECORD_STATUS") AS 
  select object_id,
       'CONTRACT' AS class_name,
       sum(NVL(line_item_value,0)) as line_item_value,
       sum(NVL(qty1,0)) as qty1,
       sum(NVL(qty2,0)) as qty2,
       sum(NVL(qty3,0)) as qty3,
       sum(NVL(qty4,0)) as qty4 ,
       sum(NVL(pricing_value,0)) pricing_value,
       sum(NVL(pricing_vat_value,0)) pricing_vat_value,
       sum(NVL(Pricing_Total,0)) pricing_TOTAL,
       sum(NVL(memo_value,0)) memo_value,
       sum(NVL(memo_vat_value,0)) memo_vat_value,
       sum(NVL(memo_total,0)) memo_total,
       sum(NVL(booking_value,0)) booking_value,
       sum(NVL(booking_vat_value,0)) booking_vat_value,
       sum(NVL(booking_total,0)) booking_total,
       trunc(rr.daytime,'mm') daytime,
       report_ref_type ,
       ref_tag ,
       null rev_text,
       null approval_state,
       null approval_by,
       null approval_date,
       null created_by,
       null created_date,
       null last_updated_by,
       null last_updated_date,
       null rec_id,
       null rev_no,
       null record_status
from v_rr_contract_bk rr
Group by
  rr.object_id,
  trunc(rr.daytime,'mm'),
  report_ref_type ,
  ref_tag